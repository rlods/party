(this["webpackJsonpparty-app"]=this["webpackJsonpparty-app"]||[]).push([[0],{145:function(e,t,a){e.exports=a(297)},167:function(e,t,a){},168:function(e,t,a){},169:function(e,t,a){},171:function(e,t,a){},172:function(e,t,a){},194:function(e,t){},196:function(e,t){},230:function(e,t){},231:function(e,t){},273:function(e,t,a){},274:function(e,t,a){},275:function(e,t,a){},276:function(e,t,a){},277:function(e,t,a){},278:function(e,t,a){},279:function(e,t,a){},287:function(e,t,a){},288:function(e,t,a){},289:function(e,t,a){},290:function(e,t,a){},291:function(e,t,a){},292:function(e,t,a){},293:function(e,t,a){},294:function(e,t,a){},296:function(e,t,a){},297:function(e,t,a){"use strict";a.r(t);var r=a(1),n=a.n(r),o=a(2),c=a(0),s=a.n(c),l=a(36),i=a(3),u=a(33),d=a(31),p=a(10),m=a.n(p),b=a(136),f=a.n(b),v=a(5),y=a(140),g=a.n(y);a(167);const h=s.a.memo(({className:e,color:t,icon:a,size:r="M",title:n})=>s.a.createElement(g.a,{className:m()("Icon",e,r),name:a,style:{color:t},title:n}));a(168);const k=s.a.memo(({className:e,color:t,disabled:a=!1,displayTitle:r=!1,icon:n,kind:o="default",onClick:c,size:l,title:i,type:u="button"})=>s.a.createElement("button",{type:u,"aria-label":i,className:m()("IconButton",e,o,{clickable:!a&&(!!c||"submit"===u)}),onClick:a?void 0:c,title:i},s.a.createElement(h,{color:t,icon:n,size:l}),r&&s.a.createElement("div",{className:m()("IconButtonTitle",l)},i))),x=function(){var e=Object(o.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise(e=>{const a=document.createElement("textarea");a.value=t,a.setAttribute("readonly",""),a.style.position="absolute",a.style.left="-9999px",document.body.appendChild(a);const r=document.getSelection();if(null!==r){const e=r.rangeCount>0&&r.getRangeAt(0);a.select(),document.execCommand("copy"),!1!==e&&(r.removeAllRanges(),r.addRange(e))}document.body.removeChild(a),e()});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=e=>{var t;return(null===(t=e.room.info)||void 0===t?void 0:t.name)||""},_=e=>!!e.room._fbRoom,w=e=>!e.room.access.secret;var j=a(4),O=a(6);const S=e=>e.response&&e.response.data&&e.response.data.message?e.response.data.message:e.message,C=e=>M("modals/OPEN",e),I=()=>M("modals/POP"),N={stack:[]};function M(e,t){return void 0===t?{type:e}:{type:e,payload:t}}const R=e=>function(){var t=Object(o.a)(n.a.mark((function t(a){var r;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=!1,t.prev=1,t.next=4,e.onAction();case 4:if("unlock-and-retry"!==(r=t.sent)){t.next=8;break}return a(C({type:"Room/Unlock",props:{options:{onFailure:e.onFailure,onSuccess:()=>a(R(e))}}})),t.abrupt("return");case 8:if("connect-and-retry"!==r){t.next=11;break}return a(C({type:"User/Create",props:{options:{onFailure:e.onFailure,onSuccess:()=>a(R(e))}}})),t.abrupt("return");case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(1),a(F(S(t.t0)));case 16:if(r){t.next=20;break}if(!e.onFailure){t.next=20;break}return e.onFailure(),t.abrupt("return");case 20:e.onSuccess&&e.onSuccess();case 21:case"end":return t.stop()}}),t,null,[[1,13]])})));return function(e){return t.apply(this,arguments)}}(),A=e=>M("message/REMOVE",{id:e}),P=e=>M("message/RESET",{tag:e}),T={};let L=0;const z=(e,{autoclear:t=!0,closable:a=!0,duration:r=3e3,extra:n,tag:o,text:c,weight:s=0})=>(l,i)=>{const u=i().messages,d=Object.entries(u).find(([e,t])=>t.tag===o&&t.text===c);let p=0;if(d){const e=Object(O.a)(d,2),t=e[0],a=e[1];p=Number(t),a.timer&&clearTimeout(a.timer)}else p=L++;l(((e,t,a)=>M("message/ADD",{timer:a,id:e,message:t}))(p,{closable:a,extra:n,id:p,stamp:(new Date).getTime(),tag:o,text:c,type:e,weight:s},t?setTimeout(()=>l(A(p)),r):void 0))},F=(e,t)=>z("error",Object(j.a)({text:e},t)),B=(e,t)=>z("info",Object(j.a)({text:e},t)),U=(e,t)=>z("success",Object(j.a)({text:e},t)),q=(e,t,a)=>()=>{window.confirm(e)?t():a&&a()};var W=a(13);const H=e=>{const t=[],a=e.medias.medias,r=e.room.tracks;var n,o=Object(W.a)(r);try{for(o.s();!(n=o.n()).done;){const e=n.value,r=a[e.provider][e.type][e.id];r?t.push(r):t.push(null)}}catch(c){o.e(c)}finally{o.f()}return t},D=e=>e.room.tracks.length;a(169);const V=()=>{const e=Object(i.b)(),t=Object(i.c)(e=>e.room.fetching),a=Object(v.b)().t,r=Object(d.g)(),l=Object(i.c)(E),u=Object(i.c)(_),p=Object(i.c)(e=>e.room.medias.length),m=Object(i.c)(D),b=Object(c.useCallback)(Object(o.a)(n.a.mark((function t(){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x(document.location.href.split("?")[0]);case 2:e(U("rooms.link_copied_to_clipboard"));case 3:case"end":return t.stop()}}),t)}))),[e]),f=Object(c.useCallback)(()=>{e(q(a("rooms.confirm_exit"),()=>{r.push("/")}))},[a,e,r]);return s.a.createElement("div",{className:"Head"},s.a.createElement("div",{className:"HeadInner"},s.a.createElement("div",{className:"RoomLink"},s.a.createElement(k,{icon:"link",onClick:b,size:"M",title:a("rooms.copy_link")})),s.a.createElement("div",{className:"RoomMeta"},t?s.a.createElement(h,{className:"rotating",icon:"refresh",title:a("loading")}):u?s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"RoomName",title:"".concat(a("rooms.media_count",{count:p})," / ").concat(a("rooms.track_count",{count:m}))},l)):null),s.a.createElement("div",{className:"RoomExit"},s.a.createElement(k,{onClick:f,icon:"sign-out",size:"M",title:a("rooms.exit")}))))},Q=s.a.memo(({size:e})=>s.a.createElement(h,{className:"rotating",icon:"circle-o-notch",size:e,title:"Loading"}));a(171);const G=s.a.memo(({playable:e,playing:t,image:a,onPlay:r,onStop:n})=>{const o=Object(v.b)().t;return e?s.a.createElement("div",{className:m()("Cover",{playable:e,playing:t}),style:a?{backgroundImage:"url('".concat(a,"')")}:{},onClick:t?n:r},t?s.a.createElement(h,{icon:"pause",size:"S",title:o("player.stop")}):s.a.createElement(h,{icon:"play",size:"S",title:o("player.play")})):s.a.createElement("div",{className:m()("Cover",{playing:t}),style:a?{backgroundImage:"url('".concat(a,"')")}:{}},t?s.a.createElement(h,{icon:"music",size:"S",title:o("player.playing")}):null)});a(172);const X=s.a.memo(({actions:e,media:t,playable:a,playing:r,onPlay:n,onStop:o})=>{const c=Object(v.b)().t;return t?"album"===t.type?s.a.createElement("div",{className:"Media Album"},s.a.createElement(G,{playable:a,playing:r,image:t.picture_small,onPlay:n,onStop:o}),s.a.createElement("div",{className:"Metas"},s.a.createElement("div",{className:"Meta AlbumTitle"},s.a.createElement("a",{href:t.link,target:"_blank",rel:"noopener noreferrer"},t.name)),s.a.createElement("div",{className:"Meta AlbumArtist"},s.a.createElement("a",{href:t.artist.link,target:"_blank",rel:"noopener noreferrer"},c("medias.by",{artist:t.artist.name})))),e?s.a.createElement("div",{className:"Actions"},e):null):"playlist"===t.type?s.a.createElement("div",{className:"Media Playlist"},s.a.createElement(G,{playable:a,playing:r,image:t.picture_small,onPlay:n,onStop:o}),s.a.createElement("div",{className:"Metas"},s.a.createElement("div",{className:"Meta PlaylistTitle"},s.a.createElement("a",{href:t.link,target:"_blank",rel:"noopener noreferrer"},t.name)),s.a.createElement("div",{className:"Meta PlaylistCreator"},s.a.createElement("a",{href:t.user.link,target:"_blank",rel:"noopener noreferrer"},c("medias.by",{artist:t.user.name})))),e?s.a.createElement("div",{className:"Actions"},e):null):"track"===t.type?s.a.createElement("div",{className:"Media Track"},s.a.createElement(G,{playable:a&&!!t.preview,playing:r,image:t.album.picture_small,onPlay:n,onStop:o}),s.a.createElement("div",{className:"Metas"},s.a.createElement("div",{className:"Meta TrackTitle"},s.a.createElement("a",{href:t.link,target:"_blank",rel:"noopener noreferrer"},t.name)),s.a.createElement("div",{className:"Meta TrackArtist"},s.a.createElement("a",{href:t.artist.link,target:"_blank",rel:"noopener noreferrer"},c("medias.by",{artist:t.artist.name})))),e?s.a.createElement("div",{className:"Actions"},e):null):null:s.a.createElement("div",{className:"Media"},s.a.createElement(G,{playable:a,playing:r,image:"",onPlay:n,onStop:o}),s.a.createElement("div",{className:"Metas"},s.a.createElement(Q,{size:"M"})),e?s.a.createElement("div",{className:"Actions"},e):null)}),J=s.a.memo(({locked:e,track:t,playing:a,onPlay:r,onRemove:n,onStop:o})=>{const c=Object(v.b)().t;return s.a.createElement("div",{className:"QueueItem"},s.a.createElement(X,{media:t,playable:!!t&&!e,playing:a,onPlay:r,onStop:o,actions:s.a.createElement(k,{disabled:e,title:c("medias.remove"),icon:"trash",onClick:n})}))}),Y=Object(c.memo)(({locked:e,tracks:t,playing:a,playingIndex:r,onPlay:n,onRemove:o,onStop:c})=>s.a.createElement(s.a.Fragment,null,t.map((t,l)=>s.a.createElement(J,{key:l,locked:e,playing:a&&r===l,track:t,onPlay:()=>n(l),onRemove:()=>o(l),onStop:c})))),Z=s.a.memo(({loaded:e,locked:t,onSearch:a})=>{const r=Object(v.b)().t;return s.a.createElement("div",{className:"QueueEmpty"},e?s.a.createElement(s.a.Fragment,null,s.a.createElement(k,{title:"...",icon:"shower",onClick:a,size:"L"}),s.a.createElement("span",{onClick:a},r(t?"rooms.empty_for_now":"rooms.empty"))):s.a.createElement(s.a.Fragment,null,s.a.createElement(Q,{size:"L"}),s.a.createElement("span",null,r("rooms.loading"))))});var K=a(298),$=a(38);const ee=e=>new Promise(t=>setTimeout(t,e)),te=(e,t)=>{const a=e.length,r=[];for(let n=0;n<a;n+=t)r.push(e.slice(n,n+t));return r},ae=["E","S","W","N"],re=e=>{return(t=ae)[((a=e)<0?a%t.length+t.length:a)%t.length];var t,a},ne={E:0,S:1,W:2,N:3},oe=["boat1","boat2","boat3"],ce={boat1:{x:6,y:6},boat2:{x:6,y:6},boat3:{x:6,y:6}},se={hitted:{x:4,y:4},missed:{x:4,y:4}},le={hitted:{x:10,y:10},missed:{x:10,y:10}},ie=["bullet1","bullet2","bullet3","mine"],ue={bullet1:{x:12,y:16},bullet2:{x:12,y:16},bullet3:{x:12,y:16},mine:{x:12,y:12}},de=(e,t)=>Object.values(e).filter(e=>e.userId!==t),pe=(e,t)=>{var a;return(null===(a=e.maps[e.currentMapIndex])||void 0===a?void 0:a.userId)===t},me=e=>{e.currentMapIndex=(e.currentMapIndex+1)%e.maps.length},be=e=>Object($.a)(e),fe=e=>Object($.b)(e),ve={boat1:{N:{x:0,y:0},E:{x:0,y:0},S:{x:0,y:0},W:{x:0,y:0}},boat2:{N:{x:0,y:-1},E:{x:1,y:0},S:{x:0,y:1},W:{x:-1,y:0}},boat3:{N:{x:0,y:-2},E:{x:2,y:0},S:{x:0,y:2},W:{x:-2,y:0}}},ye={N:{38:"move_forward",40:"move_backward",37:"rotate_left",39:"rotate_right"},E:{38:"rotate_left",40:"rotate_right",37:"move_backward",39:"move_forward"},S:{38:"move_backward",40:"move_forward",37:"rotate_right",39:"rotate_left"},W:{38:"rotate_right",40:"rotate_left",37:"move_forward",39:"move_backward"}},ge={N:{move_forward:{x:0,y:-1},move_backward:{x:0,y:1}},E:{move_forward:{x:1,y:0},move_backward:{x:-1,y:0}},S:{move_forward:{x:0,y:1},move_backward:{x:0,y:-1}},W:{move_forward:{x:-1,y:0},move_backward:{x:1,y:0}}},he={boat1:1,boat2:2,boat3:3},ke={N:{move_forward:"arrow-up",move_backward:"arrow-down"},E:{move_forward:"arrow-right",move_backward:"arrow-left"},S:{move_forward:"arrow-down",move_backward:"arrow-up"},W:{move_forward:"arrow-left",move_backward:"arrow-right"}},xe=e=>{console.debug("[SeaBattle] Genering battle...");const t={currentMapIndex:0,maps:[]};return Se(t,e),t},Ee=(e,t,a)=>t<0||t>=10||a<0||a>=10?-1:e[a][t],_e=(e,t,a)=>{e[a][t]=1},we=(e,t,a,r)=>{switch(a){case"N":for(let a=0;a<r;++a){if(0!==Ee(e,t.x,t.y-a))return!1}break;case"E":for(let a=0;a<r;++a){if(0!==Ee(e,t.x+a,t.y))return!1}break;case"S":for(let a=0;a<r;++a){if(0!==Ee(e,t.x,t.y+a))return!1}break;case"W":for(let a=0;a<r;++a){if(0!==Ee(e,t.x-a,t.y))return!1}}return!0},je=(e,t)=>{for(;;){const a={x:Math.floor(10*Math.random()),y:Math.floor(10*Math.random())},r=ae[Math.floor(Math.random()*ae.length)];if(we(e,a,r,t)){switch(r){case"N":for(let r=0;r<t;++r)_e(e,a.x,a.y-r);break;case"E":for(let r=0;r<t;++r)_e(e,a.x+r,a.y);break;case"S":for(let r=0;r<t;++r)_e(e,a.x,a.y+r);break;case"W":for(let r=0;r<t;++r)_e(e,a.x-r,a.y)}return{angle:ne[r],position:a}}}},Oe=e=>oe.filter(t=>he[t]<=e),Se=(e,t)=>{if(e.maps.find(e=>e.userId===t))return;console.debug("[SeaBattle] Genering fleet...",{userId:t});const a=Array(10).fill(0).map(e=>Array(10).fill(0));let r=16;const n={boat1:0,boat2:0,boat3:0};for(;r>0;){const e=Oe(r),t=e[Math.floor(Math.random()*e.length)];n[t]++,r-=he[t]}const o=[];var c,s=Object(W.a)(Object.entries(n).reverse());try{for(s.s();!(c=s.n()).done;){const e=c.value,t=Object(O.a)(e,2),r=t[0],n=t[1],s=r,l=he[s];for(let c=0;c<n;++c){const e=je(a,l),t={hits:[],type:s,angle:e.angle,position:e.position,status:"ok"};o.push(t)}}}catch(i){s.e(i)}finally{s.f()}const l={fleet:o,hits:[],opponentsWeapons:[],status:"ok",userId:t,weapons:{bullet1:100,bullet2:6,bullet3:3,mine:3}};e.maps.push(l)},Ce=["dj","seabattle"],Ie=(e,t)=>{const a={};return[...e,...t].forEach(({id:e,provider:t,type:r},n)=>{a[n]={id:e,provider:t,type:r}}),a},Ne=(e,t,a)=>{if(t<0||t>=e.length)throw new Error("Media index is out of range");const r={},n=[...e];return n.splice(t,a),n.forEach(({id:e,provider:t,type:a},n)=>{r[n]={id:e,provider:t,type:a}}),r},Me=({type:e,userId:t})=>{switch(e){case"blind":case"dj":return{extra:"",queue:{medias:{},playing:!1,playmode:"default",position:0}};case"seabattle":return{extra:fe(xe(t)),queue:{medias:{0:{id:"301013",provider:"deezer",type:"album"},1:{id:"7358507",provider:"deezer",type:"album"},2:{id:"558976",provider:"deezer",type:"album"},3:{id:"87375582",provider:"deezer",type:"album"}},playing:!0,playmode:"shuffle",position:0}}}};var Re=a(23);a(60);const Ae={dbIDs:"azjk,odsk,zjkd".split(","),dbPrefix:"rlods-party-"},Pe=()=>Ae.dbIDs[Math.floor(Math.random()*Ae.dbIDs.length)],Te=()=>Ae.dbIDs[0];var Le=Ae;const ze={},Fe=e=>{let t=ze[e];if(!t){console.debug("[Firebase] Creating app",{dbId:e});const a="https://".concat(Le.dbPrefix).concat(e,".firebaseio.com"),r=Re.initializeApp({databaseURL:a},e),n=Re.database(r);ze[e]=t={app:r,database:n,rooms:n.ref("rooms"),users:n.ref("users")}}return t},Be=({dbId:e,roomId:t,secret:a})=>{const r=Fe(e).rooms.child(t),c=r.child("extra"),s=r.child("info"),l=r.child("queue");let i=a||"";const u=function(){var e=Object(o.a)(n.a.mark((function e(){var t,a,r,o,i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.debug("[Firebase] Waiting room..."),e.next=4,Promise.all([c.once("value"),s.once("value"),l.once("value")]);case 4:return t=e.sent,a=Object(O.a)(t,3),r=a[0],o=a[1],i=a[2],e.abrupt("return",{extra:r.val(),info:o.val(),queue:i.val()});case 12:throw e.prev=12,e.t0=e.catch(0),new Error("rooms.errors.invalid");case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();return{dbId:e,roomId:t,init:function(){var e=Object(o.a)(n.a.mark((function e({extra:t,info:a,queue:o}){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.debug("[Firebase] Initializing room...",{extra:!!t,info:a,queue:o}),e.next=3,r.update({extra:t,info:a,queue:o,secret:i,timestamp:Re.database.ServerValue.TIMESTAMP});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),isLocked:()=>!i,setSecret:e=>{console.debug("[Firebase] Setting room secret",{oldSecret:i,newSecret:e}),i=e},wait:u,subscribeExtra:e=>(console.debug("[Firebase] Subscribing room extra..."),c.on("value",t=>{const a=t.val();a&&e(a)})),subscribeInfo:e=>(console.debug("[Firebase] Subscribing room info..."),s.on("value",t=>{const a=t.val();a&&e(a)})),subscribeQueue:e=>(console.debug("[Firebase] Subscribing room queue..."),l.on("value",t=>{const a=t.val();a&&e(a)})),unsubscribeExtra:e=>{console.debug("[Firebase] Unsubscribing room extra..."),c.off("value",e)},unsubscribeInfo:e=>{console.debug("[Firebase] Unsubscribing room info..."),s.off("value",e)},unsubscribeQueue:e=>{console.debug("[Firebase] Unsubscribing room queue..."),l.off("value",e)},updateExtra:function(){var e=Object(o.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.debug("[Firebase] Updating room extra..."),e.next=3,r.update({extra:t,secret:i,timestamp:Re.database.ServerValue.TIMESTAMP});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),updateInfo:function(){var e=Object(o.a)(n.a.mark((function e({name:t,type:a}){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.debug("[Firebase] Updating room info...",{name:t,type:a}),e.next=3,r.update({info:{name:t,type:a},secret:i,timestamp:Re.database.ServerValue.TIMESTAMP});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),updateQueue:function(){var e=Object(o.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.debug("[Firebase] Updating room info...",{queue:t}),e.next=3,r.update({queue:t,secret:i,timestamp:Re.database.ServerValue.TIMESTAMP});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}};var Ue=a(80);const qe=function(){var e=Object(o.a)(n.a.mark((function e(t){var a,r,o,c,s,l;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ue.read(t);case 2:return a=e.sent,e.next=5,a.resize(1,1).getPixelColor(0,0);case 5:return r=e.sent,o=Ue.intToRGBA(r),c=o.r,s=o.g,l=o.b,e.abrupt("return",{r:c,g:s,b:l});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),We={},He={bg:{r:255,g:255,b:255},fg:"dark"},De=function(){var e=Object(o.a)(n.a.mark((function e(t){var a,r,o,c,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=He,!t){e.next=18;break}if(a=We[t]){e.next=18;break}return e.prev=4,e.next=7,qe(t);case 7:r=e.sent,o=r.r,c=r.g,s=r.b,We[t]=a={bg:{r:o,g:c,b:s},fg:.299*o+.587*c+.114*s>186?"dark":"light"},e.next=18;break;case 14:e.prev=14,e.t0=e.catch(4),console.error("An error prevented colorpicking",e.t0),We[t]=a=He;case 18:return e.abrupt("return",a);case 19:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(t){return e.apply(this,arguments)}}(),Ve=[];let Qe=null;const Ge=()=>(Qe||(console.debug("[Audio] Creating context"),Qe=new(window.AudioContext||window.webkitAudioContext)),Qe),Xe=()=>Ge().currentTime,Je=e=>new Promise((t,a)=>Ge().decodeAudioData(e,t,a)),Ye=e=>new Promise((t,a)=>{const r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.addEventListener("error",()=>a(new Error("audio.errors.cannot_load_audio_buffer")),!1),r.addEventListener("load",Object(o.a)(n.a.mark((function o(){return n.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.t0=t,n.next=4,Je(r.response);case 4:n.t1=n.sent,(0,n.t0)(n.t1),n.next=12;break;case 8:n.prev=8,n.t2=n.catch(0),console.debug("[Audio] An error occurred while decoding data",{error:n.t2,url:e}),a(new Error("audio.errors.cannot_decode_audio_data"));case 12:case"end":return n.stop()}}),o,null,[[0,8]])}))),!1),r.send()}),Ze=function(){var e=Object(o.a)(n.a.mark((function e(t){var a,r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("URL is invalid");case 2:if(a=null,!((r=Ve.findIndex(e=>e.url===t))>=0)){e.next=9;break}console.debug("[Audio] Reusing cached buffer...",{url:t}),a=Ve.splice(r,1)[0].buffer,e.next=13;break;case 9:return console.debug("[Audio] Loading buffer...",{url:t}),e.next=12,Ye(t);case 12:a=e.sent;case 13:return Ve.push({buffer:a,url:t}),Ve.splice(10),e.abrupt("return",a);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(()=>{const e=()=>{document.removeEventListener("click",e),document.removeEventListener("touchstart",e),console.debug("[Audio] Fixing context...");const t=Ge();var a=t.createBuffer(1,1,22050),r=t.createBufferSource();r.buffer=a,r.connect(t.destination),r.start(0)};document.addEventListener("click",e),document.addEventListener("touchstart",e)})();const Ke=()=>Math.floor(1e6*Math.random()),$e=()=>{let e=null,t=null,a=null,r=0,c=null,s=0,l="",i=-1;const u=()=>(a||(a=Ge().destination,t=Ge().createGain(),t.gain.value=1,t.connect(a),a=t,e=Ge().createAnalyser(),e.fftSize=128,e.connect(a),a=e),a),d=function(){var e=Object(o.a)(n.a.mark((function e(t,a,o,d,m){var b;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p();case 2:return e.next=4,Ze(o);case 4:b=e.sent,console.debug("[Player] Starting audio...",{trackPosition:t,trackId:a,trackUrl:o}),r=b.duration,l=a,i=t,c=Ge().createBufferSource(),c.buffer=b,c.loop=!1,c.loopStart=0,c.loopEnd=0,c.onended=()=>{console.debug("[Player] Audio terminated..."),r=0,c=null,s=0,l="","shuffle"===(null===m||void 0===m?void 0:m.playmode)?i+=Ke():i++},c.playbackRate.value=1,c.connect(u()),c.start(0,d),s=Xe();case 19:case"end":return e.stop()}}),e)})));return function(t,a,r,n,o){return e.apply(this,arguments)}}(),p=()=>new Promise(e=>{null!==c?(console.debug("[Player] Stopping play..."),c.onended=()=>{console.debug("[Player] Forced audio termination..."),e()},c.stop(),r=0,c=null,s=0,l="",i=-1):e()});return{getPlayingTrackID:()=>l,getPlayingTrackPercent:()=>c?(Xe()-s)/r:0,getPlayingTrackPosition:()=>i,isPlaying:()=>!!c,play:d,stop:p}},et=(e,t,a,r,n,o)=>{if(!e||0===n.length)return-1;let c=-1;return r!==o?t?a!==n[o].id&&(c=o):c=r>=0?r:o:a!==n[o].id&&(c=o),c},tt=$e(),at=$e();var rt=a(142),nt=a.n(rt);var ot={secret:"...",url:"https://proxy.rlods.xyz/api"},ct=a(143),st=a.n(ct);const lt=(e,t,a)=>{const r=st.a.createHmac("sha256",a),n=Object.entries(t).sort((e,t)=>e[0].localeCompare(t[0]));r.update(e);var o,c=Object(W.a)(n);try{for(c.s();!(o=c.n()).done;){const e=o.value;r.update(e[0]),r.update(e[1])}}catch(s){c.e(s)}finally{c.f()}return r.digest("hex")},it=function(){var e=Object(o.a)(n.a.mark((function e(t,a){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.debug("[Proxy] Requesting... ",{path:t,params:a}),e.next=3,nt.a.get("".concat(ot.url).concat(t),{params:Object(j.a)({},a,{s:lt(t,a,ot.secret)})});case 3:return e.abrupt("return",e.sent.data);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),ut="https://www.deezer.com",dt=e=>({artist:{id:e.artist.id.toString(),name:e.artist.name,link:"".concat(ut,"/artist/").concat(e.artist.id)},id:e.id.toString(),link:"".concat(ut,"/album/").concat(e.id),name:e.title,picture_big:e.cover_big,picture_small:e.cover_small,provider:"deezer",tracks:void 0!==e.tracks?e.tracks.data.filter(e=>e.readable&&e.preview).map(t=>mt(t,e)):[],type:"album"}),pt=(e,t)=>({id:e.id.toString(),link:"".concat(ut,"/playlist/").concat(e.id),name:e.title,picture_big:e.picture_big,picture_small:e.picture_small,provider:"deezer",tracks:void 0!==e.tracks?e.tracks.data.filter(e=>e.readable&&e.preview).map(e=>mt(e,e.album)):[],type:"playlist",user:{id:t.id.toString(),link:"".concat(ut,"/profile/").concat(t.id),name:t.name}}),mt=(e,t)=>({album:{id:t.id.toString(),link:"".concat(ut,"/album/").concat(t.id),name:t.title,picture_big:t.cover_big,picture_small:t.cover_small},artist:{id:e.artist.id.toString(),link:"".concat(ut,"/artist/").concat(e.artist.id),name:e.artist.name},id:e.id.toString(),link:"".concat(ut,"/track/").concat(e.id),name:e.title,preview:e.preview,provider:"deezer",type:"track"}),bt=()=>{const e=(e,t)=>it("/deezer/".concat(e),t),t=(t,a,r)=>e("search",{limit:((null===r||void 0===r?void 0:r.limit)||10).toString(),q:encodeURIComponent(a),type:t}),a=function(){var t=Object(o.a)(n.a.mark((function t(a,r){var c,s,l;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=[],s=[],l=[],t.next=5,Promise.all(r.map(function(){var t=Object(o.a)(n.a.mark((function t(r){var o;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e("load",{id:r,type:a});case 2:if((o=t.sent).error){t.next=7;break}return console.log("[Deezer] Loaded media",{type:a,id:r,media:o}),l.push(o),t.abrupt("return");case 7:if(4!==o.error.code){t.next=10;break}return c.push(r),t.abrupt("return");case 10:console.error("[Deezer] An error occured while loading ".concat(a,":"),o.error),s.push(r);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 5:return t.abrupt("return",{delayedIds:c,failedIds:s,loadedMedias:l});case 6:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),r=function(){var e=Object(o.a)(n.a.mark((function e(t,r){var o,c,s,l,i,u;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=!0,c=[],s=[...r];case 3:if(!(s.length>0)){e.next=18;break}if(o){e.next=8;break}return console.debug("[Deezer] Handling rate limit delayed batch...",{remainingIds:s}),e.next=8,ee(5e3);case 8:return e.next=10,a(t,s);case 10:l=e.sent,i=l.delayedIds,u=l.loadedMedias,c.push(...u),s=i,o=!1,e.next=3;break;case 18:return e.abrupt("return",c);case 19:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return{searchAlbums:function(){var e=Object(o.a)(n.a.mark((function e(a,r){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==a.trim().length){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,t("album",a,r);case 4:return e.abrupt("return",e.sent.data.map(dt));case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),searchPlaylists:function(){var e=Object(o.a)(n.a.mark((function e(a,r){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==a.trim().length){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,t("playlist",a,r);case 4:return e.abrupt("return",e.sent.data.filter(e=>e.public).map(e=>pt(e,e.user)));case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),searchTracks:function(){var e=Object(o.a)(n.a.mark((function e(a,r){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==a.trim().length){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,t("track",a,r);case 4:return e.abrupt("return",e.sent.data.filter(e=>e.readable&&e.preview).map(e=>mt(e,e.album)));case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),loadAlbums:function(){var e=Object(o.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",[]);case 2:return console.debug("[Deezer] Loading albums...",{ids:t}),e.next=5,r("album",t);case 5:return a=e.sent,e.abrupt("return",a.map(dt));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),loadPlaylists:function(){var e=Object(o.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",[]);case 2:return console.debug("[Deezer] Loading playlists...",{ids:t}),e.next=5,r("playlist",t);case 5:return a=e.sent,e.abrupt("return",a.map(e=>pt(e,e.creator)));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),loadTracks:function(){var e=Object(o.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",[]);case 2:return console.debug("[Deezer] Loading tracks...",{ids:t}),e.next=5,r("track",t);case 5:return a=e.sent,e.abrupt("return",a.map(e=>mt(e,e.album)));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}};let ft=null;const vt=()=>(ft||(ft=bt()),ft),yt="https://open.spotify.com",gt=e=>({artist:{id:e.artists[0].id.toString(),name:e.artists[0].name,link:"".concat(yt,"/artist/").concat(e.artists[0].id)},id:e.id,link:"".concat(yt,"/album/").concat(e.id),name:e.name,picture_big:e.images[0].url,picture_small:e.images[0].url,provider:"spotify",tracks:void 0!==e.tracks?e.tracks.items.filter(e=>e.preview_url).map(t=>kt(t,e)):[],type:"album"}),ht=e=>({id:e.id,link:"".concat(yt,"/playlist/").concat(e.id),name:e.name,picture_big:e.images[0].url,picture_small:e.images[0].url,provider:"spotify",tracks:void 0!==e.tracks.items?e.tracks.items.filter(e=>e.track.preview_url).map(e=>kt(e.track,e.track.album)):[],type:"playlist",user:{id:e.owner.id,link:"".concat(yt,"/user/").concat(e.owner.id),name:e.owner.display_name}}),kt=(e,t)=>({album:{id:t.id,link:"".concat(yt,"/album/").concat(t.id),name:t.name,picture_big:t.images[0].url,picture_small:t.images[0].url},artist:{id:e.artists[0].id,name:e.artists[0].name,link:"".concat(yt,"/artist/").concat(e.artists[0].id)},id:e.id,link:"".concat(yt,"/track/").concat(e.id),name:e.name,preview:e.preview_url||"",provider:"spotify",type:"track"}),xt=()=>{const e=(e,t)=>it("/spotify/".concat(e),t),t=(t,a,r)=>e("search",{limit:((null===r||void 0===r?void 0:r.limit)||10).toString(),market:"US",q:encodeURIComponent(a),type:t}),a=function(){var t=Object(o.a)(n.a.mark((function t(a,r){var c,s,l;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=[],s=[],l=[],t.next=5,Promise.all(te(r,50).map(function(){var t=Object(o.a)(n.a.mark((function t(r){var o;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e("load",{ids:r.join(","),market:"US",type:a});case 2:t.t0="".concat(a,"s"),o=t.sent[t.t0],console.log("[Spotify] Loaded media",{type:a,ids:r,medias:o}),l.push(...o);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 5:return t.abrupt("return",{delayedIds:c,failedIds:s,loadedMedias:l});case 6:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),r=function(){var e=Object(o.a)(n.a.mark((function e(t,r){var o,c,s,l,i,u;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=[],c=!0,s=[...r];case 3:if(!(s.length>0)){e.next=18;break}if(c){e.next=8;break}return console.debug("[Spotify] Handling rate limit delayed batch...",{remainingIds:s}),e.next=8,ee(5e3);case 8:return e.next=10,a(t,s);case 10:l=e.sent,i=l.delayedIds,u=l.loadedMedias,o.push(...u),s=i,c=!1,e.next=3;break;case 18:return e.abrupt("return",o);case 19:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return{searchAlbums:function(){var e=Object(o.a)(n.a.mark((function e(a,r){var o;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==a.trim().length){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,t("album",a,r);case 4:return o=e.sent,e.abrupt("return",o.albums.items.map(gt));case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),searchPlaylists:function(){var e=Object(o.a)(n.a.mark((function e(a,r){var o;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==a.trim().length){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,t("playlist",a,r);case 4:return o=e.sent,e.abrupt("return",o.playlists.items.filter(e=>!1!==e.public).map(ht));case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),searchTracks:function(){var e=Object(o.a)(n.a.mark((function e(a,r){var o;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==a.trim().length){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,t("track",a,r);case 4:return o=e.sent,e.abrupt("return",o.tracks.items.filter(e=>e.preview_url).map(e=>kt(e,e.album)));case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),loadAlbums:function(){var e=Object(o.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",[]);case 2:return console.debug("[Spotify] Loading albums...",{ids:t}),e.next=5,r("album",t);case 5:return a=e.sent,e.abrupt("return",a.map(gt));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),loadPlaylists:function(){var e=Object(o.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",[]);case 2:return console.debug("[Spotify] Loading playlists...",{ids:t}),e.next=5,r("playlist",t);case 5:return a=e.sent,e.abrupt("return",a.map(ht));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),loadTracks:function(){var e=Object(o.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",[]);case 2:return console.debug("[Spotify] Loading tracks...",{ids:t}),e.next=5,r("track",t);case 5:return a=e.sent,e.abrupt("return",a.map(e=>kt(e,e.album)));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}};let Et=null;const _t=()=>(Et||(Et=xt()),Et),wt=function(){var e=Object(o.a)(n.a.mark((function e(t){var a,r,o,c,s,l,i,u,d,p,m;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={deezer:{album:[],playlist:[],track:[]},spotify:{album:[],playlist:[],track:[]}},r=Object(W.a)(t);try{for(r.s();!(o=r.n()).done;)c=o.value,a[c.provider][c.type].push(c.id)}catch(n){r.e(n)}finally{r.f()}return s=vt(),l=_t(),e.next=7,s.loadAlbums(a.deezer.album);case 7:return e.t0=e.sent,e.next=10,s.loadPlaylists(a.deezer.playlist);case 10:return e.t1=e.sent,e.next=13,s.loadTracks(a.deezer.track);case 13:return e.t2=e.sent,e.t3={album:e.t0,playlist:e.t1,track:e.t2},e.next=17,l.loadAlbums(a.spotify.album);case 17:return e.t4=e.sent,e.next=20,l.loadPlaylists(a.spotify.playlist);case 20:return e.t5=e.sent,e.next=23,l.loadTracks(a.spotify.track);case 23:e.t6=e.sent,e.t7={album:e.t4,playlist:e.t5,track:e.t6},i={deezer:e.t3,spotify:e.t7},u=[],d=Object(W.a)(t);try{for(d.s();!(p=d.n()).done;)c=p.value,(m=i[c.provider][c.type].find(e=>e.id===c.id))&&u.push(m)}catch(n){d.e(n)}finally{d.f()}return e.abrupt("return",u);case 30:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),jt=function(){var e=Object(o.a)(n.a.mark((function e(t,a){var r,o,c,s,l,i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.filter(e=>!a[e.provider][e.type][e.id]).filter((e,t,a)=>t===a.findIndex(t=>t.id===e.id&&t.provider===e.provider&&t.type===e.type)),e.next=3,wt(r);case 3:o=e.sent,c=[],s=Object(W.a)(o);try{for(s.s();!(l=s.n()).done;)i=l.value,c.push(i),"track"!==i.type&&c.push(...i.tracks)}catch(n){s.e(n)}finally{s.f()}return e.abrupt("return",{newMedias:o,newMediasAndTracks:c});case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Ot=function(){var e=Object(o.a)(n.a.mark((function e(t,a,r,o){var c,s,l,i,u,d,p,m,b,f,v,y,g;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=vt(),s=_t(),r&&o){e.next=14;break}return e.next=5,Promise.all([c.searchAlbums(t,a),c.searchPlaylists(t,a),c.searchTracks(t,a),s.searchAlbums(t,a),s.searchPlaylists(t,a),s.searchTracks(t,a)]);case 5:return l=e.sent,i=Object(O.a)(l,6),u=i[0],d=i[1],p=i[2],m=i[3],b=i[4],f=i[5],e.abrupt("return",{deezer:{album:u,playlist:d,track:p},spotify:{album:m,playlist:b,track:f}});case 14:y=(v={deezer:{album:[],playlist:[],track:[]},spotify:{album:[],playlist:[],track:[]}})[r],g="deezer"===r?c:s,e.t0=o,e.next="album"===e.t0?20:"playlist"===e.t0?24:"track"===e.t0?28:32;break;case 20:return e.next=22,g.searchAlbums(t,a);case 22:return y.album=e.sent,e.abrupt("break",32);case 24:return e.next=26,g.searchPlaylists(t,a);case 26:return y.playlist=e.sent,e.abrupt("break",32);case 28:return e.next=30,g.searchTracks(t,a);case 30:return y.track=e.sent,e.abrupt("break",32);case 32:return e.abrupt("return",v);case 33:case"end":return e.stop()}}),e)})));return function(t,a,r,n){return e.apply(this,arguments)}}(),St=e=>M("medias/SET",e),Ct={error:null,fetching:!1,medias:{deezer:{album:{},playlist:{},track:{}},spotify:{album:{},playlist:{},track:{}}}},It=e=>M("room/SET",e),Nt={_fbRoom:null,access:{dbId:"",roomId:"",secret:""},color:{fg:"dark",bg:{r:255,g:255,b:255}},error:null,extra:"",fetching:!1,info:null,medias:[],queue:null,tracks:[]},Mt=[{label:"medias.deezer.albums",provider:"deezer",type:"album"},{label:"medias.deezer.playlists",provider:"deezer",type:"playlist"},{label:"medias.deezer.tracks",provider:"deezer",type:"track"},{label:"medias.spotify.albums",provider:"spotify",type:"album"},{label:"medias.spotify.playlists",provider:"spotify",type:"playlist"},{label:"medias.spotify.tracks",provider:"spotify",type:"track"}],Rt=(e,t)=>t[e.provider][e.type][e.id],At=(e,t,a)=>Rt(e,t)||((e,t)=>t.find(t=>t.id===e.id&&t.provider===e.provider&&t.type===e.type))(e,a),Pt=(e,t,a)=>{const r=At(e,t,a);return r?"track"===r.type?r:r.tracks&&r.tracks.length>0?r.tracks[0]:null:null},Tt=(e,t,a)=>{const r=[];var n,o=Object(W.a)(e);try{for(o.s();!(n=o.n()).done;){const e=n.value;if("track"===e.type){r.push({contextId:e.id,contextType:e.type,id:e.id,provider:e.provider,type:e.type});continue}const o=At(e,t,a);if(!o)throw new Error("Media is unknown");if("track"!==o.type&&o.tracks&&o.tracks.length>0){var c,s=Object(W.a)(o.tracks);try{for(s.s();!(c=s.n()).done;){const e=c.value;r.push({contextId:o.id,contextType:o.type,id:e.id,provider:e.provider,type:e.type})}}catch(l){s.e(l)}finally{s.f()}}}}catch(l){o.e(l)}finally{o.f()}return r},Lt=(e,t,a)=>{if(t<0)throw new Error("Track index is out of range");let r=0;for(let n=0;n<e.length;++n){const o=e[n];if("track"===o.type){if(t===r)return{mediaFirstTrackIndex:t,mediaIndex:n,mediaSize:1};r++}else{const e=Rt(o,a);if(!e)throw new Error("Media is unknown");if("track"!==e.type&&e.tracks&&e.tracks.length>0){const a=r;for(let o=0;o<e.tracks.length;++o){if(t===r)return{mediaFirstTrackIndex:a,mediaIndex:n,mediaSize:e.tracks.length};r++}}}}throw new Error("Track index is out of range")},zt=e=>t=>t(z("info",{duration:5e3,extra:()=>(e=>s.a.createElement(X,{media:e,playable:!1,playing:!0}))(e)})),Ft=e=>(t,a)=>t(R({onAction:function(){var t=Object(o.a)(n.a.mark((function t(){var r,o,c,s,l;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a(),o=r.medias.medias,t.next=3,jt([e],o);case 3:if(c=t.sent,s=c.newMedias,l=Pt(e,o,s)){t.next=8;break}throw new Error("[Medias] Cannot find track to preview...");case 8:return console.debug("[Medias] Previewing track...",{track:l}),t.next=11,at.play(0,l.id,l.preview,0);case 11:return t.abrupt("return",!0);case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}));var Bt=a(15),Ut=Object(Bt.b)();const qt=({dbId:e,name:t,secret:a,type:r,options:c})=>(s,l)=>s(R({onAction:function(){var i=Object(o.a)(n.a.mark((function o(){var i,u,d,p,m,b;return n.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=l(),u=i.user.access.userId){n.next=4;break}return s(F("user.not_connected")),n.abrupt("return","connect-and-retry");case 4:return d=Object(K.a)(),console.debug("[Room] Creating...",{dbId:e,roomId:d,secret:a}),p=Me({type:r,userId:u}),m=p.extra,b=p.queue,n.next=9,Be({dbId:e,roomId:d,secret:a}).init({extra:m,info:{name:t,type:r},queue:b});case 9:return s(Wt({dbId:e,roomId:d,secret:a,options:c})),n.abrupt("return",!0);case 11:case"end":return n.stop()}}),o)})));return function(){return i.apply(this,arguments)}}(),onFailure:()=>{(null===c||void 0===c?void 0:c.onFailure)&&c.onFailure()}})),Wt=({dbId:e,roomId:t,secret:a,options:r})=>(c,s)=>c(R(Object(j.a)({onAction:function(){var r=Object(o.a)(n.a.mark((function r(){var o,l,i,u,d,p,m;return n.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=s(),l=o.room._fbRoom,i=o.user.access.userId,!l||l.dbId!==e||l.roomId!==t){r.next=3;break}return r.abrupt("return",!0);case 3:if(c(Ht()),i){r.next=7;break}return c(F("user.not_connected")),r.abrupt("return","connect-and-retry");case 7:return c(M("room/FETCHING")),console.debug("[Room] Entering...",{dbId:e,roomId:t,secret:a}),u=Be({dbId:e,roomId:t,secret:a}),r.next=12,u.wait();case 12:return d=r.sent,p=d.extra,m=d.info,c(It({_fbRoom:u,access:{dbId:e,roomId:t,secret:a},extra:p,info:m})),c(Jt(u)),c(Kt()),Ut.push("/room/".concat(e,"/").concat(t,"?secret=").concat(a)),r.abrupt("return",!0);case 20:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),onFailure:()=>{c(M("room/ERROR","Cannot enter")),c(Ht()),(null===r||void 0===r?void 0:r.onFailure)&&r.onFailure()}},r))),Ht=()=>(e,t)=>e(R({onAction:function(){var a=Object(o.a)(n.a.mark((function a(){var r,o;return n.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=t(),o=r.room._fbRoom){a.next=3;break}return a.abrupt("return",!0);case 3:return console.debug("[Room] Exiting..."),e($t()),e(Yt(o)),e(M("room/RESET")),a.abrupt("return",!0);case 8:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}()})),Dt=()=>(e,t)=>e(R({onAction:function(){var a=Object(o.a)(n.a.mark((function a(){var r,o,c,s,l,i,u;return n.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=t(),o=r.room,c=o._fbRoom,s=o.access,l=s.dbId,i=s.roomId,u=s.secret,c&&c.dbId===l&&c.roomId===i&&u){a.next=3;break}return a.abrupt("return",!0);case 3:return console.debug("[Room] Locking...",{dbId:l,roomId:i}),c.setSecret(""),e(It({access:{dbId:l,roomId:i,secret:""}})),a.abrupt("return",!0);case 7:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}()})),Vt=({secret:e,options:t})=>(a,r)=>a(R(Object(j.a)({onAction:function(){var t=Object(o.a)(n.a.mark((function t(){var o,c,s,l,i,u,d;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=r(),c=o.room,s=c._fbRoom,l=c.access,i=l.dbId,u=l.roomId,d=l.secret,s&&s.dbId===i&&s.roomId===u&&d!==e){t.next=3;break}return t.abrupt("return",!0);case 3:return console.debug("[Room] Unlocking...",{dbId:i,roomId:u,secret:e}),s.setSecret(e),a(It({access:{dbId:i,roomId:u,secret:e}})),t.abrupt("return",!0);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},t)));let Qt=null,Gt=null,Xt=null;const Jt=e=>function(){var t=Object(o.a)(n.a.mark((function t(a,r){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.debug("[Room] Watching..."),!(Qt||Gt||Xt)){t.next=3;break}return t.abrupt("return");case 3:Qt=e.subscribeExtra(function(){var e=Object(o.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.debug("[Room] Received room extra update...",{newExtra:t}),a(It({extra:t}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Gt=e.subscribeInfo(function(){var e=Object(o.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.debug("[Room] Received room info update...",{newInfo:t}),a(It({info:t}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Xt=e.subscribeQueue(function(){var e=Object(o.a)(n.a.mark((function e(t){var o,c,s,l,i,u,d;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.debug("[Room] Received room queue update...",{newQueue:t}),o=r(),c=o.medias.medias,s=t.medias?Object.entries(t.medias).sort((e,t)=>Number(e[0])-Number(t[0])).map(e=>e[1]):[],l=[],!(s.length>0)){e.next=12;break}return e.next=7,jt(s,c);case 7:i=e.sent,u=i.newMedias,(d=i.newMediasAndTracks).length>0&&a(St(d)),l=Tt(s,c,u);case 12:a(It({queue:t,medias:s,tracks:l}));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),Yt=e=>Object(o.a)(n.a.mark((function t(){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Qt&&(console.debug("Unwatching room extra..."),e.unsubscribeExtra(Qt),Qt=null),Gt&&(console.debug("Unwatching room info..."),e.unsubscribeInfo(Gt),Gt=null),Xt&&(console.debug("Unwatching room queue..."),e.unsubscribeQueue(Xt),Xt=null);case 3:case"end":return t.stop()}}),t)})));let Zt=null;const Kt=()=>function(){var e=Object(o.a)(n.a.mark((function e(t,a,{player:r}){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Zt||(console.debug("[Room] Watching player..."),ea(t,a,r,250));case 1:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),$t=()=>function(){var e=Object(o.a)(n.a.mark((function e(t,a,{player:r}){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Zt&&(console.debug("[Room] Unwatching player..."),clearTimeout(Zt),Zt=null),e.next=3,r.stop();case 3:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),ea=(e,t,a,r)=>{Zt=setTimeout(Object(o.a)(n.a.mark((function o(){var c,s,l,i,u,d,p,m,b,f,v,y,g,h;return n.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(c=t(),s=c.room,l=s.queue,i=s.tracks,u=c.medias.medias,!l){n.next=24;break}if(d=l.playing,p=l.playmode,m=l.position,!((b=et(d,a.isPlaying(),a.getPlayingTrackID(),a.getPlayingTrackPosition()%i.length,i,m))>=0)){n.next=23;break}return f=i[b],v=u[f.provider][f.type][f.id],console.debug("Detected play change...",{nextTrack:v,nextTrackIndex:b}),n.prev=8,n.next=11,Promise.all([De(v.album.picture_small),a.play(b,v.id,v.preview,0,{playmode:p})]);case 11:y=n.sent,g=Object(O.a)(y,1),h=g[0],e(zt(v)),e(It({color:h,queue:Object(j.a)({},l,{position:b})})),n.next=21;break;case 18:n.prev=18,n.t0=n.catch(8),e(F(S(n.t0)));case 21:n.next=24;break;case 23:d||a.stop();case 24:ea(e,t,a,r);case 25:case"end":return n.stop()}}),o,null,[[8,18]])}))),r)},ta=({propagate:e})=>(t,a)=>t(R({onAction:function(){var r=Object(o.a)(n.a.mark((function r(){var o,c,s,l,i;return n.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=a(),c=o.room,s=c._fbRoom,l=c.queue,i=c.tracks,s&&!s.isLocked()&&l){r.next=4;break}return t(F("rooms.errors.locked")),r.abrupt("return","unlock-and-retry");case 4:if(!l.playing){r.next=6;break}return r.abrupt("return",!0);case 6:if(console.debug("[Player] Starting...",{propagate:e}),e){r.next=10;break}return t(It({queue:Object(j.a)({},l,{playing:!0,position:"shuffle"===l.playmode?Ke()%i.length:l.position})})),r.abrupt("return",!0);case 10:return r.next=12,s.updateQueue(Object(j.a)({},l,{playing:!0}));case 12:return r.abrupt("return",!0);case 13:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),onFailure:()=>t(Dt())})),aa=({propagate:e})=>(t,a)=>t(R({onAction:function(){var r=Object(o.a)(n.a.mark((function r(){var o,c,s,l;return n.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=a(),c=o.room,s=c._fbRoom,l=c.queue,s&&!s.isLocked()&&l){r.next=4;break}return t(F("rooms.errors.locked")),r.abrupt("return","unlock-and-retry");case 4:if(l.playing){r.next=6;break}return r.abrupt("return",!0);case 6:if(console.debug("[Player] Stopping...",{propagate:e}),e){r.next=10;break}return t(It({queue:Object(j.a)({},l,{playing:!1})})),r.abrupt("return",!0);case 10:return r.next=12,s.updateQueue(Object(j.a)({},l,{playing:!1}));case 12:return r.abrupt("return",!0);case 13:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),onFailure:()=>t(Dt())})),ra=({propagate:e})=>(t,a)=>t(R({onAction:function(){var r=Object(o.a)(n.a.mark((function r(){var o,c,s,l;return n.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=a(),c=o.room,s=c._fbRoom,l=c.queue,s&&!s.isLocked()&&l){r.next=4;break}return t(F("rooms.errors.locked")),r.abrupt("return","unlock-and-retry");case 4:if(console.debug("[Queue] Clearing..."),e){r.next=8;break}return t(It({queue:Object(j.a)({},l,{playing:!1,medias:{},position:0})})),r.abrupt("return",!0);case 8:return r.next=10,s.updateQueue(Object(j.a)({},l,{medias:{},playing:!1,position:0}));case 10:return r.abrupt("return",!0);case 11:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),onFailure:()=>t(Dt())})),na=e=>(t,a)=>t(R({onAction:function(){var r=Object(o.a)(n.a.mark((function r(){var o,c,s,l,i;return n.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=a(),c=o.room,s=c._fbRoom,l=c.queue,i=c.medias,s&&!s.isLocked()&&l){r.next=4;break}return t(F("rooms.errors.locked")),r.abrupt("return","unlock-and-retry");case 4:if(0!==e.length){r.next=6;break}return r.abrupt("return",!0);case 6:return console.debug("[Queue] Appending...",{newMedias:e}),r.next=9,s.updateQueue(Object(j.a)({},l,{medias:Ie(i,e)}));case 9:return r.abrupt("return",!0);case 10:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),onFailure:()=>t(Dt())})),oa=({position:e})=>(t,a)=>t(R({onAction:function(){var r=Object(o.a)(n.a.mark((function r(){var o,c,s,l,i,u,d,p,m,b,f,v,y;return n.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=a(),c=o.medias.medias,s=o.room,l=s._fbRoom,i=s.queue,u=s.medias,d=s.tracks,l&&!l.isLocked()&&i){r.next=4;break}return t(F("rooms.errors.locked")),r.abrupt("return","unlock-and-retry");case 4:if(p=Lt(u,e,c),m=p.mediaFirstTrackIndex,b=p.mediaIndex,f=p.mediaSize,!(b<0)){r.next=7;break}return r.abrupt("return",!0);case 7:if(v=i.position,console.debug("[Queue] Removing...",{playingTrackIndex:v,removedMediaIndex:b,removedTrackCount:f,removedTrackIndex:e,removedMediaFirstTrackIndex:m}),y=Ne(u,b,1),0!==Object.keys(y).length){r.next=16;break}return console.debug("[Queue] Removing last..."),r.next=14,l.updateQueue(Object(j.a)({},i,{medias:{},playing:!1,position:0}));case 14:r.next=28;break;case 16:if(!(v<e)){r.next=21;break}return r.next=19,l.updateQueue(Object(j.a)({},i,{medias:y}));case 19:r.next=28;break;case 21:if(!(v>=m&&v<m+f)){r.next=26;break}return r.next=24,l.updateQueue(Object(j.a)({},i,{medias:y,position:m+f===d.length?m-1:m}));case 24:r.next=28;break;case 26:return r.next=28,l.updateQueue(Object(j.a)({},i,{medias:y,position:v-f}));case 28:return r.abrupt("return",!0);case 29:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),onFailure:()=>t(Dt())})),ca=({position:e,propagate:t})=>(a,r)=>a(R({onAction:function(){var c=Object(o.a)(n.a.mark((function o(){var c,s,l,i,u;return n.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(c=r(),s=c.room,l=s._fbRoom,i=s.queue,l&&!l.isLocked()&&i){n.next=4;break}return a(F("rooms.errors.locked")),n.abrupt("return","unlock-and-retry");case 4:if((u=i.position)!==e){n.next=7;break}return n.abrupt("return",!0);case 7:if(console.debug("[Queue] Setting position...",{oldPosition:u,newPosition:e,propagate:t}),t){n.next=11;break}return a(It({queue:Object(j.a)({},i,{playing:!0,position:e})})),n.abrupt("return",!0);case 11:return n.next=13,l.updateQueue(Object(j.a)({},i,{playing:!0,position:e}));case 13:return n.abrupt("return",!0);case 14:case"end":return n.stop()}}),o)})));return function(){return c.apply(this,arguments)}}(),onFailure:()=>a(Dt())})),sa=({propagate:e})=>(t,a)=>t(R({onAction:function(){var r=Object(o.a)(n.a.mark((function r(){var o,c,s,l;return n.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=a(),c=o.room,s=c.queue,l=c.tracks,s&&0!==l.length){r.next=3;break}return r.abrupt("return",!0);case 3:return t(ca({position:s.position>0?s.position-1:l.length-1,propagate:e})),r.abrupt("return",!0);case 5:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}()})),la=({propagate:e})=>(t,a)=>t(R({onAction:function(){var r=Object(o.a)(n.a.mark((function r(){var o,c,s,l;return n.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=a(),c=o.room,s=c.queue,l=c.tracks,s&&0!==l.length){r.next=3;break}return r.abrupt("return",!0);case 3:return t(ca({position:"shuffle"===s.playmode?Ke()%l.length:(s.position+1)%l.length,propagate:e})),r.abrupt("return",!0);case 5:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}()})),ia=e=>{var t;return(null===(t=e.room.queue)||void 0===t?void 0:t.position)||0},ua=e=>{var t;return(null===(t=e.room.queue)||void 0===t?void 0:t.playmode)||"default"},da=e=>{var t;return(null===(t=e.room.queue)||void 0===t?void 0:t.playing)||!1};a(273);const pa=()=>{const e=Object(i.b)(),t=Object(i.c)(_),a=Object(i.c)(w),r=Object(i.c)(da),n=Object(i.c)(ia),o=Object(i.c)(H),l=Object(c.useCallback)(t=>{e(ta({propagate:!0})),e(ca({position:t,propagate:!0}))},[e]),u=Object(c.useCallback)(t=>e(oa({position:t})),[e]),d=Object(c.useCallback)(()=>e(C({type:"Room/Search",props:null})),[e]),p=Object(c.useCallback)(()=>e(aa({propagate:!0})),[e]);return s.a.createElement("div",{className:"Queue"},o.length>0?s.a.createElement(Y,{locked:a,tracks:o,playing:r,playingIndex:n,onPlay:l,onRemove:u,onStop:p}):s.a.createElement(Z,{loaded:t,locked:a,onSearch:d}))};a(274);const ma=({bigPlayer:e,className:t,propagate:a})=>{const r=Object(i.b)(),n=Object(v.b)().t,o=Object(i.c)(w),l=Object(i.c)(da),u=Object(i.c)(D),d=Object(i.c)(ua),p=Object(c.useCallback)(()=>r(sa({propagate:a})),[r,a]),b=Object(c.useCallback)(()=>r(la({propagate:a})),[r,a]),f=Object(c.useCallback)(()=>r(ta({propagate:a})),[r,a]),y=Object(c.useCallback)(()=>r(aa({propagate:a})),[r,a]);return s.a.createElement("div",{className:m()("AudioPlayerControls",t)},s.a.createElement("div",{className:"Control"},s.a.createElement(k,{disabled:o||0===u||"shuffle"===d,icon:"step-backward",onClick:p,size:"M",title:n("player.backward")})),s.a.createElement("div",{className:"Control"},l?s.a.createElement(k,{disabled:o||0===u,icon:"pause",onClick:y,size:e?"L":"M",title:n("player.stop")}):s.a.createElement(k,{disabled:o||0===u,icon:"play",onClick:f,size:e?"L":"M",title:n("player.play")})),s.a.createElement("div",{className:"Control"},s.a.createElement(k,{disabled:o||0===u,icon:"step-forward",onClick:b,size:"M",title:n("player.forward")})))};a(275);const ba=()=>{const e=Object(c.useState)(0),t=Object(O.a)(e,2),a=t[0],r=t[1],n=Object(i.c)(da);return Object(c.useEffect)(()=>{let e=0;if(n){const t=()=>{r(Math.floor(1e3*tt.getPlayingTrackPercent())),e=requestAnimationFrame(t)};e=requestAnimationFrame(t)}return()=>{cancelAnimationFrame(e)}},[n]),s.a.createElement("div",{className:"Progress"},s.a.createElement("progress",{max:1e3,value:n?a:0}))};a(276);const fa=({propagate:e,onHelp:t})=>{const a=Object(i.b)(),r=Object(v.b)().t,n=Object(i.c)(e=>e.room.medias.length),o=Object(i.c)(w),l=Object(c.useCallback)(()=>{a(q(r("rooms.confirm_clear"),()=>{a(ra({propagate:e})),a(aa({propagate:e}))}))},[a,r,e]),u=Object(c.useCallback)(()=>{a(q(r("rooms.confirm_lock"),()=>{a(Dt())}))},[a,r]),d=Object(c.useCallback)(()=>{a(C({type:"Room/Unlock",props:{}}))},[a]),p=Object(c.useCallback)(()=>a(C({type:"Room/Search",props:null})),[a]);return s.a.createElement("div",{className:"QueueControls"},t?s.a.createElement("div",{className:"Control"},s.a.createElement(k,{icon:"question-circle",title:r("rooms.tutorial"),onClick:t})):null,s.a.createElement("div",{className:"Control"},o?s.a.createElement(k,{icon:"lock",onClick:d,size:"M",title:r("rooms.locked")}):s.a.createElement(k,{icon:"unlock",onClick:u,size:"M",title:r("rooms.unlocked")})),s.a.createElement("div",{className:"Control"},s.a.createElement(k,{onClick:p,icon:"search",title:r("medias.search")})),s.a.createElement("div",{className:"Control"},s.a.createElement(k,{disabled:o||0===n,onClick:l,icon:"trash",title:r("rooms.clear")})))};a(277);const va=({extended:e,propagate:t,onHelp:a})=>{const r=Object(v.b)().t;return s.a.createElement("div",{className:"RoomControls"},e?s.a.createElement("div",{className:"ControlsInner extended"},s.a.createElement(ma,{propagate:t,bigPlayer:!0}),s.a.createElement(ba,null),s.a.createElement(fa,{propagate:t,onHelp:a})):s.a.createElement("div",{className:"ControlsInner compact"},s.a.createElement("div",null,s.a.createElement(k,{icon:"question-circle",title:r("rooms.tutorial"),onClick:a})),s.a.createElement(ma,{className:"ControlsSet",propagate:t,bigPlayer:!1}),s.a.createElement("div",null,s.a.createElement(k,{icon:"diamond",title:r("..."),onClick:void 0}))))},ya=({boat:e,disabled:t=!1,onMoveBackward:a,onMoveForward:r,onRotateLeft:n,onRotateRight:o})=>{const c=Object(v.b)().t;return s.a.createElement("div",{className:"SeaBattlePlayerControls SeaBattleControls"},s.a.createElement(k,{disabled:t,icon:"rotate-left",title:c("games.seabattle.turn_left"),onClick:n}),s.a.createElement(k,{disabled:t,icon:e?ke[re(e.angle)].move_backward:"arrow-down",title:c("games.seabattle.move_backward"),onClick:a}),s.a.createElement(k,{disabled:t,icon:e?ke[re(e.angle)].move_forward:"arrow-up",title:c("games.seabattle.move_forward"),onClick:r}),s.a.createElement(k,{disabled:t,icon:"rotate-right",title:c("games.seabattle.turn_right"),onClick:o}))};var ga=a(30);const ha=({className:e,onClick:t,position:a,stopPropagation:r=!1,transform:n,type:o,visibility:c})=>s.a.createElement("use",Object.assign({onClick:e=>{r&&e.stopPropagation(),t&&t()},className:e,href:"#".concat(o),transform:n,visibility:c},a)),ka=e=>{let t=e.type,a=e.visibility,r=Object(ga.a)(e,["type","visibility"]);return s.a.createElement(ha,{className:"SeaBattleCell",type:t,visibility:a,position:{x:40*r.position.x,y:40*r.position.y}})},xa=e=>{let t=e.type,a=Object(ga.a)(e,["type"]);return s.a.createElement(ha,{className:"SeaBattleWeapon",type:t,position:{x:ue[t].x+40*a.position.x,y:ue[t].y+40*a.position.y}})},Ea=({weapons:e})=>s.a.createElement(s.a.Fragment,null,e.map((e,t)=>s.a.createElement(xa,Object.assign({key:t},e)))),_a=e=>{let t=e.type,a=Object(ga.a)(e,["type"]);return s.a.createElement(ha,{className:"SeaBattleHit",type:t,position:{x:le[t].x+40*a.position.x,y:le[t].y+40*a.position.y}})},wa=({hits:e})=>s.a.createElement(s.a.Fragment,null,e.map((e,t)=>s.a.createElement(_a,Object.assign({key:t},e)))),ja=e=>{let t=e.boat,a=t.angle,r=t.hits,n=t.type,o=t.status,c=void 0===o?"ok":o,l=Object(ga.a)(t,["angle","hits","type","status"]),i=e.hideFleet,u=e.onClick,d=e.selected;return s.a.createElement("g",{className:"SeaBattleBoatAnim",transform:"translate(".concat(ce[n].x+40*l.position.x,", ").concat(ce[n].y+40*l.position.y,") rotate(").concat(90*a,", 14, 14)")},i&&"ko"!==c?null:s.a.createElement(ha,{className:m()("SeaBattleBoat",c,{clickable:!!u,selected:d}),onClick:u,stopPropagation:!0,position:{x:0,y:0},type:n}),r.map((e,t)=>s.a.createElement(ha,{key:t,className:"SeaBattleHit",type:e.type,position:{x:se[e.type].x+40*e.position.x,y:se[e.type].y+40*e.position.y}})))},Oa=({fleet:e,hideFleet:t,selectedBoatIndex:a,onSelectBoatIndex:r})=>s.a.createElement(s.a.Fragment,null,e.map((e,n)=>s.a.createElement(ja,{key:n,boat:e,hideFleet:t,onClick:r&&"ok"===e.status?()=>{console.debug("[SeaBattle] Selected boat",{boat:e}),r(n===a?-1:n)}:void 0,selected:n===a}))),Sa=()=>s.a.createElement("defs",null,s.a.createElement("circle",{id:"hitted",cx:"10",cy:"10",r:"8",fill:"#e52524"}),s.a.createElement("circle",{id:"missed",cx:"10",cy:"10",r:"8",fill:"#fff"}),s.a.createElement("polygon",{id:"crossed",points:"11.98 8.08 20.07 0 24 3.9 15.92 11.98 24 20.07 20.07 24 11.98 15.92 3.9 24 0 20.07 8.08 11.98 0 3.9 3.9 0 11.98 8.08",fillRule:"evenodd"}),s.a.createElement("path",{id:"cell",d:"M0,0V40H40V0ZM36,36H4V4H36Z"}),s.a.createElement("use",{id:"cell-selected",href:"#cell",fill:"#FF0"}),s.a.createElement("use",{id:"cell-selection",href:"#cell",fill:"#555"}),s.a.createElement("g",{id:"cell-crossed"},s.a.createElement("use",{href:"#cell",fill:"#e52524"}),s.a.createElement("use",{href:"#crossed",fill:"#e52524",x:"8",y:"8"})),s.a.createElement("path",{id:"bullet1",d:"M16,4C16,8.46,0,8,0,8V0S16-.46,16,4Z",fill:"#afafaf"}),s.a.createElement("path",{id:"bullet2",d:"M16,4C16,8.46,0,8,0,8V0S16-.46,16,4Z",fill:"#676766"}),s.a.createElement("path",{id:"bullet3",d:"M16,4C16,8.46,0,8,0,8V0S16-.46,16,4Z",fill:"#000000"}),s.a.createElement("path",{id:"mine",d:"M16,9V7H13.77a5.92,5.92,0,0,0-1-2.41L14.35,3,13,1.65,11.39,3.23A5.92,5.92,0,0,0,9,2.23V0H7V2.23a5.92,5.92,0,0,0-2.41,1L3,1.65,1.65,3,3.23,4.61A5.92,5.92,0,0,0,2.23,7H0V9H2.23a5.92,5.92,0,0,0,1,2.41L1.65,13,3,14.35l1.58-1.58a5.92,5.92,0,0,0,2.41,1V16H9V13.77a5.92,5.92,0,0,0,2.41-1L13,14.35,14.35,13l-1.58-1.58a5.92,5.92,0,0,0,1-2.41Z",fill:"#000000"}),s.a.createElement("path",{id:"boat1",d:"M28,14C28,19,14,28,14,28H0V0H14S28,9.05,28,14Z"}),s.a.createElement("path",{id:"boat2",d:"M68,14C68,19,51.89,28,51.89,28H0V0H51.89S68,9.05,68,14Z"}),s.a.createElement("path",{id:"boat3",d:"M108,14C108,19,91.24,28,91.24,28H0V0H91.24S108,9.05,108,14Z"}),s.a.createElement("pattern",{id:"sea-grid",width:"80",height:"80",patternUnits:"userSpaceOnUse"},s.a.createElement("g",null,s.a.createElement("rect",{width:40,height:40,fill:"#a6dbf8",x:"0",y:"0"}),s.a.createElement("rect",{width:40,height:40,fill:"#50a3db",x:40,y:"0"}),s.a.createElement("rect",{width:40,height:40,fill:"#50a3db",x:"0",y:40}),s.a.createElement("rect",{width:40,height:40,fill:"#a6dbf8",x:40,y:40})))),Ca=(e,t)=>{const a=((e,{x:t,y:a})=>{var r=e.createSVGPoint();return r.x=t,r.y=a,{tx:(r=r.matrixTransform(e.getScreenCTM().inverse())).x,ty:r.y}})(e,t),r=a.tx,n=a.ty;return{x:Math.floor(r/40),y:Math.floor(n/40)}},Ia=({hideFleet:e,onCellClick:t,map:{fleet:a,hits:r,opponentsWeapons:n}={fleet:[],hits:[],opponentsWeapons:[],status:"ok",userId:"",weapons:{}},selectedBoatIndex:o,onSelectBoatIndex:l})=>{const i=Object(c.useRef)(null),u=Object(c.useState)({x:0,y:0}),d=Object(O.a)(u,2),p=d[0],m=d[1],b=Object(c.useState)("hidden"),f=Object(O.a)(b,2),v=f[0],y=f[1],g=Object(c.useState)({x:0,y:0}),h=Object(O.a)(g,2),k=h[0],x=h[1],E=Object(c.useState)("hidden"),_=Object(O.a)(E,2),w=_[0],j=_[1],S=Object(c.useCallback)(e=>{const a=Ca(i.current,e);p.x===a.x&&p.y===a.y?(m({x:0,y:0}),y("hidden")):(m(a),y("visible")),t&&t(a)},[t,p]),C=Object(c.useCallback)(()=>{j("hidden")},[]),I=Object(c.useCallback)(e=>{x(Ca(i.current,e)),j("visible")},[]);return s.a.createElement("svg",{className:"SeaBattleMap",viewBox:"0 0 400 400",ref:i,onClick:e=>S({x:e.clientX,y:e.clientY}),onMouseLeave:C,onMouseMove:e=>I({x:e.clientX,y:e.clientY})},s.a.createElement(Sa,null),s.a.createElement("rect",{width:"400",height:"400",fill:"url(#sea-grid)"}),s.a.createElement(ka,{type:"cell-selection",position:k,visibility:w}),s.a.createElement(ka,{type:"cell-selected",position:p,visibility:v}),s.a.createElement(Ea,{weapons:n}),s.a.createElement(Oa,{hideFleet:e,fleet:a,selectedBoatIndex:o,onSelectBoatIndex:l}),s.a.createElement(wa,{hits:r}))},Na=(e,t)=>e[t.y][t.x],Ma=(e,t,a)=>{e[t.y][t.x]=a},Ra=e=>e.x>=0&&e.x<10&&e.y>=0&&e.y<10,Aa=(e,t)=>{const a=Array(10).fill(null).map(e=>Array(10).fill(null));for(let r=0,n=e.length;r<n;++r){const n=e[r];if(t!==n)switch(re(n.angle)){case"N":for(let e=0;e<he[n.type];++e)Ma(a,{x:n.position.x,y:n.position.y-e},{boatIndex:r,boatLocalIndex:e,type:"boat"});break;case"E":for(let e=0;e<he[n.type];++e)Ma(a,{x:n.position.x+e,y:n.position.y},{boatIndex:r,boatLocalIndex:e,type:"boat"});break;case"S":for(let e=0;e<he[n.type];++e)Ma(a,{x:n.position.x,y:n.position.y+e},{boatIndex:r,boatLocalIndex:e,type:"boat"});break;case"W":for(let e=0;e<he[n.type];++e)Ma(a,{x:n.position.x-e,y:n.position.y},{boatIndex:r,boatLocalIndex:e,type:"boat"})}}return a},Pa=(e,t,a,r)=>((e,t,a)=>{if(!Ra(t))return!1;const r=he[e.type]-1;switch(a){case"N":return Ra({x:t.x,y:t.y-r});case"E":return Ra({x:t.x+r,y:t.y});case"S":return Ra({x:t.x,y:t.y+r});case"W":return Ra({x:t.x-r,y:t.y})}})(t,a,r)?!!((e,t,a,r)=>{const n=Aa(e,t),o=he[t.type];switch(r){case"N":for(let e=0;e<o;++e)if(null!==Na(n,{x:a.x,y:a.y-e}))return!1;break;case"E":for(let e=0;e<o;++e)if(null!==Na(n,{x:a.x+e,y:a.y}))return!1;break;case"S":for(let e=0;e<o;++e)if(null!==Na(n,{x:a.x,y:a.y+e}))return!1;break;case"W":for(let e=0;e<o;++e)if(null!==Na(n,{x:a.x-e,y:a.y}))return!1}return!0})(e,t,a,r)||(console.debug("[SeaBattle] Boat blocked by collision"),!1):(console.debug("[SeaBattle] Boat blocked by zone"),!1),Ta=()=>(e,t)=>e(R({onAction:function(){var a=Object(o.a)(n.a.mark((function a(){var r,o,c,s,l,i;return n.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=t(),o=r.room,c=o._fbRoom,s=o.extra,l=r.user.access.userId){a.next=4;break}return e(F("user.not_connected")),a.abrupt("return","connect-and-retry");case 4:if(c&&!c.isLocked()&&s){a.next=7;break}return e(F("rooms.errors.locked")),a.abrupt("return","unlock-and-retry");case 7:if(console.debug("[SeaBattle] Joining battle...",{userId:l}),i=be(s),!i.maps.find(e=>e.userId===l)){a.next=12;break}return a.abrupt("return",!0);case 12:if(!(Object.keys(i.maps).length>=3)){a.next=15;break}return e(F("games.max_players_count")),a.abrupt("return",!0);case 15:return Se(i,l),a.next=18,c.updateExtra(fe(i));case 18:return a.abrupt("return",!0);case 19:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}(),onFailure:()=>e(Dt())})),La=({boatIndex:e,movement:t})=>(a,r)=>a(R({onAction:function(){var c=Object(o.a)(n.a.mark((function o(){var c,s,l,i,u,d,p,m,b,f,v,y,g,h,k,x,E;return n.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(c=r(),s=c.room,l=s._fbRoom,i=s.extra,u=c.user.access.userId,l&&!l.isLocked()&&i){n.next=4;break}return a(F("rooms.errors.locked")),n.abrupt("return","unlock-and-retry");case 4:if(u){n.next=7;break}return a(F("user.not_connected")),n.abrupt("return","connect-and-retry");case 7:if(d=be(i),p=d.maps.find(e=>e.userId===u)){n.next=12;break}return console.debug("[SeaBattle] Cannot find map for current user"),n.abrupt("return",!0);case 12:if(pe(d,u)){n.next=15;break}return a(F("games.seabattle.not_your_turn")),n.abrupt("return",!0);case 15:if(m=p.fleet,!(e<0||e>=m.length)){n.next=19;break}return console.debug("[SeaBattle] No boat selected"),n.abrupt("return",!0);case 19:if(b=m[e],f=b.angle,v=b.position,y=b.type,g=re(f),h=Object(j.a)({},v),"move_forward"!==t&&"move_backward"!==t||(h.x+=ge[g][t].x,h.y+=ge[g][t].y),k=f,x=g,"rotate_left"!==t&&"rotate_right"!==t||("rotate_left"===t&&k--,"rotate_right"===t&&k++,x=re(k),h.x+=ve[y][g].x,h.y+=ve[y][g].y),!(E=m[e]).hits.find(e=>"hitted"===e.type)){n.next=30;break}return console.debug("[SeaBattle] Hitted boat cannot move...",{boatIndex:e}),n.abrupt("return",!0);case 30:if(Pa(m,E,h,x)){n.next=33;break}return console.debug("[SeaBattle] Movement is not possible...",{boatIndex:e,movement:t,oldDirection:g,newDirection:x,oldPosition:v,newPosition:h}),n.abrupt("return",!0);case 33:return console.debug("[SeaBattle] Moving boat...",{boatIndex:e,movement:t,oldDirection:g,oldPosition:v,newDirection:x,newPosition:h}),E.angle=k,E.position=h,me(d),n.next=39,l.updateExtra(fe(d));case 39:return n.abrupt("return",!0);case 40:case"end":return n.stop()}}),o)})));return function(){return c.apply(this,arguments)}}(),onFailure:()=>a(Dt())})),za=({opponentIndex:e,position:t,weaponType:a})=>(r,c)=>r(R({onAction:function(){var s=Object(o.a)(n.a.mark((function o(){var s,l,i,u,d,p,m,b,f,v,y,g;return n.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s=c(),l=s.room,i=l._fbRoom,u=l.extra,d=s.user.access.userId,i&&!i.isLocked()&&u){n.next=4;break}return r(F("rooms.errors.locked")),n.abrupt("return","unlock-and-retry");case 4:if(d){n.next=7;break}return r(F("user.not_connected")),n.abrupt("return","connect-and-retry");case 7:if(p=be(u),m=p.maps.find(e=>e.userId===d)){n.next=12;break}return console.debug("[SeaBattle] Cannot find map for current user"),n.abrupt("return",!0);case 12:if(pe(p,d)){n.next=15;break}return r(F("games.seabattle.not_your_turn")),n.abrupt("return",!0);case 15:if(!(m.weapons[a]<=0)){n.next=18;break}return r(F("games.seabattle.weapon_not_available")),n.abrupt("return",!0);case 18:if(b=de(p.maps,d),!(e<0||e>=b.length)){n.next=22;break}return console.debug("[SeaBattle] Cannot find opponent map"),n.abrupt("return",!0);case 22:if((f=b[e]).userId!==d){n.next=26;break}return console.debug("[SeaBattle] Invalid opponent map"),n.abrupt("return",!0);case 26:if("ko"!==f.status){n.next=29;break}return r(F("games.seabattle.opponent_already_killed")),n.abrupt("return",!0);case 29:if(console.debug("[SeaBattle] Attacking opponent...",{opponentIndex:e,position:t,weaponType:a}),v=Aa(f.fleet),null!==(y=Na(v,t))){n.next=37;break}r(F("games.seabattle.missed_opponent")),f.hits.push({position:t,type:"missed"}),n.next=51;break;case 37:if("boat"!==y.type){n.next=50;break}if("ko"!==(g=f.fleet[y.boatIndex]).status){n.next=42;break}return r(F("games.seabattle.ship_already_killed")),n.abrupt("return",!0);case 42:if(!g.hits.find(e=>e.position.x===y.boatLocalIndex)){n.next=46;break}return r(F("games.seabattle.ship_already_hitted")),n.abrupt("return",!0);case 46:g.hits.push({position:{x:y.boatLocalIndex,y:0},type:"hitted"}),g.hits.length===he[g.type]?(r(U("games.seabattle.killed_opponent_boat")),g.status="ko",f.fleet.find(e=>"ok"===e.status)||(r(U("games.seabattle.killed_opponent")),f.status="ko")):r(U("games.seabattle.hitted_opponent")),n.next=51;break;case 50:r(U("games.seabattle.hitted_weapon"));case 51:return m.weapons[a]--,me(p),n.next=55,i.updateExtra(fe(p));case 55:return n.abrupt("return",!0);case 56:case"end":return n.stop()}}),o)})));return function(){return s.apply(this,arguments)}}(),onFailure:()=>r(Dt())})),Fa=({opponentsCount:e,opponentIndex:t,onSelectPreviousOpponent:a,onSelectNextOpponent:r})=>{const n=Object(v.b)().t;return e>0?s.a.createElement("div",{className:"SeaBattleOpponentSelection"},s.a.createElement(k,{disabled:e<=1,icon:"caret-left",title:"Previous enemy",onClick:a}),s.a.createElement("span",{className:"SeaBattleOpponentSelectionLabel"},n("games.seabattle.opponent_index",{index:"".concat(t+1," / ").concat(e)})),s.a.createElement(k,{disabled:e<=1,icon:"caret-right",title:"Next enemy",onClick:r})):s.a.createElement("div",{className:"SeaBattleOpponentSelection"},s.a.createElement("span",{className:"SeaBattleOpponentSelectionLabel"},n("games.no_opponents")))},Ba=({onSelect:e,weapons:t,weaponType:a})=>{const r=Object(c.useRef)(null),n=Object(c.useState)(ie.indexOf(a)),o=Object(O.a)(n,2),l=o[0],i=o[1],u=Object(c.useState)(l>=0?"visible":"hidden"),d=Object(O.a)(u,2),p=d[0],m=d[1],b=Object(c.useState)(-1),f=Object(O.a)(b,2),v=f[0],y=f[1],g=Object(c.useState)("hidden"),h=Object(O.a)(g,2),k=h[0],x=h[1],E=Object(c.useCallback)(t=>{const a=Ca(r.current,t).x;l!==a&&e&&(i(a),m("visible"),e(ie[a]))},[e,l]),_=Object(c.useCallback)(()=>{x("hidden")},[]),w=Object(c.useCallback)(t=>{e&&(y(Ca(r.current,t).x),x("visible"))},[e]);return s.a.createElement("svg",{className:"SeaBattleWeaponSelection",viewBox:"0 0 160 40",ref:r,onClick:e=>E({x:e.clientX,y:e.clientY}),onMouseLeave:_,onMouseMove:e=>w({x:e.clientX,y:e.clientY})},s.a.createElement(Sa,null),s.a.createElement("rect",{width:"400",height:"400",fill:"url(#sea-grid)"}),s.a.createElement(ka,{type:"cell-selection",position:{x:v,y:0},visibility:k}),s.a.createElement(ka,{type:"cell-selected",position:{x:l,y:0},visibility:p}),s.a.createElement(Ea,{weapons:ie.map((e,t)=>({opponentId:"",position:{x:t,y:0},type:e}))}),ie.map((e,a)=>s.a.createElement(ka,{key:a,type:"cell-crossed",position:{x:a,y:0},visibility:t[e]?"hidden":"visible"})))},Ua=({opponentsCount:e,opponentIndex:t,onSelectPreviousOpponent:a,onSelectNextOpponent:r,onSelectWeaponType:n,weapons:o,weaponType:c})=>s.a.createElement("div",{className:"SeaBattleOpponentControls SeaBattleControls"},s.a.createElement(Fa,{opponentsCount:e,opponentIndex:t,onSelectPreviousOpponent:a,onSelectNextOpponent:r}),s.a.createElement(Ba,{onSelect:n,weapons:o,weaponType:c}));a(278);const qa=()=>{const e=Object(i.b)(),t=Object(v.b)().t,a=Object(c.useState)(-1),r=Object(O.a)(a,2),n=r[0],o=r[1],l=Object(c.useState)(-1),u=Object(O.a)(l,2),d=u[0],p=u[1],m=Object(c.useState)(0),b=Object(O.a)(m,2),f=b[0],y=b[1],g=Object(c.useState)("bullet1"),h=Object(O.a)(g,2),x=h[0],E=h[1],_=Object(i.c)(e=>e.user.access.userId),w=(({extra:e,userId:t,boatIndex:a})=>{let r=void 0,n=-1,o=void 0,c=void 0,s=-1;if(e){const l=be(e);t&&(n=l.currentMapIndex,s=l.maps.findIndex(e=>e.userId===t),s>=0&&(c=l.maps[s],a>=0&&a<c.fleet.length&&(r=c.fleet[a]))),o=de(l.maps,t)}return{boat:r,currentMapIndex:n,opponentMaps:o,playerMap:c,playerMapIndex:s}})({extra:Object(i.c)(e=>e.room.extra||""),userId:_,boatIndex:d}),j=w.boat,S=w.currentMapIndex,I=w.opponentMaps,N=w.playerMap,M=w.playerMapIndex,R=Object(c.useCallback)(()=>{e(Ta())},[e]),A=Object(c.useCallback)(t=>{e(La({boatIndex:d,movement:t}))},[e,d]),T=Object(c.useCallback)(e=>{e.repeat||38!==e.keyCode&&40!==e.keyCode&&37!==e.keyCode&&39!==e.keyCode||(e.preventDefault(),j&&A(ye[re(j.angle)][e.keyCode]))},[A,j]),L=Object(c.useCallback)(()=>e(C({type:"User/Create",props:{}})),[e]),z=Object(c.useCallback)(t=>{I&&0!==I.length?e(x?za({opponentIndex:f,position:t,weaponType:x}):B("games.seabattle.no_weapon_selected")):e(B("games.no_opponents_to_attack"))},[e,f,I,x]);return Object(c.useEffect)(()=>(document.addEventListener("keydown",T),()=>{document.removeEventListener("keydown",T)}),[T]),Object(c.useEffect)(()=>{n!==S&&(e(P("seabattle/player_turn")),S===M?"ko"===(null===N||void 0===N?void 0:N.status)?e(B("games.seabattle.you_have_been_killed")):I&&I.length>0&&e(B("games.seabattle.player_turn",{autoclear:!1,closable:!1,tag:"seabattle/player_turn",weight:1e6})):e(B("games.seabattle.opponent_turn",{autoclear:!1,closable:!1,tag:"seabattle/player_turn",weight:1e6})),o(S))},[S,e,I,N,M,n]),s.a.createElement("div",{className:"SeaBattle"},s.a.createElement("div",{className:"SeaBattlePlayer current"},s.a.createElement(ya,{boat:j,disabled:!j,onMoveForward:()=>A("move_forward"),onMoveBackward:()=>A("move_backward"),onRotateLeft:()=>A("rotate_left"),onRotateRight:()=>A("rotate_right")}),N?s.a.createElement(Ia,{map:N,hideFleet:!1,selectedBoatIndex:d,onSelectBoatIndex:p}):s.a.createElement("div",{className:"SeaBattleJoin"},I&&I.length>=3?s.a.createElement("span",null,t("games.max_players_count")):_?s.a.createElement(s.a.Fragment,null,s.a.createElement("span",null,t("games.watch_or_join")),s.a.createElement(k,{icon:"sign-in",title:t("games.seabattle.join_battle"),size:"L",displayTitle:!0,onClick:R})):s.a.createElement(s.a.Fragment,null,s.a.createElement("span",null,t("games.connect_to_join")),s.a.createElement(k,{icon:"sign-in",title:t("user.connect"),size:"L",displayTitle:!0,onClick:L})))),s.a.createElement("div",{className:"SeaBattlePlayer other"},s.a.createElement(Ua,{opponentsCount:(null===I||void 0===I?void 0:I.length)||0,opponentIndex:f,onSelectPreviousOpponent:I&&I.length>0?()=>y(0===f?I.length-1:f-1):void 0,onSelectNextOpponent:I&&I.length>0?()=>y((f+1)%(null===I||void 0===I?void 0:I.length)):void 0,onSelectWeaponType:E,weapons:(null===N||void 0===N?void 0:N.weapons)||{},weaponType:x}),s.a.createElement(Ia,{map:I&&I.length>0?I[f]:void 0,hideFleet:!0,onCellClick:z})))};var Wa=a(46);const Ha=e=>Object.values(e.messages).sort((e,t)=>e.weight!==t.weight?e.weight-t.weight:e.stamp-t.stamp);a(279);const Da=({className:e,bottomPosition:t})=>{const a=Object(v.b)().t,r=Object(i.b)(),n=Object(i.c)(Ha);return s.a.createElement("div",{className:m()("Messages",e),style:{bottom:t}},s.a.createElement(Wa.TransitionGroup,null,n.map(({closable:e,extra:t,id:n,text:o,type:c})=>s.a.createElement(Wa.CSSTransition,{key:n,classNames:"Message",timeout:{enter:200,exit:200}},s.a.createElement("div",{className:m()("Message","Message-"+c)},s.a.createElement("div",{className:"MessageBody"},o?a(o):null,t?t():null),e?s.a.createElement("div",{className:"MessageActions"},s.a.createElement(k,{icon:"close",title:a("clear"),onClick:()=>r(A(n))})):null)))))};a(287);const Va=()=>{const e=Object(i.b)(),t=Object(i.c)(e=>e.room.color),a=t.fg,r=t.bg,n=Object(i.c)(e=>e.room.info),o=Object(d.h)().search,l=Object(d.i)(),u=l.dbId,p=l.roomId,b=f.a.parse(o.substr(1)).secret,v=void 0===b?"":b;return Object(c.useEffect)(()=>(e(Wt({dbId:u,roomId:p,secret:v})),()=>{e(Ht())}),[e,u,p,v]),Object(c.useEffect)(()=>{document.body.className=a,document.body.style.backgroundColor="rgb(".concat(r.r,", ").concat(r.g,", ").concat(r.b,")")},[r,a]),s.a.createElement("div",{className:m()("Room")},s.a.createElement(V,null),(()=>{if(!n)return null;switch(n.type){case"blind":return null;case"dj":return s.a.createElement(s.a.Fragment,null,s.a.createElement(pa,null),s.a.createElement(va,{extended:!0,propagate:!0}),s.a.createElement(Da,{className:"QueueMessages",bottomPosition:"120px"}));case"seabattle":return s.a.createElement(s.a.Fragment,null,s.a.createElement(qa,null),s.a.createElement(va,{extended:!1,propagate:!1,onHelp:()=>{e(C({type:"SeaBattle/Help",props:null}))}}),s.a.createElement(Da,{className:"SeaBattleMessages",bottomPosition:"50px"}))}})())},Qa=({dbId:e,userId:t,secret:a})=>{const r=Fe(e).users.child(t),c=r.child("info");let s=a||"",l={name:"dummy",online:!1};const i=function(){var e=Object(o.a)(n.a.mark((function e(){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.debug("[Firebase] Waiting user..."),e.next=4,c.once("value");case 4:return t=e.sent,l=t.val(),u({}),e.abrupt("return",l);case 10:throw e.prev=10,e.t0=e.catch(0),new Error("user.errors.invalid");case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),u=function(){var e=Object(o.a)(n.a.mark((function e({name:t}){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.debug("[Firebase] Initializing user...",{name:t}),void 0!==t&&(l.name=t),e.next=4,r.update({info:Object(j.a)({},l,{online:!0}),secret:s,timestamp:Re.database.ServerValue.TIMESTAMP});case 4:d();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=()=>{console.debug("[Firebase] Installing user disconnect..."),r.onDisconnect().cancel(),r.onDisconnect().update({info:Object(j.a)({},l,{online:!1}),secret:s,timestamp:Re.database.ServerValue.TIMESTAMP})};return{dbId:e,userId:t,isLocked:()=>!s,setSecret:e=>{console.debug("[Firebase] Setting user secret...",{oldSecret:s,newSecret:e}),s=e},wait:i,subscribeInfo:e=>(console.debug("[Firebase] Subscribing user..."),c.on("value",t=>{const a=t.val();a&&e(a)})),unsubscribeInfo:e=>{console.debug("[Firebase] Unsubscribing user..."),c.off("value",e)},update:u}},Ga=()=>{const e={dbId:"",userId:"",secret:""},t=localStorage.getItem("U");if(t)try{const a=Object($.a)(t);"string"===typeof a.dbId&&"string"===typeof a.userId&&"string"===typeof a.secret&&(e.dbId=a.dbId,e.userId=a.userId,e.secret=a.secret,console.debug("Loaded user access: ",e))}catch(a){console.debug("User cannot be loaded: ",a),Xa()}return e},Xa=()=>{localStorage.removeItem("U")},Ja=e=>M("user/SET",e),Ya={_fbUser:null,access:{dbId:"",userId:"",secret:""},error:null,fetching:!1,info:null},Za=({dbId:e,name:t,secret:a,options:r})=>c=>c(R({onAction:function(){var s=Object(o.a)(n.a.mark((function o(){var s;return n.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.debug("[User] Creating..."),s=Object(K.a)(),n.next=4,Qa({dbId:e,userId:s,secret:a}).update({name:t});case 4:return c($a({dbId:e,userId:s,secret:a,options:r})),n.abrupt("return",!0);case 6:case"end":return n.stop()}}),o)})));return function(){return s.apply(this,arguments)}}(),onFailure:()=>{(null===r||void 0===r?void 0:r.onFailure)&&r.onFailure()}}));let Ka=null;const $a=({dbId:e,userId:t,secret:a,options:r})=>(c,s)=>c(R(Object(j.a)({onAction:function(){var r=Object(o.a)(n.a.mark((function r(){var o,l,i;return n.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=s(),!(l=o.user._fbUser)||l.dbId!==e||l.userId!==t){r.next=3;break}return r.abrupt("return",!0);case 3:return c(er()),c(M("user/FETCHING")),console.debug("[User] Connecting...",{dbId:e,userId:t,secret:a}),i=Qa({dbId:e,userId:t,secret:a}),r.t0=c,r.t1=Ja,r.t2=i,r.t3={dbId:e,userId:t,secret:a},r.next=13,i.wait();case 13:return r.t4=r.sent,r.t5={_fbUser:r.t2,access:r.t3,info:r.t4},r.t6=(0,r.t1)(r.t5),(0,r.t0)(r.t6),Ka=i.subscribeInfo(e=>{console.debug("[User] Received user update...",e),c(Ja({info:e}))}),r.abrupt("return",!0);case 19:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),onFailure:()=>{c(M("user/ERROR","Cannot connect")),c(er()),(null===r||void 0===r?void 0:r.onFailure)&&r.onFailure()}},r))),er=()=>(e,t)=>e(R({onAction:function(){var a=Object(o.a)(n.a.mark((function a(){var r,o,c,s,l,i,u;return n.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=t(),o=r.user,c=o._fbUser,s=o.access,l=s.dbId,i=s.userId,u=s.secret,l||i||u||c){a.next=3;break}return a.abrupt("return",!0);case 3:return console.debug("[User] Disconnecting...",{dbId:l,userId:i,secret:u}),c&&(c.unsubscribeInfo(Ka),Ka=null),e(M("user/RESET")),a.abrupt("return",!0);case 7:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}()})),tr=()=>(e,t)=>e(R({onAction:function(){var a=Object(o.a)(n.a.mark((function a(){var r,o,c,s,l;return n.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=t(),o=r.user.access,c=o.dbId,s=o.userId,l=o.secret,c&&s&&l){a.next=3;break}return a.abrupt("return",!0);case 3:return console.debug("[User] Reconnecting...",{dbId:c,userId:s,secret:l}),e($a({dbId:c,userId:s,secret:l})),a.abrupt("return",!0);case 6:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}()}));a(288);const ar=()=>{const e=Object(i.b)(),t=Object(i.c)(e=>e.user.fetching),a=Object(i.c)(e=>!!e.user.access.dbId&&!!e.user.access.userId),r=Object(v.b)().t,n=Object(c.useCallback)(()=>e(C({type:"Room/Create",props:null})),[e]),o=Object(c.useCallback)(()=>e(C({type:"User/Create",props:{}})),[e]),l=Object(c.useCallback)(()=>e(C({type:"User/Connect",props:{}})),[e]),d=Object(c.useCallback)(()=>e(er()),[e]),p=Object(c.useCallback)(()=>e(C({type:"General/Help",props:null})),[e]);return Object(c.useEffect)(()=>{e(P())},[e]),s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"Splash"},s.a.createElement("div",{className:"Top"},s.a.createElement(u.b,{className:"Logo",to:"/"},s.a.createElement("img",{src:"/images/logo.png",title:"Party",alt:"Party Logo"}),"Party"),s.a.createElement("div",{className:"Description"},r("splash.description"))),s.a.createElement("div",{className:"Middle"},s.a.createElement("div",{className:"Menu"},t?s.a.createElement("div",{className:"MenuItem"},s.a.createElement(h,{className:"rotating",icon:"refresh",size:"XL",title:r("loading")})):a?s.a.createElement("div",{className:"MenuItem"},s.a.createElement(k,{onClick:n,icon:"play",size:"XL",title:r("rooms.create")})):s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"MenuItem"},s.a.createElement(k,{onClick:o,icon:"user-plus",size:"XL",title:r("user.create")})),s.a.createElement("div",{className:"MenuItem"},s.a.createElement(k,{onClick:l,icon:"sign-in",size:"XL",title:r("user.connect")}))))),s.a.createElement("div",{className:"Bottom"},s.a.createElement("div",{className:"Menu"},t?null:a?s.a.createElement("div",{className:"MenuItem"},s.a.createElement(k,{icon:"sign-out",onClick:d,size:"M",title:r("user.disconnect")})):s.a.createElement("div",{className:"MenuItem"},s.a.createElement(k,{icon:"question-circle",onClick:p,size:"L",title:r("help.help")}))))),s.a.createElement(Da,null))},rr=({children:e,className:t,title:a,renderFoot:r,onSubmit:n})=>{const o=Object(i.b)(),l=Object(v.b)().t,u=Object(i.c)(e=>e.modals.stack.length>1),d=Object(c.useCallback)(()=>o(M("modals/CLOSE")),[o]),p=Object(c.useCallback)(()=>o(I()),[o]);return s.a.createElement("form",{className:m()("Modal",t),onSubmit:e=>{e.preventDefault(),n&&n()}},s.a.createElement("div",{className:"ModalHead"},s.a.createElement(k,{kind:"special",className:m()("ModalHeadBack",{hidden:!u}),icon:"angle-left",title:"Back",onClick:p}),s.a.createElement("div",{className:"ModalTitle"},a),s.a.createElement(k,{kind:"special",className:"ModalHeadClose",onClick:d,title:l("cancel"),icon:"times"})),s.a.createElement("div",{className:"ModalBody"},e),s.a.createElement("div",{className:"ModalFoot"},r&&r()))};a(289);const nr=({children:e,className:t,renderButtons:a,title:r,onSubmit:n})=>s.a.createElement(rr,{className:m()("FormModal",t),title:r,renderFoot:a,onSubmit:n},e),or=({onClick:e})=>{const t=Object(v.b)().t;return s.a.createElement(k,{onClick:e,title:t("cancel"),kind:"default",icon:"ban"})},cr=({question:e,onCanceled:t,onConfirmed:a})=>{const r=Object(i.b)(),n=Object(v.b)().t,o=Object(c.useCallback)(()=>{r(I()),t&&t()},[r,t]);return s.a.createElement(nr,{title:n("confirm"),onSubmit:a,renderButtons:()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(k,{title:n("confirm"),kind:"primary",icon:"plus",type:"submit"}),s.a.createElement(or,{onClick:o}))},e)},sr=({children:e})=>s.a.createElement("div",{className:"ModalField"},e),lr=Object(c.forwardRef)((e,t)=>s.a.createElement(sr,null,s.a.createElement("div",{className:"XXX"},s.a.createElement("label",{htmlFor:e.id},e.label),s.a.createElement("input",Object.assign({ref:t},e))))),ir=({id:e,label:t,onChange:a,placeholder:r,value:l})=>{const u=Object(i.b)(),d=Object(v.b)().t,p=Object(c.useCallback)(Object(o.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x(l);case 2:u(U("secret_copied_to_clipboard"));case 3:case"end":return e.stop()}}),e)}))),[u,l]);return s.a.createElement(sr,null,s.a.createElement("div",{className:"XXX"},s.a.createElement("label",{htmlFor:e},t),s.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},s.a.createElement("input",{style:{flexGrow:1,marginRight:"0.5rem"},id:e,type:"password",autoComplete:"password",placeholder:r,maxLength:36,minLength:36,required:!0,value:l,onChange:e=>a(e.target.value)}),s.a.createElement(k,{icon:"clipboard",onClick:p,size:"M",title:d("copy_to_clipboard")}))))},ur=Object(c.forwardRef)((e,t)=>s.a.createElement(sr,null,s.a.createElement("div",{className:"XXX"},s.a.createElement("label",{htmlFor:e.id},e.label),s.a.createElement("select",Object.assign({ref:t},e),e.options.sort((e,t)=>e.label.localeCompare(t.label)).map(e=>s.a.createElement("option",{key:e.id,value:e.id},e.label)))))),dr=({options:e})=>{const t=Object(i.b)(),a=Object(c.useState)(""),r=Object(O.a)(a,2),n=r[0],o=r[1],l=Object(c.useState)(""),u=Object(O.a)(l,2),d=u[0],p=u[1],m=Object(c.useRef)(null),b=Object(v.b)().t;Object(c.useEffect)(()=>{m.current&&m.current.focus()},[m]);const f=Object(c.useCallback)(()=>t(I()),[t]),y=Object(c.useCallback)(()=>{0!==n.trim().length?0!==d.trim().length?t($a({dbId:Te(),userId:n,secret:d,options:{onSuccess:()=>{e&&e.onSuccess&&e.onSuccess(),t(I())}}})):t(F("user.secret_is_invalid")):t(F("user.id_is_invalid"))},[t,n,d,e]);return s.a.createElement(nr,{title:b("user.connection"),onSubmit:y,renderButtons:()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(k,{disabled:0===n.trim().length||36!==n.length||36!==d.length,title:b("user.connect"),kind:"primary",icon:"check",type:"submit"}),s.a.createElement(or,{onClick:f}))},s.a.createElement(lr,{id:"modal-userId",label:b("user.id"),type:"text",placeholder:b("user.id_placeholder"),maxLength:36,minLength:36,required:!0,value:n,ref:m,onChange:e=>o(e.target.value)}),s.a.createElement(lr,{id:"modal-secret",label:b("user.secret"),type:"password",autoComplete:"password",placeholder:b("user.secret_placeholder"),maxLength:36,minLength:36,required:!0,value:d,onChange:e=>p(e.target.value)}))};let pr=1;const mr=()=>{const e=Object(i.b)(),t=Object(c.useState)(""),a=Object(O.a)(t,2),r=a[0],n=a[1],o=Object(c.useState)(Object(K.a)()),l=Object(O.a)(o,2),u=l[0],d=l[1],p=Object(c.useState)("seabattle"),m=Object(O.a)(p,2),b=m[0],f=m[1],y=Object(c.useRef)(null),g=Object(v.b)().t;Object(c.useEffect)(()=>{n("".concat(g("rooms.room")," ").concat(pr)),y.current&&y.current.focus()},[g,y]);const h=Object(c.useCallback)(()=>e(I()),[e]),x=Object(c.useCallback)(()=>{0!==r.trim().length?0!==u.trim().length?(e(qt({dbId:Pe(),name:r,secret:u,type:b,options:{onSuccess:()=>{e(I())}}})),pr++):e(F("rooms.secret_is_invalid")):e(F("rooms.name_is_invalid"))},[e,r,u,b]);return s.a.createElement(nr,{title:g("rooms.room_creation"),onSubmit:x,renderButtons:()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(k,{disabled:0===r.trim().length||36!==u.length,title:g("rooms.create"),kind:"primary",icon:"check",type:"submit"}),s.a.createElement(or,{onClick:h}))},s.a.createElement(lr,{id:"modal-name",label:g("rooms.name"),type:"text",placeholder:g("rooms.name_placeholder"),maxLength:100,minLength:2,required:!0,value:r,ref:y,onChange:e=>n(e.target.value)}),s.a.createElement(ir,{id:"modal-secret",label:g("rooms.key"),placeholder:g("rooms.key_placeholder"),value:u,onChange:d}),s.a.createElement(ur,{id:"modal-type",label:g("rooms.type"),placeholder:g("rooms.type_placeholder"),options:Ce.map(e=>({id:e,label:g("rooms.types.".concat(e))})),value:b,onChange:e=>f(e.target.value)}))};let br=1;const fr=({options:e})=>{const t=Object(i.b)(),a=Object(c.useState)(""),r=Object(O.a)(a,2),n=r[0],o=r[1],l=Object(c.useState)(Object(K.a)()),u=Object(O.a)(l,2),d=u[0],p=u[1],m=Object(c.useRef)(null),b=Object(v.b)().t;Object(c.useEffect)(()=>{o("".concat(b("user.user")," ").concat(br)),m.current&&m.current.focus()},[b,m]);const f=Object(c.useCallback)(()=>t(I()),[t]),y=Object(c.useCallback)(()=>{0!==n.trim().length?0!==d.trim().length?(t(Za({dbId:Te(),name:n,secret:d,options:{onSuccess:()=>{e&&e.onSuccess&&e.onSuccess(),t(I())}}})),br++):t(F("user.secret_is_invalid")):t(F("user.name_is_invalid"))},[t,n,d,e]);return s.a.createElement(nr,{title:b("user.user_creation"),onSubmit:y,renderButtons:()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(k,{disabled:0===n.trim().length||36!==d.length,title:b("user.create"),kind:"primary",icon:"check",type:"submit"}),s.a.createElement(or,{onClick:f}))},s.a.createElement(lr,{id:"modal-name",label:b("user.name"),type:"text",placeholder:b("user.name_placeholder"),maxLength:100,minLength:2,required:!0,value:n,ref:m,onChange:e=>o(e.target.value)}),s.a.createElement(ir,{id:"modal-secret",label:b("user.secret"),placeholder:b("user.secret_placeholder"),value:d,onChange:e=>p(e)}))};a(290);const vr=()=>{const e=Object(v.b)().t,t=Object(i.b)(),a=Object(c.useCallback)(()=>t(C({type:"Room/Create",props:null})),[t]),r=Object(c.useCallback)(()=>t(C({type:"Room/Join",props:null})),[t]),n=Object(c.useCallback)(()=>t(C({type:"User/Create",props:{}})),[t]),o=Object(c.useCallback)(()=>t(C({type:"User/Connect",props:{}})),[t]);return s.a.createElement(rr,{className:"HelpModal",title:e("help.help")},s.a.createElement("div",{className:"HelpModalSection"},s.a.createElement("div",{className:"HelpModalSectionTitle"},e("help.rules")),s.a.createElement("ul",null,s.a.createElement("li",null,e("help.rule1"),"\xa0",s.a.createElement(k,{icon:"user-plus",size:"S",title:e("user.create"),onClick:n})),s.a.createElement("li",null,e("help.rule1b"),"\xa0",s.a.createElement(k,{icon:"sign-in",size:"S",title:e("user.connect"),onClick:o})),s.a.createElement("li",null,e("help.rule2"),"\xa0",s.a.createElement(k,{icon:"play",size:"S",title:e("rooms.create"),onClick:a})),s.a.createElement("li",null,e("help.rule2b"),"\xa0",s.a.createElement(k,{icon:"sign-in",size:"S",title:e("rooms.join"),onClick:r})))),s.a.createElement("div",{className:"HelpModalSection"},s.a.createElement("div",{className:"HelpModalSectionTitle"},e("help.notes")),s.a.createElement("ul",null,s.a.createElement("li",null,e("help.note1")),s.a.createElement("li",null,e("help.note2")))))},yr=()=>{const e=Object(v.b)().t;return s.a.createElement(rr,{className:"SeaBattleGameOverModal",title:e("games.gameover")},"GameOver...")};a(291);const gr=()=>{const e=Object(v.b)().t;return s.a.createElement(rr,{className:"SeaBattleHelpModal",title:e("help.help")},s.a.createElement("div",{className:"HelpModalSection"},s.a.createElement("div",{className:"HelpModalSectionTitle"},e("games.seabattle.help.you_can")),s.a.createElement("ul",null,s.a.createElement("li",null,e("games.seabattle.help.move_boat")),s.a.createElement("li",null,e("games.seabattle.help.attack_opponent")))),s.a.createElement("div",{className:"HelpModalSection"},s.a.createElement("div",{className:"HelpModalSectionTitle"},e("games.seabattle.help.to_move")),s.a.createElement("ul",null,s.a.createElement("li",null,e("games.seabattle.help.select_boat")),s.a.createElement("li",null,e("games.seabattle.help.move_with_keyboard")),s.a.createElement("li",null,e("games.seabattle.help.or_use_the_buttons"),s.a.createElement("br",null),s.a.createElement(h,{icon:"rotate-left",size:"S",title:e("games.seabattle.turn_left")}),"\xa0",e("games.seabattle.turn_left"),s.a.createElement("br",null),s.a.createElement(h,{icon:"rotate-right",size:"S",title:e("games.seabattle.turn_right")}),"\xa0",e("games.seabattle.turn_right"),s.a.createElement("br",null),s.a.createElement(h,{icon:"arrow-down",size:"S",title:e("games.seabattle.move_down")}),"\xa0",e("games.seabattle.move_down"),s.a.createElement("br",null),s.a.createElement(h,{icon:"arrow-up",size:"S",title:e("games.seabattle.move_up")}),"\xa0",e("games.seabattle.move_up"),s.a.createElement("br",null),s.a.createElement(h,{icon:"arrow-left",size:"S",title:e("games.seabattle.move_left")}),"\xa0",e("games.seabattle.move_left"),s.a.createElement("br",null),s.a.createElement(h,{icon:"arrow-right",size:"S",title:e("games.seabattle.move_right")}),"\xa0",e("games.seabattle.move_right")))),s.a.createElement("div",{className:"HelpModalSection"},s.a.createElement("div",{className:"HelpModalSectionTitle"},e("games.seabattle.help.to_attack")),s.a.createElement("ul",null,s.a.createElement("li",null,e("games.seabattle.help.select_weapon"),s.a.createElement("br",null),s.a.createElement(Ba,{weapons:{bullet1:1,bullet2:1,bullet3:0,mine:1},weaponType:"bullet1"})),s.a.createElement("li",null,e("games.seabattle.help.click_opponent_cell")))),s.a.createElement("div",{className:"HelpModalSection"},s.a.createElement("div",{className:"HelpModalSectionTitle"},e("games.seabattle.help.to_react")),s.a.createElement("ul",null,s.a.createElement("li",null,e("games.seabattle.help.missed_hit")),s.a.createElement("li",null,e("games.seabattle.help.hitted_hit")))))},hr=({items:e,label:t,onViewMore:a,cb:r})=>e.length>0?s.a.createElement(s.a.Fragment,null,s.a.createElement(sr,null,s.a.createElement("div",{className:"XXX"},s.a.createElement("label",null,t))),e.map(e=>s.a.createElement(sr,{key:e.id},s.a.createElement("div",{className:"SearchResultItem"},r(e)))),s.a.createElement(sr,null,s.a.createElement("div",{className:"XXX"},s.a.createElement(k,{icon:"ellipsis-h",onClick:a,title:"View more..."})))):null;a(292);const kr=()=>{const e=Object(i.b)(),t=Object(v.b)().t,a=Object(c.useRef)(null),r=Object(i.c)(w),l=Object(c.useState)(""),u=Object(O.a)(l,2),d=u[0],p=u[1],m=Object(c.useState)("deezer"),b=Object(O.a)(m,2),f=b[0],y=b[1],g=Object(c.useState)("track"),h=Object(O.a)(g,2),x=h[0],E=h[1],_=Object(c.useState)(""),j=Object(O.a)(_,2),S=j[0],C=j[1],N=Object(c.useState)({deezer:{album:[],playlist:[],track:[]},spotify:{album:[],playlist:[],track:[]}}),M=Object(O.a)(N,2),R=M[0],A=M[1],P=Object(c.useCallback)(()=>e(I()),[e]),T=Object(c.useCallback)(Object(o.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(S.trim().length>0)){e.next=6;break}return e.t0=A,e.next=4,Ot(S,{limit:5});case 4:e.t1=e.sent,(0,e.t0)(e.t1);case 6:case"end":return e.stop()}}),e)}))),[S]),L=Object(c.useCallback)((t,a,r)=>e(na([{provider:t,type:a,id:r}])),[e]),z=Object(c.useCallback)((t,a,r)=>{e(Ft({provider:t,type:a,id:r})),p(r),y(t),E(a)},[e]),F=Object(c.useCallback)(Object(o.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.debug("Stop previewing..."),e.next=3,at.stop();case 3:p(""),y("deezer"),E("track");case 6:case"end":return e.stop()}}),e)}))),[]),B=Object(c.useCallback)(function(){var e=Object(o.a)(n.a.mark((function e(t,a){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=A,e.next=3,Ot(S,{limit:50},t,a);case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),[S,A]);return Object(c.useEffect)(()=>(a.current&&a.current.focus(),()=>{console.debug("Stop previewing..."),at.stop()}),[e]),s.a.createElement(nr,{className:"SearchModal",title:t("medias.medias_search"),onSubmit:T,renderButtons:()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(k,{disabled:0===S.trim().length,title:t("medias.search"),kind:"primary",icon:"search",type:"submit"}),s.a.createElement(or,{onClick:P}))},s.a.createElement(sr,null,s.a.createElement("input",{id:"modal-query",type:"text",placeholder:t("medias.search_placeholder"),maxLength:100,minLength:2,required:!0,value:S,ref:a,onChange:e=>C(e.target.value)})),Mt.map(({label:e,provider:a,type:n})=>s.a.createElement(hr,{key:"".concat(a,".").concat(n),label:t(e),items:R[a][n],onViewMore:()=>B(a,n),cb:e=>s.a.createElement(X,{actions:s.a.createElement(k,{disabled:r,title:t("medias.add"),icon:"plus",onClick:()=>L(a,n,e.id)}),media:e,playable:!0,playing:f===a&&x===n&&d===e.id,onPlay:()=>z(a,n,e.id),onStop:F})})))},xr=()=>{const e=Object(i.b)(),t=Object(c.useState)(Pe()),a=Object(O.a)(t,2),r=a[0],n=a[1],o=Object(c.useState)(""),l=Object(O.a)(o,2),u=l[0],d=l[1],p=Object(c.useRef)(null),m=Object(v.b)().t;Object(c.useEffect)(()=>{p.current&&p.current.focus()},[p]);const b=Object(c.useCallback)(()=>e(I()),[e]),f=Object(c.useCallback)(()=>{0!==r.trim().length&&0!==u.trim().length?e(Wt({dbId:r,roomId:u,secret:"",options:{onSuccess:()=>{e(I())}}})):e(F("rooms.id_is_invalid"))},[e,u,r]);return s.a.createElement(nr,{title:m("rooms.room_join"),onSubmit:f,renderButtons:()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(k,{disabled:0===u.trim().length||36!==u.length,title:m("rooms.join"),kind:"primary",icon:"check",type:"submit"}),s.a.createElement(or,{onClick:b}))},s.a.createElement(ur,{id:"modal-serverId",label:m("rooms.server_id"),placeholder:m("rooms.server_id_placeholder"),options:Le.dbIDs.sort((e,t)=>e.localeCompare(t)).map(e=>({id:e,label:e})),value:r,onChange:e=>n(e.target.value)}),s.a.createElement(lr,{id:"modal-roomId",label:m("rooms.id"),type:"text",placeholder:m("rooms.id_placeholder"),maxLength:36,minLength:36,required:!0,value:u,ref:p,onChange:e=>d(e.target.value)}))},Er=({options:e})=>{const t=Object(i.b)(),a=Object(c.useState)(""),r=Object(O.a)(a,2),n=r[0],o=r[1],l=Object(c.useRef)(null),u=Object(v.b)().t;Object(c.useEffect)(()=>{l.current&&l.current.focus()},[l]);const d=Object(c.useCallback)(()=>t(I()),[t]),p=Object(c.useCallback)(()=>{t(Vt({secret:n,options:{onSuccess:()=>{e&&e.onSuccess&&e.onSuccess(),t(I())}}}))},[t,n,e]);return s.a.createElement(nr,{title:u("rooms.room_unlocking"),onSubmit:p,renderButtons:()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(k,{disabled:36!==n.length,title:u("rooms.unlock"),kind:"primary",icon:"unlock",type:"submit"}),s.a.createElement(or,{onClick:d}))},s.a.createElement(lr,{id:"modal-secret",label:u("rooms.key"),type:"password",autoComplete:"password",placeholder:u("rooms.key_placeholder"),maxLength:36,minLength:36,required:!0,value:n,ref:l,onChange:e=>o(e.target.value)}))};a(293);const _r=()=>{const e=Object(i.b)(),t=Object(i.c)(e=>e.modals.stack.length>0?e.modals.stack[e.modals.stack.length-1]:void 0),a=Object(c.useState)(void 0),r=Object(O.a)(a,2),n=r[0],o=r[1],l=Object(c.useState)(void 0),u=Object(O.a)(l,2),d=u[0],p=u[1],m=Object(c.useCallback)(()=>e(I()),[e]);Object(c.useEffect)(()=>{const e=e=>{27===e.keyCode&&m()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[m]),Object(c.useEffect)(()=>{o(void 0),p(t)},[t]),Object(c.useEffect)(()=>{t&&setTimeout(()=>{o(t)},300)},[t]);const b=(e=>{if(e)switch(e.type){case"General/Confirm":return s.a.createElement(cr,e.props);case"General/Help":return s.a.createElement(vr,null);case"User/Connect":return s.a.createElement(dr,e.props);case"User/Create":return s.a.createElement(fr,e.props);case"Room/Create":return s.a.createElement(mr,null);case"Room/Join":return s.a.createElement(xr,null);case"Room/Search":return s.a.createElement(kr,null);case"Room/Unlock":return s.a.createElement(Er,e.props);case"SeaBattle/GameOver":return s.a.createElement(yr,null);case"SeaBattle/Help":return s.a.createElement(gr,null)}return null})(n||d);return s.a.createElement(Wa.CSSTransition,{in:!!n,timeout:300,unmountOnExit:!0},s.a.createElement("div",{className:"ModalOverlay",onClick:e=>{e.stopPropagation(),m()}},b&&s.a.createElement("div",{className:"ModalWrapper",role:"dialog",onClick:e=>{e.stopPropagation()}},b)))},wr={online:navigator.onLine};a(294);const jr=()=>{const e=Object(i.b)(),t=Object(c.useCallback)(()=>{e(M("app/SET",{online:navigator.onLine}))},[e]);return Object(c.useEffect)(()=>(window.addEventListener("online",t),window.addEventListener("offline",t),e(tr()),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",t)}),[e,t]),s.a.createElement("div",{className:"App"},s.a.createElement(_r,null),s.a.createElement(d.d,null,s.a.createElement(d.b,{exact:!0,path:"/room/:dbId/:roomId",component:Va}),s.a.createElement(d.b,{exact:!0,path:"/",component:ar}),s.a.createElement(d.a,{to:"/"})))};var Or=a(81),Sr={audio:{errors:{cannot_decode_audio_data:"Audio buffer cannot be decoded",cannot_load_audio_buffer:"Audio buffer loading failed"}},splash:{CGU:"CGU",powered_with:"Powered with",description:"Collaborative & Musical Experimentations"},help:{help:"Help",rules:"Rules:",rule1:"Create an account",rule1b:"or connect",rule2:"Create a room",rule2b:"or join one",notes:"Notes:",note1:"A room is protected with a secret: it can be accessed without its secret but then no action can be done in it.",note2:"No personal data is accessed or stored."},user:{errors:{invalid:"User is invalid"},user:"User",confirm_disconnect:"Are you sure you want to disconnect?",connect:"Connect",connection:"Connection",create:"Create a user",disconnect:"Disconnect",id:"User ID",id_is_invalid:"ID is invalid",id_placeholder:"User ID...",name_is_invalid:"Name is invalid",name_placeholder:"User Name...",name:"User Name",secret_is_invalid:"Secret is invalid",secret_placeholder:"User Secret...",secret:"User Secret",user_creation:"User Registration",not_connected:"No user is identified"},rooms:{errors:{invalid:"Room is invalid",locked:"Room is locked"},types:{blind:"Blind Test",dj:"DJ",seabattle:"Sea Battle"},clear:"Clear all tracks",confirm_clear:"Are you sure you want to remove all tracks?",confirm_exit:"Are you sure you want to leave the room?",confirm_lock:"Are you sure you want to lock the room?",copy_link:"Copy Room Link to Clipboard",create:"Create a room",empty:"It's empty here, you should add some tracks...",empty_for_now:"It's empty here, the owner has to fill it..",exit:"Exit Room",id:"Room ID",id_placeholder:"Room ID...",server_id:"Server ID",server_id_placeholder:"Server ID...",key_placeholder:"Room Key...",type_placeholder:"Room Type...",key:"Room Key",type:"Room Type",join:"Join a Room",link_copied_to_clipboard:"Room link has been copied to clipboard",loading:"Loading...",locked:"Locked (click to unlock)",name_is_invalid:"Name is invalid",name_placeholder:"Room Name...",name:"Room Name",room_creation:"Room Creation",room_join:"Room Access",room_unlocking:"Room Unlocking",room:"Room",secret_is_invalid:"Secret is invalid",unlock:"Unlock",unlocked:"Unlocked (click to lock)",media_count:"{{count}} media",media_count_plural:"{{count}} medias",track_count:"{{count}} track",track_count_plural:"{{count}} tracks"},medias:{by:"by {{artist}}",add:"Add",remove:"Remove",search:"Search Media",search_placeholder:"Search...",medias_search:"Media Search",deezer:{albums:"Deezer Albums",playlists:"Deezer Playlists",tracks:"Deezer Tracks"},spotify:{albums:"Spotify Albums",playlists:"Spotify Playlists",tracks:"Spotify Tracks"}},player:{backward:"Backward",forward:"Forward",play:"Play",playing:"Playing",stop:"Stop"},cancel:"Cancel",clear:"Clear",copy_to_clipboard:"Copy to Clipboard",loading:"Loading...",secret_copied_to_clipboard:"Secret has been copied to clipboard",games:{seabattle:{help:{you_can:"At each turn, you can:",move_boat:"Move one of your boat",attack_opponent:"Attack an opponent",to_move:"To move:",select_boat:"Select one of your boat",move_with_keyboard:"Move it with the keyboard",or_use_the_buttons:"Or move it using buttons",to_attack:"To attack:",select_weapon:"Select one your weapon",click_opponent_cell:"Click on opponent grid",to_react:"To react following an attack:",hitted_hit:"Red dot = opponent hitted",missed_hit:"White dot = opponent missed"},turn_left:"Turn Left",turn_right:"Turn Right",move_forward:"Move Forward",move_backward:"Move Backward",move_down:"Move Down",move_left:"Move Left",move_right:"Move Right",move_up:"Move Up",movement_not_possible:"This movement is not possible!",movement_not_possible_because_hitted:"A hitted boat cannot move!",opponent_index:"Opponent {{index}}",join_battle:"Join the battle",opponent_already_killed:"All opponent boats have already been killed",ship_already_hitted:"Boat is already hitten at this position",ship_already_killed:"Boat has already been killed",hitted_opponent:"You've hitted opponent boat",killed_opponent:"You've killed all opponent boats",killed_opponent_boat:"You've killed opponent boat",missed_opponent:"You've missed opponent boat",no_weapon_selected:"Select a weapon to attack",weapon_not_available:"Selected weapon is not available",not_your_turn:"This is not your turn",opponent_turn:"It's your opponent turn to play",player_turn:"It's your turn to move or attack",you_have_been_killed:"All your boats have been killed"},max_players_count:"Maximum players number has been already reached",no_opponents:"No opponents",no_opponents_to_attack:"There is no opponent to attack...",connect_to_join:"You have to connect to join...",watch_or_join:"You can watch or..."}},Cr={audio:{errors:{cannot_decode_audio_data:"Le buffer audio ne peut pas \xeatre d\xe9cod\xe9",cannot_load_audio_buffer:"Le buffer audio ne peut pas \xeatre charg\xe9"}},splash:{CGU:"CGU",powered_with:"Utilise",description:"Exp\xe9rimentations collaboratives et musicales"},help:{help:"Aide",rules:"R\xe8gles :",rule1:"Cr\xe9ez un compte",rule1b:"ou connectez-vous",rule2:"Cr\xe9ez une salle",rule2b:"ou rejoignez en une",notes:"Notes :",note1:"Un salle est prot\xe9g\xe9e par un secret : elle peut \xeatre acc\xe9d\xe9e sans son secret mais aucune action ne pourra y \xeatre r\xe9alis\xe9e.",note2:"Aucune donn\xe9e personnelle n'est manipul\xe9e ou stock\xe9e."},user:{errors:{invalid:"L'utilisateur est invalide"},user:"Utilisateur",confirm_disconnect:"\xcates-vous s\xfbr(e) de vouloir vous d\xe9connecter ?",connect:"Se connecter",connection:"Connexion",create:"Cr\xe9er un utilisateur",disconnect:"Se d\xe9connecter",id:"Identifiant",id_is_invalid:"L'identifiant est invalide",id_placeholder:"Identifiant...",name_is_invalid:"Le nom est invalide",name_placeholder:"Nom...",name:"Nom",secret_is_invalid:"Le secret est invalide",secret_placeholder:"Secret...",secret:"Secret",user_creation:"Cr\xe9ation d'un utilisateur",not_connected:"Aucun utilisateur identifi\xe9"},rooms:{errors:{invalid:"La salle est invalide",locked:"La salle est verrouill\xe9e"},types:{blind:"Blind Test",dj:"DJ",seabattle:"Bataille Navale"},clear:"Supprimer toutes les pistes",confirm_clear:"\xcates-vous s\xfbr(e) de vouloir supprimer toutes les pistes ?",confirm_exit:"\xcates-vous s\xfbr(e) de vouloir quitter la salle ?",confirm_lock:"\xcates-vous s\xfbr(e) de vouloir verrouiller la salle ?",copy_link:"Copier le lien de la salle dans le presse-papier",create:"Cr\xe9er une salle",empty:"Cette salle est vide, vous devriez ajouter quelques pistes...",empty_for_now:"Cette salle est pour le moment vide...",exit:"Quitter la salle",id:"Identifiant de la salle",id_placeholder:"Identifiant de la salle...",server_id:"Identifiant du serveur",server_id_placeholder:"Identifiant du serveur...",key_placeholder:"Clef...",type_placeholder:"Type...",key:"Clef",type:"Type",join:"Rejoindre une salle",loading:"Chargement...",link_copied_to_clipboard:"Le lien de la salle a \xe9t\xe9 copi\xe9 dans le presse-papier",locked:"Verrouill\xe9e (cliquer pour d\xe9verrouiller)",name_is_invalid:"Le nom est invalide",name_placeholder:"Nom...",name:"Nom",room:"Salle",room_creation:"Cr\xe9ation d'une salle",room_join:"Rejoindre une salle",room_unlocking:"D\xe9verrouillage de la salle",secret_is_invalid:"Le secret is invalide",unlock:"D\xe9verrouiller",unlocked:"D\xe9verrouill\xe9e (cliquer pour verrouiller)",media_count:"{{count}} media",media_count_plural:"{{count}} medias",track_count:"{{count}} piste",track_count_plural:"{{count}} pistes"},medias:{by:"par {{artist}}",add:"Ajouter",remove:"Supprimer",search:"Chercher des m\xe9dias",search_placeholder:"Recherche...",medias_search:"Recherche de m\xe9dias",deezer:{albums:"Deezer Albums",playlists:"Deezer Playlists",tracks:"Deezer Pistes"},spotify:{albums:"Spotify Albums",playlists:"Spotify Playlists",tracks:"Spotify Pistes"}},player:{backward:"Piste pr\xe9c\xe9dente",forward:"Piste suivante",play:"Lire",playing:"En cours de lecture",stop:"Arr\xeater"},cancel:"Annuler",clear:"Supprimer",copy_to_clipboard:"Copier dans le presse-papier",loading:"Chargement...",secret_copied_to_clipboard:"Le secret a \xe9t\xe9 copi\xe9 dans le presse-papier",games:{seabattle:{help:{you_can:"\xc0 chaque tour, vous pouvez :",move_boat:"D\xe9placer un de vos navires",attack_opponent:"Attaquer un de vos ennemis",to_move:"Pour r\xe9aliser un d\xe9placements :",select_boat:"S\xe9lectionnez un de vos navires",move_with_keyboard:"D\xe9placez le avec le clavier",or_use_the_buttons:"Ou utilisez les boutons :",to_attack:"Pour r\xe9aliser une attaque :",select_weapon:"S\xe9lectionnez une de vos armes",click_opponent_cell:"Cliquez sur la grille ennemi",to_react:"Pour r\xe9agir \xe0 une attaque :",hitted_hit:"Rond rouge = ennemi bless\xe9",missed_hit:"Rond blanc = ennemi rat\xe9"},turn_left:"Tourner \xe0 gauche",turn_right:"Tourner \xe0 droite",move_forward:"Avancer",move_backward:"Reculer",move_down:"Aller vers le bas",move_left:"Aller vers la gauche",move_right:"Aller vers la droite",move_up:"Aller vers le haut",movement_not_possible:"Ce d\xe9placement est impossible !",movement_not_possible_because_hitted:"Un navire touch\xe9 ne peut plus se d\xe9placer !",opponent_index:"Adversaire {{index}}",join_battle:"Participer \xe0 la bataille",opponent_already_killed:"Tous les navirex de l'ennemi ont d\xe9j\xe0 \xe9t\xe9 tu\xe9s",ship_already_hitted:"Le navire est touch\xe9 touch\xe9 \xe0 cette position",ship_already_killed:"Le navire a d\xe9j\xe0 \xe9t\xe9 tu\xe9",hitted_opponent:"Vous avez touch\xe9 un navire ennemi",killed_opponent:"Vous avez tu\xe9 tous les navirex de l'ennemi",killed_opponent_boat:"Vous avez tu\xe9 un navire ennemi",missed_opponent:"Vous n'avez pas touch\xe9 de navire ennemi",no_weapon_selected:"S\xe9lectionnez une arme pour attaquer",weapon_not_available:"L'arme s\xe9lectionn\xe9e n'est plus disponible",not_your_turn:"Ce n'est pas \xe0 votre tour de jouer",opponent_turn:"C'est au tour de votre adversaire de jouer",player_turn:"C'est \xe0 votre tour de bouger ou d'attaquer",you_have_been_killed:"Tous vos navirex ont \xe9t\xe9 tu\xe9s"},max_players_count:"Le nombre maximal de joueurs est d\xe9j\xe0 atteint",no_opponents:"Aucun ennemi",no_opponents_to_attack:"Il n'y aucun ennemi \xe0 attaquer ...",connect_to_join:"Vous devez vous connecter pour participer ...",watch_or_join:"Vous pouvez regarder ou ..."}};const Ir=function(){var e=Object(o.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((e,t)=>{console.debug("Initializing language...",{current:navigator.language||navigator.userLanguage}),Or.a.use(v.a).init({fallbackLng:"en",lng:navigator.language||navigator.userLanguage,resources:{en:{translation:Sr},"en-US":{translation:Sr},fr:{translation:Cr},"fr-FR":{translation:Cr}},interpolation:{escapeValue:!1,format:(e,t,a)=>e}},a=>{a&&t(a),e()})}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Nr=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Mr(e,t){console.debug("PWA registerValidSW 1"),navigator.serviceWorker.register(e).then(e=>{console.debug("PWA registerValidSW 2"),e.onupdatefound=()=>{console.debug("PWA registerValidSW 3");const a=e.installing;null!=a&&(console.debug("PWA registerValidSW 4"),a.onstatechange=()=>{console.debug("PWA registerValidSW 5",a.state),"installed"===a.state&&(navigator.serviceWorker.controller?(console.debug("PWA registerValidSW 6"),console.debug("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.debug("PWA registerValidSW 7"),console.debug("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(e=>{console.error("Error during service worker registration:",e)})}a(295);var Rr=a(22),Ar=a(144);const Pr={error:null,fetching:!1,battle:{currentMapIndex:0,maps:[]}},Tr=Object(Rr.combineReducers)({seabattle:(e=Object(j.a)({},Pr),t)=>{switch(t.type){case"games/seabattle/FETCHING":return Object(j.a)({},e,{fetching:!0,error:null});case"games/seabattle/ERROR":return Object(j.a)({},e,{fetching:!1,error:t.payload});case"games/seabattle/SET":return Object(j.a)({},e,{battle:t.payload,fetching:!1,error:null});case"games/seabattle/RESET":return Pr;default:return e}}}),Lr=Object(Rr.combineReducers)({app:(e=wr,t)=>{switch(t.type){case"app/SET":return Object(j.a)({},e,{},t.payload);case"app/RESET":return wr;default:return e}},games:Tr,medias:(e=Ct,t)=>{switch(t.type){case"medias/FETCHING":return Object(j.a)({},e,{fetching:!0,error:null});case"medias/ERROR":return Object(j.a)({},e,{fetching:!1,error:t.payload});case"medias/SET":{const o=Object(j.a)({},e,{fetching:!1,error:null,medias:{deezer:{album:Object(j.a)({},e.medias.deezer.album),playlist:Object(j.a)({},e.medias.deezer.playlist),track:Object(j.a)({},e.medias.deezer.track)},spotify:{album:Object(j.a)({},e.medias.deezer.album),playlist:Object(j.a)({},e.medias.deezer.playlist),track:Object(j.a)({},e.medias.deezer.track)}}});var a,r=Object(W.a)(t.payload);try{for(r.s();!(a=r.n()).done;){const e=a.value;o.medias[e.provider][e.type][e.id]=e}}catch(n){r.e(n)}finally{r.f()}return o}case"medias/RESET":return Ct;default:return e}},messages:(e=T,t)=>{switch(t.type){case"message/ADD":return Object(j.a)({},e,{[t.payload.id]:Object(j.a)({timer:t.payload.timer},t.payload.message)});case"message/REMOVE":{const a=Object(j.a)({},e);return delete a[t.payload.id],a}case"message/RESET":{if(!t.payload.tag)return T;const a=Object(j.a)({},e);return Object.entries(e).forEach(([e,r])=>{r.tag===t.payload.tag&&delete a[e]}),a}default:return e}},modals:(e=N,t)=>{switch(t.type){case"modals/OPEN":return Object(j.a)({},e,{stack:[t.payload]});case"modals/CLOSE":return Object(j.a)({},e,{stack:[]});case"modals/PUSH":return Object(j.a)({},e,{stack:[...e.stack,t.payload]});case"modals/POP":const a=[...e.stack];return a.pop(),Object(j.a)({},e,{stack:a});default:return e}},room:(e=Nt,t)=>{switch(t.type){case"room/FETCHING":return Object(j.a)({},e,{fetching:!0,error:null});case"room/ERROR":return Object(j.a)({},e,{fetching:!1,error:t.payload});case"room/SET":return Object(j.a)({},e,{},t.payload,{fetching:!1,error:null});case"room/RESET":return Nt;default:return e}},user:(e=Object(j.a)({},Ya,{access:Ga()}),t)=>{switch(t.type){case"user/FETCHING":return Object(j.a)({},e,{fetching:!0,error:null});case"user/ERROR":return Object(j.a)({},e,{fetching:!1,error:t.payload});case"user/SET":{const r=Object(j.a)({},e,{},t.payload,{fetching:!1,error:null});return a=r.access,localStorage.setItem("U",Object($.b)(a)),r}case"user/RESET":return Xa(),Ya;default:return e}var a}}),zr=e=>{const t=Rr.compose,a=Object(Rr.createStore)(Lr,e,t(Object(Rr.applyMiddleware)(Ar.a.withExtraArgument({player:tt}))));return{dispatch:a.dispatch.bind(a),getState:a.getState.bind(a),store:a}};a(296);!function(e){if("serviceWorker"in navigator){if(console.debug("PWA register 1",""),new URL("",window.location.href).origin!==window.location.origin)return void console.debug("PWA register 2");window.addEventListener("load",()=>{const t="".concat("","/service-worker.js");console.debug("PWA register 3"),Nr?(console.debug("PWA register 4"),function(e,t){console.debug("PWA checkValidServiceWorker 1"),fetch(e,{headers:{"Service-Worker":"script"}}).then(a=>{const r=a.headers.get("content-type");console.debug("PWA checkValidServiceWorker 2",r,a.status),404===a.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):Mr(e,t)}).catch(()=>{console.debug("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(()=>{console.debug("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):(console.debug("PWA register 5"),Mr(t,e))})}}(),function(){var e=Object(o.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ir(),e.abrupt("return",zr());case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()().then(({store:e})=>{l.render(c.createElement(i.a,{store:e},c.createElement(u.a,null,c.createElement(d.b,{path:"/",component:jr}))),document.getElementById("root"))})},38:function(e,t,a){"use strict";(function(e){a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return n}));const r=t=>e.from(JSON.stringify(t)).toString("base64"),n=t=>JSON.parse(e.from(t,"base64").toString("ascii"))}).call(this,a(12).Buffer)}},[[145,1,2]]]);
//# sourceMappingURL=main.1e1cd108.chunk.js.map