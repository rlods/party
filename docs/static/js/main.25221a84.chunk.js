(this["webpackJsonpparty-app"]=this["webpackJsonpparty-app"]||[]).push([[0],{106:function(e,t,r){},107:function(e,t,r){},109:function(e,t,r){},110:function(e,t,r){"use strict";r.r(t);var a=r(1),n=r.n(a),c=r(2),o=r(0),s=r.n(o),i=r(21),l=r(3),u=r(19),d=r(18),m=r(8),p=r.n(m),b=r(50),f=r.n(b),v=r(5),k=r(54),g=r.n(k);r(80);const h=s.a.memo(({className:e,color:t,icon:r,size:a="M",title:n})=>s.a.createElement(g.a,{className:p()("Icon",e,a),name:r,style:{color:t},title:n}));r(81);const y=s.a.memo(({className:e,color:t,disabled:r=!1,displayTitle:a=!1,icon:n,kind:c="default",onClick:o,size:i,title:l,type:u="button"})=>s.a.createElement("button",{type:u,"aria-label":l,className:p()("IconButton",e,c,{clickable:!r&&(!!o||"submit"===u)}),onClick:r?void 0:o,title:l},s.a.createElement(h,{color:t,icon:n,size:i}),a&&s.a.createElement("div",{className:p()("IconButtonTitle",i)},l))),E=function(){var e=Object(c.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise(e=>{const r=document.createElement("textarea");r.value=t,r.setAttribute("readonly",""),r.style.position="absolute",r.style.left="-9999px",document.body.appendChild(r);const a=document.getSelection();if(null!==a){const e=a.rangeCount>0&&a.getRangeAt(0);r.select(),document.execCommand("copy"),!1!==e&&(a.removeAllRanges(),a.addRange(e))}document.body.removeChild(r),e()});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=e=>e.room.info,O=e=>!!e.room.room,j=e=>!e.room.access.secret,x=e=>null!==e.room.info&&e.room.info.playing;function _(e,t){return void 0===t?{type:e}:{type:e,payload:t}}let C=0;const S=(e,t,r=5e3)=>a=>{const n=C++;a(_("message/ADD",{id:n,stamp:(new Date).getTime(),text:t,type:e})),setTimeout(()=>a((e=>_("message/REMOVE",e))(n)),r)},N=e=>t=>{t(S("error",e,3e3))},P=e=>S("info",e,3e3),R=e=>_("modals/OPEN",e),T=()=>_("modals/POP"),M=(e,t,r)=>Object(c.a)(n.a.mark((function a(){return n.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!window.confirm(e)){a.next=3;break}return t(),a.abrupt("return");case 3:r&&r();case 4:case"end":return a.stop()}}),a)})));r(82);const z=()=>{const e=Object(l.b)(),t=Object(v.b)().t,r=Object(d.g)(),a=Object(l.c)(w),i=Object(l.c)(e=>e.room.medias.length),u=Object(o.useCallback)(Object(c.a)(n.a.mark((function t(){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E(document.location.href.split("?")[0]);case 2:e(P("rooms.link_copied_to_clipboard"));case 3:case"end":return t.stop()}}),t)}))),[e]),m=Object(o.useCallback)(()=>{e(M(t("rooms.confirm_exit"),()=>{r.push("/")}))},[t,e,r]);return s.a.createElement("div",{className:"Head"},s.a.createElement("div",{className:"HeadInner"},s.a.createElement("div",{className:"RoomLink"},s.a.createElement(y,{icon:"link",onClick:u,size:"M",title:t("rooms.copy_link")})),s.a.createElement("div",{className:"RoomMeta"},a?s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"RoomName"},a.name),s.a.createElement("div",{className:"RoomSize"},"\xa0--\xa0",t("rooms.track_count",{count:i}))):null),s.a.createElement("div",{className:"RoomExit"},s.a.createElement(y,{onClick:m,icon:"sign-out",size:"M",title:t("rooms.exit")}))))},A=s.a.memo(({size:e})=>s.a.createElement(h,{className:"rotating",icon:"circle-o-notch",size:e,title:"Loading"}));r(84);const L=s.a.memo(({playable:e,playing:t,image:r,onPlay:a,onStop:n})=>{const c=Object(v.b)().t;return e?s.a.createElement("div",{className:p()("Cover",{playable:e,playing:t}),style:r?{backgroundImage:"url('".concat(r,"')")}:{},onClick:t?n:a},t?s.a.createElement(h,{icon:"pause",size:"S",title:c("player.stop")}):s.a.createElement(h,{icon:"play",size:"S",title:c("player.play")})):s.a.createElement("div",{className:p()("Cover",{playing:t}),style:r?{backgroundImage:"url('".concat(r,"')")}:{}},t?s.a.createElement(h,{icon:"music",size:"S",title:c("player.playing")}):null)});r(85);const I=s.a.memo(({actions:e,media:t,playable:r,playing:a,onPlay:n,onStop:c})=>{const o=Object(v.b)().t;return t?"album"===t.type?s.a.createElement("div",{className:"Media Album"},s.a.createElement(L,{playable:r,playing:a,image:t.cover_small,onPlay:n,onStop:c}),s.a.createElement("div",{className:"Metas"},s.a.createElement("div",{className:"Meta AlbumTitle"},s.a.createElement("a",{href:t.link,target:"_blank",rel:"noopener noreferrer"},t.title)),s.a.createElement("div",{className:"Meta AlbumArtist"},s.a.createElement("a",{href:t.artist.link,target:"_blank",rel:"noopener noreferrer"},o("medias.by",{artist:t.artist.name})))),e?s.a.createElement("div",{className:"Actions"},e):null):"playlist"===t.type?s.a.createElement("div",{className:"Media Playlist"},s.a.createElement(L,{playable:r,playing:a,image:t.picture_small,onPlay:n,onStop:c}),s.a.createElement("div",{className:"Metas"},s.a.createElement("div",{className:"Meta PlaylistTitle"},s.a.createElement("a",{href:t.link,target:"_blank",rel:"noopener noreferrer"},t.title)),s.a.createElement("div",{className:"Meta PlaylistCreator"},s.a.createElement("a",{href:t.user.link,target:"_blank",rel:"noopener noreferrer"},o("medias.by",{artist:t.user.name})))),e?s.a.createElement("div",{className:"Actions"},e):null):"track"===t.type?s.a.createElement("div",{className:"Media Track"},s.a.createElement(L,{playable:r&&!!t.preview,playing:a,image:t.album.cover_small,onPlay:n,onStop:c}),s.a.createElement("div",{className:"Metas"},s.a.createElement("div",{className:"Meta TrackTitle"},s.a.createElement("a",{href:t.link,target:"_blank",rel:"noopener noreferrer"},t.title)),s.a.createElement("div",{className:"Meta TrackArtist"},s.a.createElement("a",{href:t.artist.link,target:"_blank",rel:"noopener noreferrer"},o("medias.by",{artist:t.artist.name})))),e?s.a.createElement("div",{className:"Actions"},e):null):null:s.a.createElement("div",{className:"Media"},s.a.createElement(L,{playable:r,playing:a,image:"",onPlay:n,onStop:c}),s.a.createElement("div",{className:"Metas"},s.a.createElement(A,{size:"M"})),e?s.a.createElement("div",{className:"Actions"},e):null)}),q=s.a.memo(({locked:e,track:t,playing:r,onPlay:a,onRemove:n,onStop:c})=>{const o=Object(v.b)().t;return s.a.createElement("div",{className:"QueueItem"},s.a.createElement(I,{media:t,playable:!!t&&!e,playing:r,onPlay:a,onStop:c,actions:s.a.createElement(y,{disabled:e,title:o("medias.remove"),icon:"trash",onClick:n})}))});var U=r(14);const F=e=>{const t=[],r=e.medias.medias,a=e.room.tracks;var n,c=Object(U.a)(a);try{for(c.s();!(n=c.n()).done;){const e=n.value,a=r[e.provider][e.type][e.id];a?t.push(a):t.push(null)}}catch(o){c.e(o)}finally{c.f()}return t};var D=r(4),W=r(6),B=r(111),V=r(20);r(86);const G={appIDs:"test-rl-7ffe8".split("|")};const H={},X=G.appIDs[0],Q=(e=X)=>{let t=H[e];if(!t){console.debug("[Firebase] Creating app",{appId:e});const r="https://".concat(e,".firebaseio.com"),a=V.initializeApp({databaseURL:r}),n=V.database(a);H[e]=t={app:a,database:n,members:n.ref("members"),rooms:n.ref("rooms"),users:n.ref("users")}}return t},J=({id:e,secret:t})=>{const r=Q(),a=r.rooms.child(e),o=a.child("info"),s=r.members.child(e);let i=t||"";return{id:e,isLocked:()=>!i,setSecret:e=>{console.debug("[Firebase] Setting room secret",{oldSecret:i,newSecret:e}),i=e},wait:function(){var e=Object(c.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((e,t)=>{console.debug("[Firebase] Waiting room..."),o.once("value",r=>{const a=r.val();a?e(a):t(new Error("rooms.errors.invalid"))})}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),subscribe:e=>(console.debug("[Firebase] Subscribing room..."),o.on("value",e)),subscribeMembers:(e,t)=>{console.debug("[Firebase] Subscribing members..."),s.on("child_added",e),s.on("child_removed",t)},unsubscribe:e=>{console.debug("[Firebase] Unsubscribing room..."),o.off("value",e)},unsubscribeMembers:(e,t)=>{console.debug("[Firebase] Unsubscribing members..."),s.off("child_added",e),s.off("child_removed",t)},update:function(){var e=Object(c.a)(n.a.mark((function e({name:t,playing:r,queue:c,queue_position:o}){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.debug("[Firebase] Updating room...",{name:t,playing:r,queue:c,queue_position:o}),e.next=3,a.set({info:{name:t,playing:r,queue:c,queue_position:o,timestamp:V.database.ServerValue.TIMESTAMP},secret:i});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}},K=({id:e,secret:t})=>{const r=Q().users.child(e),a=r.child("info");let o=null,s=t||"",i={name:"dummy",online:!1,room_id:"",status:"",timestamp:0};const l=function(){var e=Object(c.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((e,t)=>{console.debug("[Firebase] Waiting user..."),a.once("value",r=>{const a=r.val();a?(i=a,e(a)):t(new Error("users.errors.invalid"))})}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u=function(){var e=Object(c.a)(n.a.mark((function e({name:t,room_id:a}){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.debug("[Firebase] Updating user...",{name:t,room_id:a}),void 0!==t&&(i.name=t),void 0!==a&&(i.room_id=a),e.next=5,r.set({info:Object(D.a)({},i,{online:!0,status:"online",timestamp:V.database.ServerValue.TIMESTAMP}),secret:s});case 5:d();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=()=>{console.debug("[Firebase] Installing user disconnect..."),r.onDisconnect().cancel(),r.onDisconnect().set({info:Object(D.a)({},i,{online:!1,room_id:"",status:"disconnected",timestamp:V.database.ServerValue.TIMESTAMP}),secret:s})};return{id:e,enter:function(){var t=Object(c.a)(n.a.mark((function t(r){var a;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=Q(),!o){t.next=5;break}return t.next=4,o.remove();case 4:o=null;case 5:return t.next=7,u({room_id:r.id});case 7:return o=a.members.child(r.id).child(e),o.onDisconnect().remove(),t.next=11,o.set({timestamp:V.database.ServerValue.TIMESTAMP});case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),exit:function(){var e=Object(c.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=4;break}return e.next=3,o.remove();case 3:o=null;case 4:return e.next=6,u({room_id:""});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),isLocked:()=>!s,setSecret:e=>{console.debug("[Firebase] Setting user secret...",{oldSecret:s,newSecret:e}),s=e},wait:l,subscribe:e=>(console.debug("[Firebase] Subscribing user..."),a.on("value",e)),unsubscribe:e=>{console.debug("[Firebase] Unsubscribing user..."),a.off("value",e)},update:u}},$=[{label:"medias.albums",provider:"deezer",type:"album"},{label:"medias.playlists",provider:"deezer",type:"playlist"},{label:"medias.tracks",provider:"deezer",type:"track"}],Y=(e,t)=>t[e.provider][e.type][e.id],Z=(e,t,r)=>Y(e,t)||((e,t)=>t.find(t=>t.id===e.id&&t.provider===e.provider&&t.type===e.type))(e,r),ee=(e,t,r)=>{const a=Z(e,t,r);return a?"track"===a.type?a:a.tracks&&a.tracks.length>0?a.tracks[0]:null:null},te=(e,t,r)=>{const a=[];var n,c=Object(U.a)(e);try{for(c.s();!(n=c.n()).done;){const e=n.value;if("track"===e.type){a.push({contextId:e.id,contextType:e.type,id:e.id,provider:e.provider,type:e.type});continue}const c=Z(e,t,r);if(!c)throw new Error("Media is unknown");if("track"!==c.type&&c.tracks&&c.tracks.length>0){var o,s=Object(U.a)(c.tracks);try{for(s.s();!(o=s.n()).done;){const e=o.value;a.push({contextId:c.id,contextType:c.type,id:e.id,provider:e.provider,type:e.type})}}catch(i){s.e(i)}finally{s.f()}}}}catch(i){c.e(i)}finally{c.f()}return a},re=(e,t,r)=>{if(t<0)throw new Error("Track index is out of range");let a=0;for(let n=0;n<e.length;++n){const c=e[n];if("track"===c.type){if(t===a)return{mediaFirstTrackIndex:t,mediaIndex:n,mediaSize:1};a++}else{const e=Y(c,r);if(!e)throw new Error("Media is unknown");if("track"!==e.type&&e.tracks&&e.tracks.length>0){const r=a;for(let c=0;c<e.tracks.length;++c){if(t===a)return{mediaFirstTrackIndex:r,mediaIndex:n,mediaSize:e.tracks.length};a++}}}}throw new Error("Track index is out of range")},ae=[];let ne=null;const ce=()=>(ne||(console.debug("[Audio] Creating context"),ne=new(window.AudioContext||window.webkitAudioContext)),ne),oe=()=>ce().currentTime,se=e=>new Promise((t,r)=>ce().decodeAudioData(e,t,r)),ie=e=>new Promise((t,r)=>{const a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.addEventListener("error",()=>r(new Error("audio.errors.cannot_load_audio_buffer")),!1),a.addEventListener("load",Object(c.a)(n.a.mark((function c(){return n.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.t0=t,n.next=4,se(a.response);case 4:n.t1=n.sent,(0,n.t0)(n.t1),n.next=12;break;case 8:n.prev=8,n.t2=n.catch(0),console.debug("[Audio] An error occurred while decoding data",{error:n.t2,url:e}),r(new Error("audio.errors.cannot_decode_audio_data"));case 12:case"end":return n.stop()}}),c,null,[[0,8]])}))),!1),a.send()}),le=function(){var e=Object(c.a)(n.a.mark((function e(t){var r,a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("URL is invalid");case 2:if(r=null,!((a=ae.findIndex(e=>e.url===t))>=0)){e.next=9;break}console.debug("[Audio] Reusing cached buffer...",{url:t}),r=ae.splice(a,1)[0].buffer,e.next=13;break;case 9:return console.debug("[Audio] Loading buffer...",{url:t}),e.next=12,ie(t);case 12:r=e.sent;case 13:return ae.push({buffer:r,url:t}),ae.splice(10),e.abrupt("return",r);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(()=>{const e=()=>{document.removeEventListener("click",e),document.removeEventListener("touchstart",e),console.debug("[Audio] Fixing context...");const t=ce();var r=t.createBuffer(1,1,22050),a=t.createBufferSource();a.buffer=r,a.connect(t.destination),a.start(0)};document.addEventListener("click",e),document.addEventListener("touchstart",e)})();const ue=()=>{let e=null,t=null,r=null,a=0,o=null,s=0,i="",l=-1;const u=()=>(r||(r=ce().destination,t=ce().createGain(),t.gain.value=1,t.connect(r),r=t,e=ce().createAnalyser(),e.fftSize=128,e.connect(r),r=e),r),d=function(){var e=Object(c.a)(n.a.mark((function e(t,r,c,d){var p;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m();case 2:return e.next=4,le(c);case 4:p=e.sent,console.debug("[Player] Starting audio...",{trackPosition:t,trackId:r,trackUrl:c}),a=p.duration,i=r,l=t,o=ce().createBufferSource(),o.buffer=p,o.loop=!1,o.loopStart=0,o.loopEnd=0,o.onended=()=>{console.debug("[Player] Audio terminated..."),a=0,o=null,s=0,i="",l++},o.playbackRate.value=1,o.connect(u()),o.start(0,d),s=oe();case 19:case"end":return e.stop()}}),e)})));return function(t,r,a,n){return e.apply(this,arguments)}}(),m=()=>new Promise(e=>{null!==o?(console.debug("[Player] Stopping play..."),o.onended=()=>{console.debug("[Player] Forced audio termination..."),e()},o.stop(),a=0,o=null,s=0,i="",l=-1):e()});return{getPlayingTrackID:()=>i,getPlayingTrackPercent:()=>o?(oe()-s)/a:0,getPlayingTrackPosition:()=>l,isPlaying:()=>!!o,play:d,stop:m}},de=ue(),me=ue(),pe=e=>new Promise(t=>setTimeout(t,e));var be=r(56),fe=r.n(be);const ve=(e,t)=>new Promise((r,a)=>{fe()(t?"".concat(e,"?").concat(t,"&output=jsonp&callback="):"".concat(e,"?output=jsonp&callback="),void 0,(e,t)=>{e?a(new Error(e.message)):r(t)})}),ke=e=>({artist:{id:e.artist.id.toString(),name:e.artist.name,link:"https://www.deezer.com/artist/".concat(e.artist.id),picture_big:e.artist.picture_big,picture_small:e.artist.picture_small},cover_big:e.cover_big,cover_small:e.cover_small,id:e.id.toString(),link:"https://www.deezer.com/album/".concat(e.id),provider:"deezer",title:e.title,tracks:void 0!==e.tracks?e.tracks.data.filter(e=>e.readable&&e.preview).map(t=>he(t,e)):void 0,type:"album"}),ge=(e,t)=>({id:e.id.toString(),link:"https://www.deezer.com/playlist/".concat(e.id),picture_big:e.picture_big,picture_small:e.picture_small,provider:"deezer",title:e.title,tracks:void 0!==e.tracks?e.tracks.data.filter(e=>e.readable&&e.preview).map(e=>he(e,e.album)):void 0,type:"playlist",user:{id:t.id.toString(),name:t.name,link:"https://www.deezer.com/profile/".concat(t.id)}}),he=(e,t)=>({album:{id:t.id.toString(),link:"https://www.deezer.com/album/".concat(t.id),title:t.title,cover_big:t.cover_big,cover_small:t.cover_small},artist:{id:e.artist.id.toString(),name:e.artist.name,link:"https://www.deezer.com/artist/".concat(e.artist.id),picture_big:e.artist.picture_big,picture_small:e.artist.picture_small},duration:e.duration,id:e.id.toString(),link:"https://www.deezer.com/track/".concat(e.id),preview:e.preview,provider:"deezer",title:e.title,type:"track"}),ye=(()=>{const e=function(){var e=Object(c.a)(n.a.mark((function e(t,r){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.debug("[Deezer] Requesting... ",{path:t,qs:r}),e.abrupt("return",ve("".concat("https://api.deezer.com","/").concat(t),r));case 2:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),t=(t,r,a)=>e("search/".concat(t),"q=".concat(encodeURIComponent(r)).concat(a&&a.limit?"&limit=".concat(a.limit):"")),r=(t,r)=>Promise.all(r.map(function(){var r=Object(c.a)(n.a.mark((function r(a){var c;return n.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e("".concat(t,"/").concat(a));case 2:if(!(c=r.sent).error){r.next=8;break}if(4!==c.error.code){r.next=6;break}return r.abrupt("return",null);case 6:throw console.error("[Deezer] An error occured while loading media",c.error),new Error("An error occured while loading media");case 8:return r.abrupt("return",c);case 9:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())),a=function(){var e=Object(c.a)(n.a.mark((function e(t,a){var c,o,s,i,l;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=!0,o=a.map(()=>null);case 2:if(!o.includes(null)){e.next=17;break}if(s=[],i=[],o.forEach((e,t)=>{e||(s.push(a[t]),i.push(t))}),c){e.next=10;break}return console.debug("[Deezer] Handling rate limit delayed batch...",{subIds:s}),e.next=10,pe(5e3);case 10:return e.next=12,r(t,s);case 12:l=e.sent,i.forEach((e,t)=>{o[e]=l[t]}),c=!1,e.next=2;break;case 17:return e.abrupt("return",o);case 18:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();return{searchAlbums:function(){var e=Object(c.a)(n.a.mark((function e(r,a){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==r.trim().length){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,t("album",r,a);case 4:return e.abrupt("return",e.sent.data.map(ke));case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),searchPlaylists:function(){var e=Object(c.a)(n.a.mark((function e(r,a){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==r.trim().length){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,t("playlist",r,a);case 4:return e.abrupt("return",e.sent.data.filter(e=>e.public).map(e=>ge(e,e.user)));case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),searchTracks:function(){var e=Object(c.a)(n.a.mark((function e(r,a){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==r.trim().length){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,t("track",r,a);case 4:return e.abrupt("return",e.sent.data.filter(e=>e.readable&&e.preview).map(e=>he(e,e.album)));case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),loadAlbums:function(){var e=Object(c.a)(n.a.mark((function e(t){var r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",[]);case 2:return console.debug("[Deezer] Loading albums...",{ids:t}),e.next=5,a("album",t);case 5:return r=e.sent,e.abrupt("return",r.map(e=>ke(e)));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),loadPlaylists:function(){var e=Object(c.a)(n.a.mark((function e(t){var r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",[]);case 2:return console.debug("[Deezer] Loading playlists...",{ids:t}),e.next=5,a("playlist",t);case 5:return r=e.sent,e.abrupt("return",r.map(e=>ge(e,e.creator)));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),loadTracks:function(){var e=Object(c.a)(n.a.mark((function e(t){var r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",[]);case 2:return console.debug("[Deezer] Loading tracks...",{ids:t}),e.next=5,a("track",t);case 5:return r=e.sent,e.abrupt("return",r.map(e=>he(e,e.album)));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}})(),Ee=function(){var e=Object(c.a)(n.a.mark((function e(t){var r,a,c,o,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r={deezer:{album:[],playlist:[],track:[]}},a=Object(U.a)(t);try{for(a.s();!(c=a.n()).done;)o=c.value,r[o.provider][o.type].push(o.id)}catch(n){a.e(n)}finally{a.f()}return e.next=5,ye.loadAlbums(r.deezer.album);case 5:return e.t0=e.sent,e.next=8,ye.loadPlaylists(r.deezer.playlist);case 8:return e.t1=e.sent,e.next=11,ye.loadTracks(r.deezer.track);case 11:return e.t2=e.sent,e.t3={album:e.t0,playlist:e.t1,track:e.t2},s={deezer:e.t3},e.abrupt("return",t.map(e=>s[e.provider][e.type][r[e.provider][e.type].indexOf(e.id)]));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),we=function(){var e=Object(c.a)(n.a.mark((function e(t,r){var a,c,o,s,i,l;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.filter(e=>!r[e.provider][e.type][e.id]).filter((e,t,r)=>t===r.findIndex(t=>t.id===e.id&&t.provider===e.provider&&t.type===e.type)),e.next=3,Ee(a);case 3:c=e.sent,o=[],s=Object(U.a)(c);try{for(s.s();!(i=s.n()).done;)l=i.value,o.push(l),"track"!==l.type&&o.push(...l.tracks)}catch(n){s.e(n)}finally{s.f()}return e.abrupt("return",{newMedias:c,newMediasAndTracks:o});case 8:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),Oe=function(){var e=Object(c.a)(n.a.mark((function e(t,r){var a,c,o,s,i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([ye.searchAlbums(t,r),ye.searchPlaylists(t,r),ye.searchTracks(t,r)]);case 2:return a=e.sent,c=Object(W.a)(a,3),o=c[0],s=c[1],i=c[2],e.abrupt("return",{deezer:{album:o,playlist:s,track:i}});case 8:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),je=e=>e.response&&e.response.data&&e.response.data.message?e.response.data.message:e.message,xe=e=>_("medias/SET",e),_e=e=>function(){var t=Object(c.a)(n.a.mark((function t(r,a){var c,o,s,i,l;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,c=a(),o=c.medias.medias,t.next=4,we([e],o);case 4:if(s=t.sent,i=s.newMedias,l=ee(e,o,i)){t.next=9;break}throw new Error("[Medias] Cannot find track to preview...");case 9:return console.debug("[Medias] Previewing track...",{track:l}),t.next=12,me.play(0,l.id,l.preview,0);case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),r(N(je(t.t0)));case 17:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e,r){return t.apply(this,arguments)}}();var Ce=r(37);const Se={},Ne={bg:{r:255,g:255,b:255},fg:"dark"},Pe=function(){var e=Object(c.a)(n.a.mark((function e(t){var r,a,c,o,s,i,l;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Ne,!t){e.next=19;break}if(r=Se[t]){e.next=19;break}return e.prev=4,e.next=7,Ce.read(t);case 7:return a=e.sent,e.next=10,a.resize(1,1).getPixelColor(0,0);case 10:c=e.sent,o=Ce.intToRGBA(c),s=o.r,i=o.g,l=o.b,Se[t]=r={bg:{r:s,g:i,b:l},fg:.299*s+.587*i+.114*l>186?"dark":"light"},e.next=19;break;case 15:e.prev=15,e.t0=e.catch(4),console.error("An error prevented colorpicking",e.t0),Se[t]=r=Ne;case 19:return e.abrupt("return",r);case 20:case"end":return e.stop()}}),e,null,[[4,15]])})));return function(t){return e.apply(this,arguments)}}();var Re=r(10),Te=Object(Re.b)();const Me=e=>_("room/SET",e),ze=(e,t)=>function(){var r=Object(c.a)(n.a.mark((function r(a){var c;return n.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,c=Object(B.a)(),console.debug("[Room] Creating...",{id:c,secret:t}),r.next=5,J({id:c,secret:t}).update({name:e,playing:!1,queue:{},queue_position:0});case 5:a(Ae(c,t)),r.next=11;break;case 8:r.prev=8,r.t0=r.catch(0),a(N(je(r.t0)));case 11:case"end":return r.stop()}}),r,null,[[0,8]])})));return function(e){return r.apply(this,arguments)}}(),Ae=(e,t)=>function(){var r=Object(c.a)(n.a.mark((function r(a,c){var o,s,i;return n.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=c(),!(s=o.room.room)||s.id!==e){r.next=3;break}return r.abrupt("return");case 3:return a(Le()),r.prev=4,console.debug("[Room] Entering...",{id:e,secret:t}),i=J({id:e,secret:t}),r.t0=a,r.t1=Me,r.t2={id:e,secret:t},r.t3=i,r.next=13,i.wait();case 13:r.t4=r.sent,r.t5={access:r.t2,room:r.t3,info:r.t4},r.t6=(0,r.t1)(r.t5),(0,r.t0)(r.t6),a(Fe(i)),Te.push("/room/".concat(e,"?secret=").concat(t)),r.next=24;break;case 21:r.prev=21,r.t7=r.catch(4),a(N(je(r.t7)));case 24:case"end":return r.stop()}}),r,null,[[4,21]])})));return function(e,t){return r.apply(this,arguments)}}(),Le=()=>function(){var e=Object(c.a)(n.a.mark((function e(t,r){var a,c;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r(),c=a.room.room){e.next=3;break}return e.abrupt("return");case 3:console.debug("[Room] Exiting..."),t(Ge()),t(De(c)),t(_("room/RESET"));case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),Ie=()=>function(){var e=Object(c.a)(n.a.mark((function e(t,r){var a,c,o,s,i,l;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r(),c=a.room,o=c.room,s=c.access,i=s.id,l=s.secret,o&&o.id===i&&l){e.next=3;break}return e.abrupt("return");case 3:console.debug("[Room] Locking...",{id:i}),o.setSecret(""),t(Me({access:{id:i,secret:""}}));case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),qe=e=>function(){var t=Object(c.a)(n.a.mark((function t(r,a){var c,o,s,i,l,u;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=a(),o=c.room,s=o.room,i=o.access,l=i.id,u=i.secret,s&&s.id===l&&u!==e){t.next=3;break}return t.abrupt("return");case 3:console.debug("[Room] Unlocking...",{id:l,secret:e}),s.setSecret(e),r(Me({access:{id:l,secret:e}}));case 6:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}();let Ue=null;const Fe=e=>function(){var t=Object(c.a)(n.a.mark((function t(r,a,{player:o}){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.debug("[Room] Watching..."),!Ue){t.next=3;break}return t.abrupt("return");case 3:Ue=e.subscribe(function(){var t=Object(c.a)(n.a.mark((function t(c){var s,i,l,u,d,m,p,b;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=a(),i=s.medias.medias,l=c.val(),console.debug("[Room] Received room update...",l),u=[],l.queue&&(u=Object.entries(l.queue).sort((e,t)=>Number(e[0])-Number(t[0])).map(e=>e[1])),l.playing!==o.isPlaying()&&(l.playing?(We&&console.debug("************ ARG ************"),r(Ve())):r(Ge())),d=[],!(u.length>0)){t.next=15;break}return t.next=10,we(u,i);case 10:m=t.sent,p=m.newMedias,(b=m.newMediasAndTracks).length>0&&r(xe(b)),d=te(u,i,p);case 15:r(Me({info:l,medias:u,room:e,tracks:d}));case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 4:case"end":return t.stop()}}),t)})));return function(e,r,a){return t.apply(this,arguments)}}(),De=e=>Object(c.a)(n.a.mark((function t(){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Ue){t.next=2;break}return t.abrupt("return");case 2:console.debug("Unwatching room..."),e.unsubscribe(Ue),Ue=null;case 5:case"end":return t.stop()}}),t)})));let We=null;const Be=(e,t,r)=>{let a=-1;const n=e.getPlayingTrackID(),c=e.getPlayingTrackPosition()%t.length;return c!==r?e.isPlaying()?n!==t[r].id&&(a=r):a=c>=0?c:r:n!==t[r].id&&(a=r),a},Ve=()=>function(){var e=Object(c.a)(n.a.mark((function e(t,r,{player:a}){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:We||(console.debug("[Room] Watching player... ********************"),He(t,r,a,250));case 1:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}(),Ge=()=>function(){var e=Object(c.a)(n.a.mark((function e(t,r,{player:a}){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return We&&(console.debug("[Room] Unwatching player... ********************"),clearTimeout(We),We=null),e.next=3,a.stop();case 3:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}(),He=(e,t,r,a)=>{We=setTimeout(Object(c.a)(n.a.mark((function c(){var o,s,i,l,u,d,m,p,b,f,v;return n.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=t(),s=o.room,i=s.info,l=s.tracks,u=o.medias.medias,!(l.length>0)){n.next=22;break}if(!((d=Be(r,l,i.queue_position))>=0)){n.next=19;break}return m=l[d],p=u[m.provider][m.type][m.id],console.debug("Detected play change...",{nextTrack:p,nextTrackIndex:d}),n.prev=7,n.next=10,Promise.all([Pe(p.album.cover_small),r.play(d,p.id,p.preview,0)]);case 10:b=n.sent,f=Object(W.a)(b,1),v=f[0],e(Me({color:v,info:Object(D.a)({},i,{queue_position:d})})),n.next=19;break;case 16:n.prev=16,n.t0=n.catch(7),e(N(je(n.t0)));case 19:He(e,t,r,a),n.next=27;break;case 22:return console.debug("[Room] No more tracks in queue..."),e(Me({info:Object(D.a)({},i,{playing:!1})})),n.next=26,r.stop();case 26:We=null;case 27:case"end":return n.stop()}}),c,null,[[7,16]])}))),a)},Xe=()=>function(){var e=Object(c.a)(n.a.mark((function e(t,r){var a,c,o,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r(),c=a.room,o=c.info,(s=c.room)&&!s.isLocked()&&o){e.next=4;break}return t(N("rooms.error.locked")),e.abrupt("return");case 4:if(!o.playing){e.next=6;break}return e.abrupt("return");case 6:return e.prev=6,console.debug("[Player] Starting..."),e.next=10,s.update(Object(D.a)({},o,{playing:!0}));case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(6),t(N(je(e.t0))),t(Ie());case 16:case"end":return e.stop()}}),e,null,[[6,12]])})));return function(t,r){return e.apply(this,arguments)}}(),Qe=()=>function(){var e=Object(c.a)(n.a.mark((function e(t,r){var a,c,o,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r(),c=a.room,o=c.info,(s=c.room)&&!s.isLocked()&&o){e.next=4;break}return t(N("rooms.error.locked")),e.abrupt("return");case 4:if(o.playing){e.next=6;break}return e.abrupt("return");case 6:return e.prev=6,console.debug("[Player] Stopping..."),e.next=10,s.update(Object(D.a)({},o,{playing:!1}));case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(6),t(N(je(e.t0))),t(Ie());case 16:case"end":return e.stop()}}),e,null,[[6,12]])})));return function(t,r){return e.apply(this,arguments)}}(),Je=(e,t)=>{const r={};return[...e,...t].forEach(({id:e,provider:t,type:a},n)=>{r[n]={id:e,provider:t,type:a}}),r},Ke=(e,t,r)=>{if(t<0||t>=e.length)throw new Error("Media index is out of range");const a={},n=[...e];return n.splice(t,r),n.forEach(({id:e,provider:t,type:r},n)=>{a[n]={id:e,provider:t,type:r}}),a},$e=()=>function(){var e=Object(c.a)(n.a.mark((function e(t,r){var a,c,o,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r(),c=a.room,o=c.info,(s=c.room)&&!s.isLocked()&&o){e.next=4;break}return t(N("rooms.error.locked")),e.abrupt("return");case 4:return e.prev=4,console.debug("[Queue] Clearing medias..."),e.next=8,s.update(Object(D.a)({},o,{playing:!1,queue:{},queue_position:0}));case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(4),t(N(je(e.t0))),t(Ie());case 14:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(t,r){return e.apply(this,arguments)}}(),Ye=e=>function(){var t=Object(c.a)(n.a.mark((function t(r,a){var c,o,s,i,l;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=a(),o=c.room,s=o.info,i=o.medias,(l=o.room)&&!l.isLocked()&&s){t.next=4;break}return r(N("rooms.error.locked")),t.abrupt("return");case 4:if(0!==e.length){t.next=6;break}return t.abrupt("return");case 6:return t.prev=6,console.debug("[Queue] Appending medias...",{newMedias:e}),t.next=10,l.update(Object(D.a)({},s,{queue:Je(i,e)}));case 10:t.next=16;break;case 12:t.prev=12,t.t0=t.catch(6),r(N(je(t.t0))),r(Ie());case 16:case"end":return t.stop()}}),t,null,[[6,12]])})));return function(e,r){return t.apply(this,arguments)}}(),Ze=e=>function(){var t=Object(c.a)(n.a.mark((function t(r,a){var c,o,s,i,l,u,d,m,p,b,f,v,k;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=a(),o=c.medias.medias,s=c.room,i=s.info,l=s.medias,u=s.room,d=s.tracks,u&&!u.isLocked()&&i){t.next=4;break}return r(N("rooms.error.locked")),t.abrupt("return");case 4:if(m=re(l,e,o),p=m.mediaFirstTrackIndex,b=m.mediaIndex,f=m.mediaSize,!(b<0)){t.next=7;break}return t.abrupt("return");case 7:if(v=i.queue_position,t.prev=8,console.debug("[Queue] Removing track...",{playingTrackIndex:v,removedMediaIndex:b,removedTrackCount:f,removedTrackIndex:e,removedMediaFirstTrackIndex:p}),k=Ke(l,b,1),0!==Object.keys(k).length){t.next=17;break}return console.debug("[Queue] Removing last media..."),t.next=15,u.update(Object(D.a)({},i,{playing:!1,queue:{},queue_position:0}));case 15:t.next=29;break;case 17:if(!(v<e)){t.next=22;break}return t.next=20,u.update(Object(D.a)({},i,{queue:k}));case 20:t.next=29;break;case 22:if(!(v>=p&&v<p+f)){t.next=27;break}return t.next=25,u.update(Object(D.a)({},i,{queue:k,queue_position:p+f===d.length?p-1:p}));case 25:t.next=29;break;case 27:return t.next=29,u.update(Object(D.a)({},i,{queue:k,queue_position:v-f}));case 29:t.next=35;break;case 31:t.prev=31,t.t0=t.catch(8),r(N(je(t.t0))),r(Ie());case 35:case"end":return t.stop()}}),t,null,[[8,31]])})));return function(e,r){return t.apply(this,arguments)}}(),et=e=>function(){var t=Object(c.a)(n.a.mark((function t(r,a){var c,o,s,i,l;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=a(),o=c.room,s=o.info,(i=o.room)&&!i.isLocked()&&s){t.next=4;break}return r(N("rooms.error.locked")),t.abrupt("return");case 4:if((l=s.queue_position)!==e){t.next=7;break}return t.abrupt("return");case 7:return t.prev=7,console.debug("[Queue] Set position...",{oldTrackIndex:l,newTrackIndex:e}),t.next=11,i.update(Object(D.a)({},s,{playing:!0,queue_position:e}));case 11:t.next=17;break;case 13:t.prev=13,t.t0=t.catch(7),r(N(je(t.t0))),r(Ie());case 17:case"end":return t.stop()}}),t,null,[[7,13]])})));return function(e,r){return t.apply(this,arguments)}}(),tt=()=>function(){var e=Object(c.a)(n.a.mark((function e(t,r){var a,c,o,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r(),c=a.room,o=c.info,s=c.tracks,o&&0!==s.length){e.next=3;break}return e.abrupt("return");case 3:console.debug("[Queue] Moving backward..."),t(et(o.queue_position>0?o.queue_position-1:s.length-1));case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),rt=()=>function(){var e=Object(c.a)(n.a.mark((function e(t,r){var a,c,o,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r(),c=a.room,o=c.info,s=c.tracks,o&&0!==s.length){e.next=3;break}return e.abrupt("return");case 3:console.debug("[Queue] Moving forward..."),t(et((o.queue_position+1)%s.length));case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();r(91);const at=()=>{const e=Object(l.b)(),t=Object(l.c)(O),r=Object(l.c)(j),a=Object(l.c)(x),n=Object(l.c)(e=>null!==e.room.info?e.room.info.queue_position:0),c=Object(l.c)(F),i=Object(o.useCallback)(t=>{e(Xe()),e(et(t))},[e]),u=Object(o.useCallback)(t=>e(Ze(t)),[e]),d=Object(o.useCallback)(()=>e(R({type:"Search",props:null})),[e]),m=Object(o.useCallback)(()=>e(Qe()),[e]);return s.a.createElement("div",{className:"Queue"},c.length>0?s.a.createElement(ct,{locked:r,tracks:c,playing:a,playingIndex:n,onPlay:i,onRemove:u,onStop:m}):s.a.createElement(nt,{loaded:t,locked:r,onSearch:d}))},nt=s.a.memo(({loaded:e,locked:t,onSearch:r})=>{const a=Object(v.b)().t;return s.a.createElement("div",{className:"QueueEmpty"},e?s.a.createElement(s.a.Fragment,null,s.a.createElement(y,{title:"...",icon:"shower",onClick:r,size:"L"}),s.a.createElement("span",{onClick:r},a(t?"rooms.empty_for_now":"rooms.empty"))):s.a.createElement(s.a.Fragment,null,s.a.createElement(A,{size:"L"}),s.a.createElement("span",null,a("rooms.loading"))))}),ct=s.a.memo(({locked:e,tracks:t,playing:r,playingIndex:a,onPlay:n,onRemove:c,onStop:o})=>s.a.createElement(s.a.Fragment,null,t.map((t,i)=>s.a.createElement(q,{key:i,locked:e,playing:r&&a===i,track:t,onPlay:()=>n(i),onRemove:()=>c(i),onStop:o}))));r(92);const ot=()=>{const e=Object(o.useState)(0),t=Object(W.a)(e,2),r=t[0],a=t[1];return Object(o.useEffect)(()=>{const e=setInterval(()=>{a(de.getPlayingTrackPercent())},250);return()=>{clearInterval(e)}},[a]),s.a.createElement("div",{className:"Progress"},s.a.createElement("progress",{max:100,value:100*r}))};r(93);const st=()=>{const e=Object(l.b)(),t=Object(v.b)().t,r=Object(l.c)(e=>e.room.medias.length),a=Object(l.c)(j),n=Object(l.c)(x),c=Object(o.useCallback)(()=>{e(M(t("rooms.confirm_clear"),()=>{e($e()),e(Qe())}))},[e,t]),i=Object(o.useCallback)(()=>{e(M(t("rooms.confirm_lock"),()=>{e(Ie())}))},[e,t]),u=Object(o.useCallback)(()=>{e(R({type:"UnlockRoom",props:null}))},[e]),d=Object(o.useCallback)(()=>e(tt()),[e]),m=Object(o.useCallback)(()=>e(rt()),[e]),p=Object(o.useCallback)(()=>e(Xe()),[e]),b=Object(o.useCallback)(()=>e(R({type:"Search",props:null})),[e]),f=Object(o.useCallback)(()=>e(Qe()),[e]);return s.a.createElement("div",{className:"Controls"},s.a.createElement("div",{className:"ControlsInner"},s.a.createElement("div",{className:"ControlsSet PlayerControlsSet"},s.a.createElement("div",{className:"Control"},s.a.createElement(y,{disabled:a||0===r,icon:"step-backward",onClick:d,size:"M",title:t("player.backward")})),s.a.createElement("div",{className:"Control"},n?s.a.createElement(y,{disabled:a||0===r,onClick:f,icon:"pause",title:t("player.stop"),size:"L"}):s.a.createElement(y,{disabled:a||0===r,onClick:p,icon:"play",size:"L",title:t("player.play")})),s.a.createElement("div",{className:"Control"},s.a.createElement(y,{disabled:a||0===r,icon:"step-forward",onClick:m,size:"M",title:t("player.forward")}))),s.a.createElement(ot,null),s.a.createElement("div",{className:"ControlsSet RoomControlsSet"},s.a.createElement("div",{className:"Control"},a?s.a.createElement(y,{icon:"lock",onClick:u,size:"M",title:t("rooms.locked")}):s.a.createElement(y,{icon:"unlock",onClick:i,size:"M",title:t("rooms.unlocked")})),s.a.createElement("div",{className:"Control"},s.a.createElement(y,{onClick:b,icon:"search",title:t("medias.search")})),s.a.createElement("div",{className:"Control"},s.a.createElement(y,{disabled:a||0===r,onClick:c,icon:"trash",title:t("rooms.clear")})))))};r(94);const it=()=>{const e=Object(l.b)(),t=Object(l.c)(e=>e.room.color),r=t.fg,a=t.bg,n=Object(d.h)().search,c=Object(d.i)().room_id,i=f.a.parse(n.substr(1)).secret;return Object(o.useEffect)(()=>(e(Ae(c,i||"")),()=>{e(Le())}),[e,c,i]),Object(o.useEffect)(()=>{document.body.className=r,document.body.style.backgroundColor="rgb(".concat(a.r,", ").concat(a.g,", ").concat(a.b,")")},[a,r]),s.a.createElement("div",{className:p()("Room")},s.a.createElement(z,null),s.a.createElement(at,null),s.a.createElement(st,null))},lt=e=>_("user/SET",e),ut=(e,t)=>function(){var r=Object(c.a)(n.a.mark((function r(a){var c;return n.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,console.debug("[User] Creating..."),c=Object(B.a)(),r.next=5,K({id:c,secret:t}).update({name:e});case 5:a(mt(c,t)),r.next=11;break;case 8:r.prev=8,r.t0=r.catch(0),a(N(je(r.t0)));case 11:case"end":return r.stop()}}),r,null,[[0,8]])})));return function(e){return r.apply(this,arguments)}}();let dt=null;const mt=(e,t)=>function(){var r=Object(c.a)(n.a.mark((function r(a,c){var o,s,i;return n.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=c(),!(s=o.user.user)||s.id!==e){r.next=3;break}return r.abrupt("return");case 3:return a(pt()),r.prev=4,console.debug("[User] Connecting...",{id:e,secret:t}),i=K({id:e,secret:t}),r.t0=a,r.t1=lt,r.t2={id:e,secret:t},r.t3=i,r.next=13,i.wait();case 13:r.t4=r.sent,r.t5={access:r.t2,user:r.t3,info:r.t4},r.t6=(0,r.t1)(r.t5),(0,r.t0)(r.t6),dt=i.subscribe(e=>{const t=e.val();console.debug("[User] Received user update...",t),a(lt({user:i,info:t}))}),r.next=24;break;case 20:r.prev=20,r.t7=r.catch(4),a(N(je(r.t7))),a(lt({access:{id:e,secret:""}}));case 24:case"end":return r.stop()}}),r,null,[[4,20]])})));return function(e,t){return r.apply(this,arguments)}}(),pt=()=>function(){var e=Object(c.a)(n.a.mark((function e(t,r){var a,c,o,s,i,l;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r(),c=a.user,o=c.access,s=o.id,i=o.secret,l=c.user,s||i||l){e.next=3;break}return e.abrupt("return");case 3:console.debug("[User] Disconnecting..."),l&&(l.unsubscribe(dt),dt=null),t(_("user/RESET"));case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),bt=()=>function(){var e=Object(c.a)(n.a.mark((function e(t,r){var a,c,o,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r(),c=a.user.access,o=c.id,s=c.secret,o&&s){e.next=3;break}return e.abrupt("return");case 3:console.debug("[User] Reconnecting...",{id:o,secret:s}),t(mt(o,s));case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();r(95);const ft=()=>{const e=Object(l.b)(),t=Object(l.c)(e=>!!e.user.access.id),r=Object(v.b)().t,a=Object(o.useCallback)(()=>e(R({type:"CreateRoom",props:null})),[e]),n=Object(o.useCallback)(()=>e(R({type:"JoinRoom",props:null})),[e]),c=Object(o.useCallback)(()=>e(R({type:"CreateUser",props:null})),[e]),i=Object(o.useCallback)(()=>e(pt()),[e]);return s.a.createElement("div",{className:"Splash"},s.a.createElement("div",{className:"Top"},s.a.createElement("div",{className:"Logo"},s.a.createElement(u.b,{to:"/"},"Party")),s.a.createElement("div",{className:"PoweredWith"},s.a.createElement("span",null,r("splash.powered_with")),s.a.createElement("a",{href:"https://www.deezer.com",target:"_blank",rel:"noopener noreferrer"},s.a.createElement("img",{src:"/images/deezer.svg",height:"20px",title:"Deezer",alt:"Deezer Logo"}))),s.a.createElement("div",{className:"Description"},s.a.createElement("span",null,r("splash.description")))),s.a.createElement("div",{className:"Middle"},s.a.createElement("div",{className:"Menu"},t?s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"MenuItem"},s.a.createElement(y,{displayTitle:!0,icon:"plus",onClick:a,size:"L",title:r("rooms.create")})),s.a.createElement("div",{className:"MenuItem"},s.a.createElement(y,{displayTitle:!0,icon:"sign-in",onClick:n,size:"L",title:r("rooms.join")}))):s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"MenuItem"},s.a.createElement(y,{displayTitle:!0,onClick:c,icon:"sign-in",size:"L",title:r("users.connect")}))))),s.a.createElement("div",{className:"Bottom"},s.a.createElement("div",{className:"Menu"},t?s.a.createElement("div",{className:"MenuItem"},s.a.createElement(y,{displayTitle:!0,icon:"sign-out",onClick:i,size:"M",title:r("users.disconnect")})):s.a.createElement("div",{className:"MenuItem"},s.a.createElement(y,{displayTitle:!0,icon:"info",onClick:()=>{},size:"M",title:r("splash.CGU")})))))};var vt=r(24);const kt=({children:e,className:t,title:r,renderFoot:a,onSubmit:n})=>{const c=Object(l.b)(),i=Object(v.b)().t,u=Object(l.c)(e=>e.modals.stack.length>1),d=Object(o.useCallback)(()=>c(_("modals/CLOSE")),[c]),m=Object(o.useCallback)(()=>c(T()),[c]);return s.a.createElement("form",{className:p()("Modal",t),onSubmit:e=>{e.preventDefault(),n&&n()}},s.a.createElement("div",{className:"ModalHead"},s.a.createElement(y,{kind:"special",className:p()("ModalHeadBack",{hidden:!u}),icon:"angle-left",title:"Back",onClick:m}),s.a.createElement("div",{className:"ModalTitle"},r),s.a.createElement(y,{kind:"special",className:"ModalHeadClose",onClick:d,title:i("cancel"),icon:"times"})),s.a.createElement("div",{className:"ModalBody"},e),s.a.createElement("div",{className:"ModalFoot"},a&&a()))};r(96);const gt=({children:e,className:t,renderButtons:r,title:a,onSubmit:n})=>s.a.createElement(kt,{className:p()("FormModal",t),title:a,renderFoot:r,onSubmit:n},e),ht=({onClick:e})=>{const t=Object(v.b)().t;return s.a.createElement(y,{onClick:e,title:t("cancel"),kind:"default",icon:"ban"})},yt=({question:e,onCanceled:t,onConfirmed:r})=>{const a=Object(l.b)(),n=Object(v.b)().t,c=Object(o.useCallback)(()=>{a(T()),t&&t()},[a,t]);return s.a.createElement(gt,{title:n("confirm"),onSubmit:r,renderButtons:()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(y,{title:n("cancel"),kind:"primary",icon:"plus",type:"submit"}),s.a.createElement(ht,{onClick:c}))},e)},Et=({children:e})=>s.a.createElement("div",{className:"ModalField"},e),wt=s.a.forwardRef((e,t)=>s.a.createElement(Et,null,s.a.createElement("div",{className:"XXX"},s.a.createElement("label",{htmlFor:e.id},e.label),s.a.createElement("input",Object.assign({ref:t},e))))),Ot=({id:e,label:t,onChange:r,placeholder:a,value:i})=>{const u=Object(l.b)(),d=Object(v.b)().t,m=Object(o.useCallback)(Object(c.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(i);case 2:u(P("secret_copied_to_clipboard"));case 3:case"end":return e.stop()}}),e)}))),[u,i]);return s.a.createElement(Et,null,s.a.createElement("div",{className:"XXX"},s.a.createElement("label",{htmlFor:e},t),s.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},s.a.createElement("input",{style:{flexGrow:1,marginRight:"0.5rem"},id:e,type:"password",autoComplete:"password",placeholder:a,maxLength:36,minLength:36,required:!0,value:i,onChange:e=>r(e.target.value)}),s.a.createElement(y,{icon:"clipboard",onClick:m,size:"M",title:d("copy_to_clipboard")}))))},jt=()=>{const e=Object(l.b)(),t=Object(o.useState)(""),r=Object(W.a)(t,2),a=r[0],n=r[1],c=Object(o.useState)(""),i=Object(W.a)(c,2),u=i[0],d=i[1],m=Object(o.useRef)(null),p=Object(v.b)().t;Object(o.useEffect)(()=>{m.current&&m.current.focus()},[m]);const b=Object(o.useCallback)(()=>e(T()),[e]),f=Object(o.useCallback)(()=>{0!==a.trim().length?0!==u.trim().length?(e(mt(a,u)),e(T())):e(N("users.secret_is_invalid")):e(N("users.id_is_invalid"))},[e,a,u]),k=Object(o.useCallback)(()=>e(R({type:"CreateUser",props:null})),[e]);return s.a.createElement(gt,{title:p("users.connection"),onSubmit:f,renderButtons:()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(y,{disabled:0===a.trim().length||36!==a.length||36!==u.length,title:p("users.connect"),kind:"primary",icon:"sign-in",type:"submit"}),s.a.createElement(ht,{onClick:b}),s.a.createElement(y,{title:p("users.create"),kind:"default",icon:"plus",onClick:k}))},s.a.createElement(wt,{id:"modal-id",label:p("users.id"),type:"text",placeholder:p("users.id_placeholder"),maxLength:36,minLength:36,required:!0,value:a,ref:m,onChange:e=>n(e.target.value)}),s.a.createElement(wt,{id:"modal-secret",label:p("users.secret"),type:"password",autoComplete:"password",placeholder:p("users.secret_placeholder"),maxLength:36,minLength:36,required:!0,value:u,onChange:e=>d(e.target.value)}))};let xt=1;const _t=()=>{const e=Object(l.b)(),t=Object(o.useState)(""),r=Object(W.a)(t,2),a=r[0],n=r[1],c=Object(o.useState)(Object(B.a)()),i=Object(W.a)(c,2),u=i[0],d=i[1],m=Object(o.useRef)(null),p=Object(v.b)().t;Object(o.useEffect)(()=>{n("".concat(p("rooms.room")," ").concat(xt)),m.current&&m.current.focus()},[p,m]);const b=Object(o.useCallback)(()=>e(T()),[e]),f=Object(o.useCallback)(()=>{0!==a.trim().length?0!==u.trim().length?(e(ze(a,u)),e(T()),xt++):e(N("rooms.secret_is_invalid")):e(N("rooms.name_is_invalid"))},[e,a,u]);return s.a.createElement(gt,{title:p("rooms.room_creation"),onSubmit:f,renderButtons:()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(y,{disabled:0===a.trim().length||36!==u.length,title:p("rooms.create"),kind:"primary",icon:"plus",type:"submit"}),s.a.createElement(ht,{onClick:b}))},s.a.createElement(wt,{id:"modal-name",label:p("rooms.name"),type:"text",placeholder:p("rooms.name_placeholder"),maxLength:100,minLength:2,required:!0,value:a,ref:m,onChange:e=>n(e.target.value)}),s.a.createElement(Ot,{id:"modal-secret",label:p("rooms.key"),placeholder:p("rooms.key_placeholder"),value:u,onChange:d}))};let Ct=1;const St=()=>{const e=Object(l.b)(),t=Object(o.useState)(""),r=Object(W.a)(t,2),a=r[0],n=r[1],c=Object(o.useState)(Object(B.a)()),i=Object(W.a)(c,2),u=i[0],d=i[1],m=Object(o.useRef)(null),p=Object(v.b)().t;Object(o.useEffect)(()=>{n("".concat(p("users.user")," ").concat(Ct)),m.current&&m.current.focus()},[p,m]);const b=Object(o.useCallback)(()=>e(T()),[e]),f=Object(o.useCallback)(()=>{0!==a.trim().length?0!==u.trim().length?(e(ut(a,u)),e(T()),Ct++):e(N("users.secret_is_invalid")):e(N("users.name_is_invalid"))},[e,a,u]),k=Object(o.useCallback)(()=>{e(R({type:"ConnectUser",props:null}))},[e]);return s.a.createElement(gt,{title:p("users.user_creation"),onSubmit:f,renderButtons:()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(y,{disabled:0===a.trim().length||36!==u.length,title:p("users.create"),kind:"primary",icon:"plus",type:"submit"}),s.a.createElement(ht,{onClick:b}),s.a.createElement(y,{title:p("users.connect"),kind:"default",icon:"sign-in",onClick:k}))},s.a.createElement(wt,{id:"modal-name",label:p("users.name"),type:"text",placeholder:p("users.name_placeholder"),maxLength:100,minLength:2,required:!0,value:a,ref:m,onChange:e=>n(e.target.value)}),s.a.createElement(Ot,{id:"modal-secret",label:p("users.secret"),placeholder:p("users.secret_placeholder"),value:u,onChange:e=>d(e)}))},Nt=({items:e,label:t,onViewMore:r,cb:a})=>e.length>0?s.a.createElement(s.a.Fragment,null,s.a.createElement(Et,null,s.a.createElement("div",{className:"XXX"},s.a.createElement("label",null,t))),e.map(e=>s.a.createElement(Et,{key:e.id},s.a.createElement("div",{className:"SearchResultItem"},a(e)))),s.a.createElement(Et,null,s.a.createElement("div",{className:"XXX"},s.a.createElement(y,{icon:"ellipsis-h",onClick:r,title:"View more..."})))):null;r(97);const Pt=()=>{const e=Object(l.b)(),t=Object(v.b)().t,r=Object(o.useRef)(null),a=Object(l.c)(j),i=Object(o.useState)(""),u=Object(W.a)(i,2),d=u[0],m=u[1],p=Object(o.useState)("deezer"),b=Object(W.a)(p,2),f=b[0],k=b[1],g=Object(o.useState)("track"),h=Object(W.a)(g,2),E=h[0],w=h[1],O=Object(o.useState)(""),x=Object(W.a)(O,2),_=x[0],C=x[1],S=Object(o.useState)({deezer:{album:[],playlist:[],track:[]}}),N=Object(W.a)(S,2),P=N[0],R=N[1],M=Object(o.useCallback)(()=>e(T()),[e]),z=Object(o.useCallback)(Object(c.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(_.trim().length>0)){e.next=6;break}return e.t0=R,e.next=4,Oe(_,{limit:5});case 4:e.t1=e.sent,(0,e.t0)(e.t1);case 6:case"end":return e.stop()}}),e)}))),[_]),A=Object(o.useCallback)((t,r,a)=>e(Ye([{provider:t,type:r,id:a}])),[e]),L=Object(o.useCallback)((t,r,a)=>{e(_e({provider:t,type:r,id:a})),m(a),k(t),w(r)},[e]),q=Object(o.useCallback)(Object(c.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.debug("Stop previewing..."),e.next=3,me.stop();case 3:m(""),k("deezer"),w("track");case 6:case"end":return e.stop()}}),e)}))),[]),U=Object(o.useCallback)(function(){var e=Object(c.a)(n.a.mark((function e(t){var r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r={deezer:{album:[],playlist:[],track:[]}},e.t0=t,e.next="album"===e.t0?4:"playlist"===e.t0?8:"track"===e.t0?12:16;break;case 4:return e.next=6,ye.searchAlbums(_,{limit:50});case 6:return r.deezer.album=e.sent,e.abrupt("break",16);case 8:return e.next=10,ye.searchPlaylists(_,{limit:50});case 10:return r.deezer.playlist=e.sent,e.abrupt("break",16);case 12:return e.next=14,ye.searchTracks(_,{limit:50});case 14:return r.deezer.track=e.sent,e.abrupt("break",16);case 16:R(r);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[_,R]);return Object(o.useEffect)(()=>(r.current&&r.current.focus(),()=>{console.debug("Stop previewing..."),me.stop()}),[e]),s.a.createElement(gt,{className:"SearchModal",title:t("medias.medias_search"),onSubmit:z,renderButtons:()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(y,{disabled:0===_.trim().length,title:t("medias.search"),kind:"primary",icon:"search",type:"submit"}),s.a.createElement(ht,{onClick:M}))},s.a.createElement(Et,null,s.a.createElement("input",{id:"modal-query",type:"text",placeholder:t("medias.search_placeholder"),maxLength:100,minLength:2,required:!0,value:_,ref:r,onChange:e=>C(e.target.value)})),$.map(({label:e,provider:r,type:n})=>s.a.createElement(Nt,{key:n,label:t(e),items:P[r][n],onViewMore:()=>U(n),cb:e=>s.a.createElement(I,{actions:s.a.createElement(y,{disabled:a,title:t("medias.add"),icon:"plus",onClick:()=>A(r,n,e.id)}),media:e,playable:!0,playing:f===r&&E===n&&d===e.id,onPlay:()=>L(r,n,e.id),onStop:q})})))},Rt=()=>{const e=Object(l.b)(),t=Object(o.useState)(""),r=Object(W.a)(t,2),a=r[0],n=r[1],c=Object(o.useRef)(null),i=Object(v.b)().t;Object(o.useEffect)(()=>{c.current&&c.current.focus()},[c]);const u=Object(o.useCallback)(()=>e(T()),[e]),d=Object(o.useCallback)(()=>{0!==a.trim().length?(e(Ae(a,"")),e(T())):e(N("rooms.id_is_invalid"))},[e,a]);return s.a.createElement(gt,{title:i("rooms.room_join"),onSubmit:d,renderButtons:()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(y,{disabled:0===a.trim().length||36!==a.length,title:i("rooms.join"),kind:"primary",icon:"plus",type:"submit"}),s.a.createElement(ht,{onClick:u}))},s.a.createElement(wt,{id:"modal-id",label:i("rooms.id"),type:"text",placeholder:i("rooms.id_placeholder"),maxLength:36,minLength:36,required:!0,value:a,ref:c,onChange:e=>n(e.target.value)}))},Tt=()=>{const e=Object(l.b)(),t=Object(o.useState)(""),r=Object(W.a)(t,2),a=r[0],n=r[1],c=Object(o.useRef)(null),i=Object(v.b)().t;Object(o.useEffect)(()=>{c.current&&c.current.focus()},[c]);const u=Object(o.useCallback)(()=>e(T()),[e]),d=Object(o.useCallback)(()=>{e(qe(a)),e(T())},[e,a]);return s.a.createElement(gt,{title:i("rooms.room_unlocking"),onSubmit:d,renderButtons:()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(y,{disabled:36!==a.length,title:i("rooms.unlock"),kind:"primary",icon:"unlock",type:"submit"}),s.a.createElement(ht,{onClick:u}))},s.a.createElement(wt,{id:"modal-secret",label:i("rooms.key"),type:"password",autoComplete:"password",placeholder:i("rooms.key_placeholder"),maxLength:36,minLength:36,required:!0,value:a,ref:c,onChange:e=>n(e.target.value)}))};r(98);const Mt=()=>{const e=Object(l.b)(),t=Object(l.c)(e=>e.modals.stack.length>0?e.modals.stack[e.modals.stack.length-1]:void 0),r=Object(o.useState)(void 0),a=Object(W.a)(r,2),n=a[0],c=a[1],i=Object(o.useState)(void 0),u=Object(W.a)(i,2),d=u[0],m=u[1],p=Object(o.useCallback)(()=>e(T()),[e]);Object(o.useEffect)(()=>{const e=e=>{27===e.keyCode&&p()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[p]),Object(o.useEffect)(()=>{c(void 0),m(t)},[t,c,m]),Object(o.useEffect)(()=>{t&&setTimeout(()=>{c(t)},300)},[t,c]);const b=(e=>{if(e)switch(e.type){case"Confirm":return s.a.createElement(yt,e.props);case"ConnectUser":return s.a.createElement(jt,null);case"CreateRoom":return s.a.createElement(_t,null);case"CreateUser":return s.a.createElement(St,null);case"JoinRoom":return s.a.createElement(Rt,null);case"Search":return s.a.createElement(Pt,null);case"UnlockRoom":return s.a.createElement(Tt,null)}return null})(n||d);return s.a.createElement(vt.CSSTransition,{in:!!n,timeout:300,unmountOnExit:!0},s.a.createElement("div",{className:"ModalOverlay",onClick:e=>{e.stopPropagation(),p()}},b&&s.a.createElement("div",{className:"ModalWrapper",role:"dialog",onClick:e=>{e.stopPropagation()}},b)))},zt=e=>e.messages.sort((e,t)=>e.stamp-t.stamp);r(106);const At=()=>{const e=Object(v.b)().t,t=Object(l.c)(zt);return s.a.createElement("div",{className:"Messages"},s.a.createElement(vt.TransitionGroup,null,t.map(t=>s.a.createElement(vt.CSSTransition,{key:t.id,classNames:"Message",timeout:{enter:200,exit:200}},s.a.createElement("div",{className:p()("Message","Message-"+t.type)},e(t.text))))))};r(107);const Lt=()=>{const e=Object(l.b)();return Object(o.useEffect)(()=>{e(bt())},[e]),s.a.createElement("div",{className:"App"},s.a.createElement(Mt,null),s.a.createElement(d.d,null,s.a.createElement(d.b,{exact:!0,path:"/room/:room_id",component:it}),s.a.createElement(d.b,{exact:!0,path:"/",component:ft}),s.a.createElement(d.a,{to:"/"})),s.a.createElement(At,null))};var It=r(38),qt={audio:{errors:{cannot_decode_audio_data:"Audio buffer cannot be decoded",cannot_load_audio_buffer:"Audio buffer loading failed"}},splash:{CGU:"CGU",powered_with:"Powered with",description:"Party is an experimentation to synchronize music listening with your online friends."},users:{errors:{invalid:"User is invalid"},user:"User",confirm_disconnect:"Are you sure you want to disconnect?",connect:"Connect",connection:"Connection",create:"Create a user",disconnect:"Disconnect",id:"User ID",id_is_invalid:"ID is invalid",id_placeholder:"User ID...",name_is_invalid:"Name is invalid",name_placeholder:"User Name...",name:"User Name",secret_is_invalid:"Secret is invalid",secret_placeholder:"User Secret...",secret:"User Secret",user_creation:"User Registration"},rooms:{errors:{invalid:"Room is invalid",locked:"Room is locked"},clear:"Clear all tracks",confirm_clear:"Are you sure you want to remove all tracks?",confirm_exit:"Are you sure you want to leave the room?",confirm_lock:"Are you sure you want to lock the room?",copy_link:"Copy Room Link to Clipboard",create:"Create a room",empty:"It's empty here, you should add some tracks...",empty_for_now:"It's empty here, the owner has to fill it..",exit:"Exit Room",id:"Room ID",id_placeholder:"Room ID...",key_placeholder:"Room Key...",key:"Room Key",join:"Join a Room",link_copied_to_clipboard:"Room link has been copied to clipboard",loading:"Loading...",locked:"Locked (click to unlock)",name_is_invalid:"Name is invalid",name_placeholder:"Room Name...",name:"Room Name",room_creation:"Room Creation",room_join:"Room Access",room_unlocking:"Room Unlocking",room:"Room",secret_is_invalid:"Secret is invalid",unlock:"Unlock",unlocked:"Unlocked (click to lock)",track_count:"{{count}} track",track_count_plural:"{{count}} tracks"},medias:{by:"by {{artist}}",add:"Add",remove:"Remove",search:"Search Media",search_placeholder:"Search...",medias_search:"Media Search",albums:"Albums",playlists:"Playlists",tracks:"Tracks"},player:{backward:"Backward",forward:"Forward",play:"Play",playing:"Playing",stop:"Stop"},cancel:"Cancel",copy_to_clipboard:"Copy to Clipboard",secret_copied_to_clipboard:"Secret has been copied to clipboard"},Ut={audio:{errors:{cannot_decode_audio_data:"Le buffer audio ne peut pas \xeatre d\xe9cod\xe9",cannot_load_audio_buffer:"Le buffer audio ne peut pas \xeatre charg\xe9"}},splash:{CGU:"CGU",powered_with:"boost\xe9 avec",description:"Party est une exp\xe9rimentation d'\xe9coute synchronis\xe9e de musiques avec vos amis en ligne."},users:{errors:{invalid:"L'utilisateur est invalide"},user:"Utilisateur",confirm_disconnect:"\xcates-vous s\xfbr(e) de vouloir vous d\xe9connecter ?",connect:"Se connecter",connection:"Connexion",create:"Cr\xe9er un utilisateur",disconnect:"Se d\xe9connecter",id:"Identifiant",id_is_invalid:"L'identifiant est invalide",id_placeholder:"Identifiant...",name_is_invalid:"Le nom est invalide",name_placeholder:"Nom...",name:"Nom",secret_is_invalid:"Le secret est invalide",secret_placeholder:"Secret...",secret:"Secret",user_creation:"Cr\xe9ation d'un utilisateur"},rooms:{errors:{invalid:"La salle est invalide",locked:"La salle est verrouill\xe9e"},clear:"Supprimer toutes les pistes",confirm_clear:"\xcates-vous s\xfbr(e) de vouloir supprimer toutes les pistes ?",confirm_exit:"\xcates-vous s\xfbr(e) de vouloir quitter la salle ?",confirm_lock:"\xcates-vous s\xfbr(e) de vouloir verrouiller la salle ?",copy_link:"Copier le lien de la salle dans le presse-papier",create:"Cr\xe9er une salle",empty:"Cette salle est vide, vous devriez ajouter quelques pistes...",empty_for_now:"Cette salle est pour le moment vide...",exit:"Quitter la salle",id:"Identifiant",id_placeholder:"Identifiant...",key_placeholder:"Clef...",key:"Clef",join:"Rejoindre une salle",loading:"Chargement...",link_copied_to_clipboard:"Le lien de la salle a \xe9t\xe9 copi\xe9 dans le presse-papier",locked:"Verrouill\xe9e (cliquer pour d\xe9verrouiller)",name_is_invalid:"Le nom est invalide",name_placeholder:"Nom...",name:"Nom",room:"Salle",room_creation:"Cr\xe9ation d'une salle",room_join:"Rejoindre une salle",room_unlocking:"D\xe9verrouillage de la salle",secret_is_invalid:"Le secret is invalide",unlock:"D\xe9verrouiller",unlocked:"D\xe9verrouill\xe9e (cliquer pour verrouiller)",track_count:"{{count}} piste",track_count_plural:"{{count}} pistes"},medias:{by:"par {{artist}}",add:"Ajouter",remove:"Supprimer",search:"Chercher des m\xe9dias",search_placeholder:"Recherche...",medias_search:"Recherche de m\xe9dias",albums:"Albums",playlists:"Playlists",tracks:"Pistes"},player:{backward:"Piste pr\xe9c\xe9dente",forward:"Piste suivante",play:"Lire",playing:"En cours de lecture",stop:"Arr\xeater"},cancel:"Annuler",copy_to_clipboard:"Copier dans le presse-papier",secret_copied_to_clipboard:"Le secret a \xe9t\xe9 copi\xe9 dans le presse-papier"};const Ft=function(){var e=Object(c.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((e,t)=>{console.debug("Initializing language...",{current:navigator.language||navigator.userLanguage}),It.a.use(v.a).init({fallbackLng:"en",lng:navigator.language||navigator.userLanguage,resources:{en:{translation:qt},"en-US":{translation:qt},fr:{translation:Ut},"fr-FR":{translation:Ut}},interpolation:{escapeValue:!1,format:(e,t,r)=>e}},r=>{r&&t(r),e()})}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Dt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Wt(e,t){console.log("PWA registerValidSW 1"),navigator.serviceWorker.register(e).then(e=>{console.log("PWA registerValidSW 2"),e.onupdatefound=()=>{console.log("PWA registerValidSW 3");const r=e.installing;null!=r&&(console.log("PWA registerValidSW 4"),r.onstatechange=()=>{console.log("PWA registerValidSW 5",r.state),"installed"===r.state&&(navigator.serviceWorker.controller?(console.log("PWA registerValidSW 6"),console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("PWA registerValidSW 7"),console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(e=>{console.error("Error during service worker registration:",e)})}r(108);var Bt=r(16),Vt=r(57);const Gt={error:null,fetching:!1,medias:{deezer:{album:{},playlist:{},track:{}}}},Ht=[],Xt={stack:[]},Qt={access:{id:"",secret:""},color:{fg:"dark",bg:{r:255,g:255,b:255}},error:null,fetching:!1,info:null,medias:[],room:null,tracks:[]},Jt=()=>{const e={id:"",secret:""},t=localStorage.getItem("U");if(t)try{const r=JSON.parse(atob(t));"string"===typeof r.i&&"string"===typeof r.s&&(e.id=r.i,e.secret=r.s,console.debug("Loaded user access: ",e))}catch(r){}return e},Kt={access:{id:"",secret:""},error:null,fetching:!1,info:null,user:null},$t=Object(Bt.combineReducers)({medias:(e=Gt,t)=>{switch(t.type){case"medias/FETCHING":return Object(D.a)({},e,{fetching:!0,error:null});case"medias/FETCHED":return Object(D.a)({},e,{fetching:!1,error:null});case"medias/ERROR":return Object(D.a)({},e,{fetching:!1,error:t.payload});case"medias/SET":{const c=Object(D.a)({},e,{medias:{deezer:{album:Object(D.a)({},e.medias.deezer.album),playlist:Object(D.a)({},e.medias.deezer.playlist),track:Object(D.a)({},e.medias.deezer.track)}}});var r,a=Object(U.a)(t.payload);try{for(a.s();!(r=a.n()).done;){const e=r.value;c.medias[e.provider][e.type][e.id]=e}}catch(n){a.e(n)}finally{a.f()}return c}case"medias/RESET":return Gt;default:return e}},messages:(e=Ht,t)=>{switch(t.type){case"message/ADD":return[t.payload,...e];case"message/REMOVE":return e.filter(e=>e.id!==t.payload);case"message/RESET":return Ht;default:return e}},modals:(e=Xt,t)=>{switch(t.type){case"modals/OPEN":return Object(D.a)({},e,{stack:[t.payload]});case"modals/CLOSE":return Object(D.a)({},e,{stack:[]});case"modals/PUSH":return Object(D.a)({},e,{stack:[...e.stack,t.payload]});case"modals/POP":const r=[...e.stack];return r.pop(),Object(D.a)({},e,{stack:r});default:return e}},room:(e=Qt,t)=>{switch(t.type){case"room/FETCHING":return Object(D.a)({},e,{fetching:!0,error:null});case"room/FETCHED":return Object(D.a)({},e,{fetching:!1,error:null});case"room/ERROR":return Object(D.a)({},e,{fetching:!1,error:t.payload});case"room/SET":return Object(D.a)({},e,{},t.payload);case"room/RESET":return Qt;default:return e}},user:(e=Object(D.a)({},Kt,{access:Jt()}),t)=>{switch(t.type){case"user/FETCHING":return Object(D.a)({},e,{fetching:!0,error:null});case"user/FETCHED":return Object(D.a)({},e,{fetching:!1,error:null});case"user/ERROR":return Object(D.a)({},e,{fetching:!1,error:t.payload});case"user/SET":{const r=Object(D.a)({},e,{},t.payload);return(({id:e,secret:t})=>{localStorage.setItem("U",btoa(JSON.stringify({i:e,s:t})))})(r.access),r}case"user/RESET":return localStorage.removeItem("U"),Kt;default:return e}}}),Yt=e=>{const t=Bt.compose,r=Object(Bt.createStore)($t,e,t(Object(Bt.applyMiddleware)(Vt.a.withExtraArgument({player:de}))));return{dispatch:r.dispatch.bind(r),getState:r.getState.bind(r),store:r}};r(109);!function(e){if("serviceWorker"in navigator){if(console.log("PWA register 1",""),new URL("",window.location.href).origin!==window.location.origin)return void console.log("PWA register 2");window.addEventListener("load",()=>{const t="".concat("","/service-worker.js");console.log("PWA register 3"),Dt?(console.log("PWA register 4"),function(e,t){console.log("PWA checkValidServiceWorker 1"),fetch(e,{headers:{"Service-Worker":"script"}}).then(r=>{const a=r.headers.get("content-type");console.log("PWA checkValidServiceWorker 2",a,r.status),404===r.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):Wt(e,t)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):(console.log("PWA register 5"),Wt(t,e))})}}(),function(){var e=Object(c.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ft(),e.abrupt("return",Yt());case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()().then(({store:e})=>{i.render(o.createElement(l.a,{store:e},o.createElement(u.a,null,o.createElement(d.b,{path:"/",component:Lt}))),document.getElementById("root"))})},58:function(e,t,r){e.exports=r(110)},80:function(e,t,r){},81:function(e,t,r){},82:function(e,t,r){},84:function(e,t,r){},85:function(e,t,r){},91:function(e,t,r){},92:function(e,t,r){},93:function(e,t,r){},94:function(e,t,r){},95:function(e,t,r){},96:function(e,t,r){},97:function(e,t,r){},98:function(e,t,r){}},[[58,1,2]]]);
//# sourceMappingURL=main.25221a84.chunk.js.map